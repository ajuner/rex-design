(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{125:function(e,n,t){"use strict";t.r(n),t.d(n,"frontMatter",(function(){return A})),t.d(n,"metadata",(function(){return w})),t.d(n,"toc",(function(){return N})),t.d(n,"default",(function(){return V}));var a=t(3),r=t(7),o=t(0),l=t.n(o),i=t(165),s=t(162),c=t(207),u=t(312);function m(e){var n=e.name,t=e.label,o=Object(r.a)(e,["name","label"]);return l.a.createElement("div",Object(a.a)({},o,{style:Object.assign({border:"1px dashed var(--rex-colors-emphasis-30)"},o.style)}),l.a.createElement("p",{style:{fontWeight:"bold",margin:"12px 0 8px 8px"}},t),l.a.createElement(c.a.Object,{name:n},l.a.createElement(c.c,{component:"input",name:"name",label:"\u59d3\u540d",required:!0,componentProps:{style:{width:150}}}),l.a.createElement(c.c,{component:"input",name:"age",label:"\u5e74\u9f84",required:!0,componentProps:{style:{width:100}}}),l.a.createElement(c.c,{component:"testButtonGroup",name:"gender",required:!0,label:"\u6027\u522b",items:["\u7537","\u5973"]}),l.a.createElement(c.c,{component:"input",name:"contact",label:"\u8054\u7cfb\u65b9\u5f0f",required:!0,componentProps:{style:{width:200}}}),l.a.createElement(c.c,{component:"singleSelect",name:"address.city",label:"\u5c45\u4f4f\u57ce\u5e02",required:!0,componentProps:{dataSource:"\u676d\u5dde\uff0c\u4e0a\u6d77\uff0c\u5317\u4eac\uff0c\u6df1\u5733\uff0c\u5e7f\u5dde\uff0c\u6b66\u6c49\uff0c\u6210\u90fd".split("\uff0c"),style:{width:200}}}),l.a.createElement(c.c,{component:"input",name:"address.detail",label:"\u8be6\u7ec6\u5730\u5740",componentProps:{style:{width:240}}})))}var d={filename:"/Users/feichao.sfc/code/github/alibaba/rex-design/packages/story/src/xform/2-advanced-examples.stories.tsx",loc:{start:{line:8,column:0},end:{line:38,column:1}},name:"PersonForm",value:m,source:'function PersonForm({\n  name,\n  label,\n  ...others\n}) {\n  return (\n    <div {...others} style={{ border: \'1px dashed var(--rex-colors-emphasis-30)\', ...others.style }}>\n      <p style={{ fontWeight: \'bold\', margin: \'12px 0 8px 8px\' }}>{label}</p>\n      <Form.Object name={name}>\n        <FormItem component="input" name="name" label="\u59d3\u540d" required componentProps={{ style: { width: 150 } }} />\n        <FormItem component="input" name="age" label="\u5e74\u9f84" required componentProps={{ style: { width: 100 } }} />\n        <FormItem component="testButtonGroup" name="gender" required label="\u6027\u522b" items={[\'\u7537\', \'\u5973\']} />\n        <FormItem\n          component="input"\n          name="contact"\n          label="\u8054\u7cfb\u65b9\u5f0f"\n          required\n          componentProps={{ style: { width: 200 } }}\n        />\n        <FormItem\n          component="singleSelect"\n          name="address.city"\n          label="\u5c45\u4f4f\u57ce\u5e02"\n          required\n          componentProps={{ dataSource: \'\u676d\u5dde\uff0c\u4e0a\u6d77\uff0c\u5317\u4eac\uff0c\u6df1\u5733\uff0c\u5e7f\u5dde\uff0c\u6b66\u6c49\uff0c\u6210\u90fd\'.split(\'\uff0c\'), style: { width: 200 } }}\n        />\n        <FormItem component="input" name="address.detail" label="\u8be6\u7ec6\u5730\u5740" componentProps={{ style: { width: 240 } }} />\n      </Form.Object>\n    </div>\n  );\n}',deps:function(){return[]},provides:{React:l.a,Form:c.a,FormItem:c.c}};function p(){return l.a.createElement(c.a,{labelPosition:"left",defaultValue:{me:{name:"rex design",gender:"\u7537",age:"1",contact:"alibaba.github.io/rex-design/",address:{city:"\u676d\u5dde"}}}},l.a.createElement("h4",null,"\u5bb6\u5ead\u4fe1\u606f\u767b\u8bb0\u8868"),l.a.createElement("div",{style:{display:"grid",grid:"auto-flow / repeat(auto-fill, minmax(360px, auto))",gap:8}},l.a.createElement(m,{name:"me",label:"\u4e2a\u4eba\u4fe1\u606f"}),l.a.createElement(m,{name:"father",label:"\u7236\u4eb2"}),l.a.createElement(m,{name:"mother",label:"\u6bcd\u4eb2"}),l.a.createElement(m,{name:"urgency",label:"\u5176\u4ed6\u7d27\u6025\u8054\u7cfb\u4eba"})),l.a.createElement(u.a,null))}var b={filename:"/Users/feichao.sfc/code/github/alibaba/rex-design/packages/story/src/xform/2-advanced-examples.stories.tsx",loc:{start:{line:40,column:7},end:{line:65,column:1}},name:"ObjectExample",value:p,source:'function ObjectExample() {\n  return (\n    <Form\n      labelPosition="left"\n      defaultValue={{\n        me: {\n          name: \'rex design\',\n          gender: \'\u7537\',\n          age: \'1\',\n          contact: \'alibaba.github.io/rex-design/\',\n          address: { city: \'\u676d\u5dde\' },\n        },\n      }}\n    >\n      <h4>\u5bb6\u5ead\u4fe1\u606f\u767b\u8bb0\u8868</h4>\n      <div style={{ display: \'grid\', grid: \'auto-flow / repeat(auto-fill, minmax(360px, auto))\', gap: 8 }}>\n        <PersonForm name="me" label="\u4e2a\u4eba\u4fe1\u606f" />\n        <PersonForm name="father" label="\u7236\u4eb2" />\n        <PersonForm name="mother" label="\u6bcd\u4eb2" />\n        <PersonForm name="urgency" label="\u5176\u4ed6\u7d27\u6025\u8054\u7cfb\u4eba" />\n      </div>\n\n      <ValuePreview />\n    </Form>\n  );\n}',deps:function(){return[d]},provides:{Form:c.a,ValuePreview:u.a}};p.__doc_info=b,p.__inner_source='function ObjectExample() {\n  return (\n    <Form\n      labelPosition="left"\n      defaultValue={{\n        me: {\n          name: \'rex design\',\n          gender: \'\u7537\',\n          age: \'1\',\n          contact: \'alibaba.github.io/rex-design/\',\n          address: { city: \'\u676d\u5dde\' },\n        },\n      }}\n    >\n      <h4>\u5bb6\u5ead\u4fe1\u606f\u767b\u8bb0\u8868</h4>\n      <div style={{ display: \'grid\', grid: \'auto-flow / repeat(auto-fill, minmax(360px, auto))\', gap: 8 }}>\n        <PersonForm name="me" label="\u4e2a\u4eba\u4fe1\u606f" />\n        <PersonForm name="father" label="\u7236\u4eb2" />\n        <PersonForm name="mother" label="\u6bcd\u4eb2" />\n        <PersonForm name="urgency" label="\u5176\u4ed6\u7d27\u6025\u8054\u7cfb\u4eba" />\n      </div>\n\n      <ValuePreview />\n    </Form>\n  );\n}';var f=["\u97e9\u90fd\u8863\u820d","ZARA","\u4f18\u8863\u5e93","\u592a\u5e73\u9e1f"],y={filename:"/Users/feichao.sfc/code/github/alibaba/rex-design/packages/story/src/xform/2-advanced-examples.stories.tsx",loc:{start:{line:67,column:0},end:{line:67,column:46}},name:"BRANDS",value:f,source:"const BRANDS = ['\u97e9\u90fd\u8863\u820d', 'ZARA', '\u4f18\u8863\u5e93', '\u592a\u5e73\u9e1f'];",deps:function(){return[]},provides:{}},v="\u901a\u52e4\uff0c\u767e\u642d\uff0c\u65f6\u5c1a\uff0c\u4f11\u95f2\uff0c\u539f\u521b\u8bbe\u8ba1\uff0c\u590d\u53e4\uff0c\u6c11\u65cf\u98ce\uff0c\u4f18\u96c5\uff0c\u6027\u611f\uff0c\u6734\u5b9e\uff0c\u5c45\u5bb6".split("\uff0c"),h={filename:"/Users/feichao.sfc/code/github/alibaba/rex-design/packages/story/src/xform/2-advanced-examples.stories.tsx",loc:{start:{line:68,column:0},end:{line:68,column:64}},name:"STYLES",value:v,source:"const STYLES = '\u901a\u52e4\uff0c\u767e\u642d\uff0c\u65f6\u5c1a\uff0c\u4f11\u95f2\uff0c\u539f\u521b\u8bbe\u8ba1\uff0c\u590d\u53e4\uff0c\u6c11\u65cf\u98ce\uff0c\u4f18\u96c5\uff0c\u6027\u611f\uff0c\u6734\u5b9e\uff0c\u5c45\u5bb6'.split('\uff0c');",deps:function(){return[]},provides:{}};function O(e){s.Toaster.show({content:l.a.createElement("div",null,l.a.createElement("p",{style:{marginBottom:4,color:"--rex-colors-green-60"}},"\u6b63\u5728\u63d0\u4ea4..."),l.a.createElement("span",{style:{fontFamily:"monospace"}},JSON.stringify(e,null,2)))})}var g={filename:"/Users/feichao.sfc/code/github/alibaba/rex-design/packages/story/src/xform/2-advanced-examples.stories.tsx",loc:{start:{line:70,column:0},end:{line:79,column:1}},name:"showSubmitToast",value:O,source:"function showSubmitToast(values) {\n  Toaster.show({\n    content: (\n      <div>\n        <p style={{ marginBottom: 4, color: '--rex-colors-green-60' }}>\u6b63\u5728\u63d0\u4ea4...</p>\n        <span style={{ fontFamily: 'monospace' }}>{JSON.stringify(values, null, 2)}</span>\n      </div>\n    ),\n  });\n}",deps:function(){return[]},provides:{Toaster:s.Toaster}};function S(e){s.Toaster.show({content:l.a.createElement("div",null,l.a.createElement("p",{style:{marginBottom:4,color:"var(--rex-colors-red-60)"}},"\u8868\u5355\u4e2d\u5305\u542b\u9519\u8bef\uff01"),l.a.createElement("span",{style:{fontFamily:"monospace"}},JSON.stringify(e,null,2)))})}var x={filename:"/Users/feichao.sfc/code/github/alibaba/rex-design/packages/story/src/xform/2-advanced-examples.stories.tsx",loc:{start:{line:81,column:0},end:{line:90,column:1}},name:"showErrorToast",value:S,source:"function showErrorToast(errors) {\n  Toaster.show({\n    content: (\n      <div>\n        <p style={{ marginBottom: 4, color: 'var(--rex-colors-red-60)' }}>\u8868\u5355\u4e2d\u5305\u542b\u9519\u8bef\uff01</p>\n        <span style={{ fontFamily: 'monospace' }}>{JSON.stringify(errors, null, 2)}</span>\n      </div>\n    ),\n  });\n}",deps:function(){return[]},provides:{Toaster:s.Toaster}};function j(){return l.a.createElement(c.a,{labelPosition:"left",defaultValue:{tickets:[{name:"feichao",date:Object(s.dayjs)().format("YYYY-MM-DD")}]},onSubmit:function(e){console.log("onSubmit:",e),O(e)},onError:function(e){console.log("onError:",e),S(e)},onReset:function(e){e.values={tickets:[{name:"feichao",date:Object(s.dayjs)().format("YYYY-MM-DD")}]}}},l.a.createElement("h4",null,"\u5ba2\u6237\u6ee1\u610f\u5ea6\u8c03\u67e5\u5217\u8868"),l.a.createElement(c.a.Array,{name:"tickets",layout:Object(c.e)({showItemOrder:!0})},l.a.createElement(c.c,{component:"input",label:"\u5ba2\u6237\u540d\u79f0",name:"name",required:!0,componentProps:{style:{maxWidth:200}}}),l.a.createElement(c.c,{component:"datePicker",label:"\u8d2d\u4e70\u65e5\u671f",name:"date",required:!0}),l.a.createElement(c.c,{component:"testButtonGroup",label:"\u54c1\u724c",name:"brand",items:f,required:!0}),l.a.createElement(c.c,{component:"singleSelect",label:"\u98ce\u683c",name:"style",required:!0,componentProps:{dataSource:v,style:{maxWidth:200}}}),l.a.createElement(c.c,{component:"testButtonGroup",name:"satisfaction",label:"\u5ba2\u6237\u6ee1\u610f\u5ea6",required:!0,items:"\u975e\u5e38\u6ee1\u610f\uff0c\u6ee1\u610f\uff0c\u57fa\u672c\u6ee1\u610f\uff0c\u4e0d\u6ee1\u610f\uff0c\u975e\u5e38\u4e0d\u6ee1\u610f".split("\uff0c")}),l.a.createElement(c.c,{component:"input",label:"\u5ba2\u6237\u8054\u7cfb\u65b9\u5f0f",name:"contact",componentProps:{style:{maxWidth:200}}}),l.a.createElement(c.c,{component:"input",label:"\u5ba2\u6237\u8054\u7cfb\u5730\u5740",name:"address"})),l.a.createElement(s.Group,{mt:"m"},l.a.createElement(c.a.Submit,null),l.a.createElement(c.a.Reset,null)),l.a.createElement(u.a,null))}var E={filename:"/Users/feichao.sfc/code/github/alibaba/rex-design/packages/story/src/xform/2-advanced-examples.stories.tsx",loc:{start:{line:92,column:7},end:{line:146,column:1}},name:"ArrayExample",value:j,source:'function ArrayExample() {\n  return (\n    <Form\n      labelPosition="left"\n      defaultValue={{ tickets: [{ name: \'feichao\', date: dayjs().format(\'YYYY-MM-DD\') }] }}\n      onSubmit={(values) => {\n        console.log(\'onSubmit:\', values);\n        showSubmitToast(values);\n      }}\n      onError={(errors) => {\n        console.log(\'onError:\', errors);\n        showErrorToast(errors);\n      }}\n      onReset={(model) => {\n        model.values = { tickets: [{ name: \'feichao\', date: dayjs().format(\'YYYY-MM-DD\') }] };\n      }}\n    >\n      <h4>\u5ba2\u6237\u6ee1\u610f\u5ea6\u8c03\u67e5\u5217\u8868</h4>\n      <Form.Array name="tickets" layout={arrayCard({ showItemOrder: true })}>\n        <FormItem\n          component="input"\n          label="\u5ba2\u6237\u540d\u79f0"\n          name="name"\n          required\n          componentProps={{ style: { maxWidth: 200 } }}\n        />\n        <FormItem component="datePicker" label="\u8d2d\u4e70\u65e5\u671f" name="date" required />\n        <FormItem component="testButtonGroup" label="\u54c1\u724c" name="brand" items={BRANDS} required />\n        <FormItem\n          component="singleSelect"\n          label="\u98ce\u683c"\n          name="style"\n          required\n          componentProps={{ dataSource: STYLES, style: { maxWidth: 200 } }}\n        />\n        <FormItem\n          component="testButtonGroup"\n          name="satisfaction"\n          label="\u5ba2\u6237\u6ee1\u610f\u5ea6"\n          required\n          items={\'\u975e\u5e38\u6ee1\u610f\uff0c\u6ee1\u610f\uff0c\u57fa\u672c\u6ee1\u610f\uff0c\u4e0d\u6ee1\u610f\uff0c\u975e\u5e38\u4e0d\u6ee1\u610f\'.split(\'\uff0c\')}\n        />\n        <FormItem component="input" label="\u5ba2\u6237\u8054\u7cfb\u65b9\u5f0f" name="contact" componentProps={{ style: { maxWidth: 200 } }} />\n        <FormItem component="input" label="\u5ba2\u6237\u8054\u7cfb\u5730\u5740" name="address" />\n      </Form.Array>\n\n      <Group mt="m">\n        <Form.Submit />\n        <Form.Reset />\n      </Group>\n\n      <ValuePreview />\n    </Form>\n  );\n}',deps:function(){return[g,x,y,h]},provides:{Form:c.a,dayjs:s.dayjs,arrayCard:c.e,FormItem:c.c,Group:s.Group,ValuePreview:u.a}};function _(){var e=Object(o.useState)(new c.d({texts:[]}))[0];return l.a.createElement(c.a,{model:e},l.a.createElement(c.a.Array,{name:"texts",layout:Object(c.e)({showItemOrder:!0}),itemFactory:function(){return""}},l.a.createElement(c.c,{component:"input",label:"\u59d3\u540d",name:"&",componentProps:{placeholder:"\u8bf7\u8f93\u5165\u4f60\u7684\u540d\u5b57"}})),l.a.createElement(u.a,null))}j.__doc_info=E,j.__inner_source='function ArrayExample() {\n  return (\n    <Form\n      labelPosition="left"\n      defaultValue={{ tickets: [{ name: \'feichao\', date: dayjs().format(\'YYYY-MM-DD\') }] }}\n      onSubmit={(values) => {\n        console.log(\'onSubmit:\', values);\n        showSubmitToast(values);\n      }}\n      onError={(errors) => {\n        console.log(\'onError:\', errors);\n        showErrorToast(errors);\n      }}\n      onReset={(model) => {\n        model.values = { tickets: [{ name: \'feichao\', date: dayjs().format(\'YYYY-MM-DD\') }] };\n      }}\n    >\n      <h4>\u5ba2\u6237\u6ee1\u610f\u5ea6\u8c03\u67e5\u5217\u8868</h4>\n      <Form.Array name="tickets" layout={arrayCard({ showItemOrder: true })}>\n        <FormItem\n          component="input"\n          label="\u5ba2\u6237\u540d\u79f0"\n          name="name"\n          required\n          componentProps={{ style: { maxWidth: 200 } }}\n        />\n        <FormItem component="datePicker" label="\u8d2d\u4e70\u65e5\u671f" name="date" required />\n        <FormItem component="testButtonGroup" label="\u54c1\u724c" name="brand" items={BRANDS} required />\n        <FormItem\n          component="singleSelect"\n          label="\u98ce\u683c"\n          name="style"\n          required\n          componentProps={{ dataSource: STYLES, style: { maxWidth: 200 } }}\n        />\n        <FormItem\n          component="testButtonGroup"\n          name="satisfaction"\n          label="\u5ba2\u6237\u6ee1\u610f\u5ea6"\n          required\n          items={\'\u975e\u5e38\u6ee1\u610f\uff0c\u6ee1\u610f\uff0c\u57fa\u672c\u6ee1\u610f\uff0c\u4e0d\u6ee1\u610f\uff0c\u975e\u5e38\u4e0d\u6ee1\u610f\'.split(\'\uff0c\')}\n        />\n        <FormItem component="input" label="\u5ba2\u6237\u8054\u7cfb\u65b9\u5f0f" name="contact" componentProps={{ style: { maxWidth: 200 } }} />\n        <FormItem component="input" label="\u5ba2\u6237\u8054\u7cfb\u5730\u5740" name="address" />\n      </Form.Array>\n\n      <Group mt="m">\n        <Form.Submit />\n        <Form.Reset />\n      </Group>\n\n      <ValuePreview />\n    </Form>\n  );\n}';var C={filename:"/Users/feichao.sfc/code/github/alibaba/rex-design/packages/story/src/xform/2-advanced-examples.stories.tsx",loc:{start:{line:148,column:7},end:{line:159,column:1}},name:"SelfReference",value:_,source:'function SelfReference() {\n  const [root] = useState(new RootModel({ texts: []  }));\n\n  return (\n    <Form model={root}>\n      <Form.Array name="texts" layout={arrayCard({ showItemOrder: true })} itemFactory={() => \'\'}>\n        <FormItem component="input" label="\u59d3\u540d" name="&" componentProps={{ placeholder: \'\u8bf7\u8f93\u5165\u4f60\u7684\u540d\u5b57\' }} />\n      </Form.Array>\n      <ValuePreview />\n    </Form>\n  );\n}',deps:function(){return[]},provides:{useState:o.useState,RootModel:c.d,Form:c.a,arrayCard:c.e,FormItem:c.c,ValuePreview:u.a}};_.__inner_source='function SelfReference() {\n  const [root] = useState(new RootModel({ texts: []  }));\n\n  return (\n    <Form model={root}>\n      <Form.Array name="texts" layout={arrayCard({ showItemOrder: true })} itemFactory={() => \'\'}>\n        <FormItem component="input" label="\u59d3\u540d" name="&" componentProps={{ placeholder: \'\u8bf7\u8f93\u5165\u4f60\u7684\u540d\u5b57\' }} />\n      </Form.Array>\n      <ValuePreview />\n    </Form>\n  );\n}',_.__doc_info=C;var F,A={id:"advanced",title:"xform \u8fdb\u9636"},w={unversionedId:"xform/advanced",id:"xform/advanced",isDocsHomePage:!1,title:"xform \u8fdb\u9636",description:"\u672c\u9875\u4e3b\u8981\u4ecb\u7ecd xform \u7684\u4e00\u4e9b\u8fdb\u9636\u7528\u6cd5\uff0c\u5305\u62ec\u5d4c\u5957\u7684\u8868\u5355\u6570\u636e\u7ed3\u6784\uff08\u5bf9\u8c61\u6216\u6570\u7ec4\uff09\uff0c\u5206\u5f62\u4e0e\u5bf9\u5e94\u7684 model/field API \u7b49\u3002",source:"@site/docs/xform/advanced.mdx",sourceDirName:"xform",slug:"/xform/advanced",permalink:"/rex-design/docs/xform/advanced",editUrl:"https://github.com/alibaba/rex-design/edit/main/packages/doc/docs/xform/advanced.mdx",version:"current",frontMatter:{id:"advanced",title:"xform \u8fdb\u9636"},sidebar:"docs",previous:{title:"xform",permalink:"/rex-design/docs/xform/usage"},next:{title:"xform \u4e1a\u52a1\u793a\u4f8b",permalink:"/rex-design/docs/xform/biz"}},N=[{value:"<code>Form.Object</code>",id:"formobject",children:[]},{value:"<code>Form.Array</code>",id:"formarray",children:[]},{value:"\u5206\u5f62",id:"\u5206\u5f62",children:[]},{value:"Model",id:"model",children:[{value:"<code>model.getSubModel(name): Model</code>",id:"modelgetsubmodelname-model",children:[]},{value:"<code>model.getSubArray(name)</code>",id:"modelgetsubarrayname",children:[]},{value:"model \u4e2d\u7684\u5176\u4ed6\u5c5e\u6027/\u65b9\u6cd5",id:"model-\u4e2d\u7684\u5176\u4ed6\u5c5e\u6027\u65b9\u6cd5",children:[]}]},{value:"Field",id:"field",children:[]},{value:"modelUtils &amp; fieldUtils",id:"modelutils--fieldutils",children:[]}],R=(F="Story",function(e){return console.warn("Component "+F+" was not imported, exported, or provided by MDXProvider as global scope"),Object(i.b)("div",e)}),I={toc:N};function V(e){var n=e.components,t=Object(r.a)(e,["components"]);return Object(i.b)("wrapper",Object(a.a)({},I,t,{components:n,mdxType:"MDXLayout"}),Object(i.b)("p",null,"\u672c\u9875\u4e3b\u8981\u4ecb\u7ecd xform \u7684\u4e00\u4e9b\u8fdb\u9636\u7528\u6cd5\uff0c\u5305\u62ec\u5d4c\u5957\u7684\u8868\u5355\u6570\u636e\u7ed3\u6784\uff08\u5bf9\u8c61\u6216\u6570\u7ec4\uff09\uff0c\u5206\u5f62\u4e0e\u5bf9\u5e94\u7684 model/field API \u7b49\u3002"),Object(i.b)("h2",{id:"formobject"},Object(i.b)("inlineCode",{parentName:"h2"},"Form.Object")),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"<Form.Object name={name} />")," \u4ee5\u5f53\u524d model \u4e3a\u57fa\u7840\uff0c\u4e3a\u5176\u5b50\u8282\u70b9\u63d0\u4f9b\u4e00\u4e2a\u65b0\u7684 sub model\uff0c\u5e76\u5c06\u5b50\u8282\u70b9\u4e2d\u7684\u8868\u5355\u503c\u6536\u96c6\u5230\u5f53\u524d model \u4e2d ",Object(i.b)("inlineCode",{parentName:"p"},"name")," \u5bf9\u5e94\u7684\u4f4d\u7f6e\u3002"),Object(i.b)("p",null,"\u793a\u4f8b\uff1a \u5728\u4e0b\u9762\u7684\u5bb6\u5ead\u4fe1\u606f\u767b\u8bb0\u8868\u4e2d\uff0c\u300c\u4e2a\u4eba\u4fe1\u606f\u300d\u3001\u300c\u7236\u4eb2\u300d\u7b49\u90e8\u5206\u7684\u8868\u5355\u662f\u5b8c\u5168\u76f8\u540c\u7684\uff0c\u6b64\u65f6\u6211\u4eec\u53ef\u4ee5\u5c06\u8fd9\u4e9b\u76f8\u540c\u90e8\u5206\u62bd\u53d6\u5230 PersonForm \u4e2d\uff0c\u5e76\u7528 Form.Object \u6765\u6307\u5b9a\u5176\u5728\u4e0a\u5c42 model \u4e2d\u7684\u6570\u636e\u5b57\u6bb5\u3002"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-jsx"},'function PersonForm({ name, label }) {\n  return (\n    <div>\n      <p>{label}</p>\n      <Form.Object name={name}>\n        <FormItem name="name" label="\u59d3\u540d" />\n        <FormItem name="age" label="\u5e74\u9f84" />\n        <FormItem name="gender" label="\u6027\u522b" items={[\'\u7537\', \'\u5973\']} />\n      </Form.Object>\n    </div>\n  );\n}\n\nfunction FamilyForm() {\n  return (\n    <div>\n      <PersonForm name="me" label="\u4e2a\u4eba\u4fe1\u606f" />\n      <PersonForm name="father" label="\u7236\u4eb2" />\n      <PersonForm name="mother" label="\u6bcd\u4eb2" />\n      <PersonForm name="urgency" label="\u5176\u4ed6\u7d27\u6025\u8054\u7cfb\u4eba" />\n    </div>\n  );\n}\n')),Object(i.b)(R,{fn:p,mdxType:"Story"}),Object(i.b)("div",{className:"admonition admonition-tip alert alert--success"},Object(i.b)("div",{parentName:"div",className:"admonition-heading"},Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",{parentName:"h5",className:"admonition-icon"},Object(i.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},Object(i.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),Object(i.b)("div",{parentName:"div",className:"admonition-content"},Object(i.b)("p",{parentName:"div"},"\u4e3a Form.Object \u8bbe\u7f6e ",Object(i.b)("inlineCode",{parentName:"p"},'name="&"'),"\uff0c \u53ef\u4ee5\u5c06\u5f53\u524d model \u900f\u4f20\u81f3\u5b50\u8282\u70b9\uff08\u76f8\u5f53\u4e8e\u6ca1\u5199 Form.Object\uff09\u3002"))),Object(i.b)("h2",{id:"formarray"},Object(i.b)("inlineCode",{parentName:"h2"},"Form.Array")),Object(i.b)("p",null,"API: ",Object(i.b)("inlineCode",{parentName:"p"},"<Form.Array name={name} itemFactory={itemFactory} layout={layout} />")),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"<Form.Array name={name} />"),"\uff1a \u4ee5\u5f53\u524d model \u4e3a\u57fa\u7840\uff0c\u4e3a\u5176\u5b50\u8282\u70b9\u63d0\u4f9b\u4e00\u4e2a\u65b0\u7684 sub model\uff0c\u5e76\u5c06\u5b50\u8282\u70b9\u4e2d\u7684\u8868\u5355\u503c\u6536\u96c6\u5230\u5f53\u524d model \u4e2d ",Object(i.b)("inlineCode",{parentName:"p"},"{name}.{itemIndex}")," \u5bf9\u5e94\u7684\u4f4d\u7f6e\u3002"),Object(i.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(i.b)("div",{parentName:"div",className:"admonition-heading"},Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",{parentName:"h5",className:"admonition-icon"},Object(i.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(i.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),Object(i.b)("div",{parentName:"div",className:"admonition-content"},Object(i.b)("p",{parentName:"div"},"Form.Array \u4e0e Form.Object \u975e\u5e38\u7c7b\u4f3c\uff0c\u4f46\u7528\u4e8e\u5904\u7406\u6570\u7ec4\u3002"),Object(i.b)("p",{parentName:"div"},"\u6ce8\u610f Form.Array \u4e3a\u5176\u5b50\u8282\u70b9\u63d0\u4f9b\u7684 sub model \u5305\u542b\u4e24\u5c42\u4e0b\u6807 ",Object(i.b)("inlineCode",{parentName:"p"},"{name}.{itemIndex}"),"\uff1a ",Object(i.b)("inlineCode",{parentName:"p"},"name")," \u8868\u793a\u6570\u7ec4\u6240\u5728\u7684\u5b57\u6bb5\u540d\u79f0\uff0c ",Object(i.b)("inlineCode",{parentName:"p"},"itemIndex")," \u8868\u793a\u6570\u7ec4\u5143\u7d20\u4e0b\u6807\u3002"))),Object(i.b)("p",null,"Form.Array \u5176\u4ed6\u53c2\u6570\uff1a"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"layout")," \u63a7\u5236\u8868\u5355\u5982\u4f55\u5bf9\u6570\u7ec4\u8fdb\u884c\u5e03\u5c40\uff0c\u5305\u62ec\u6570\u7ec4\u4e2d\u6bcf\u4e00\u4e2a\u5143\u7d20\u7684\u5e03\u5c40 \u4ee5\u53ca \u76f8\u5173\u7684\u64cd\u4f5c\u6309\u94ae\uff08\u6dfb\u52a0\u3001\u5220\u9664\u3001\u4e0a\u79fb\u3001\u4e0b\u79fb\u7b49\uff09",Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},"xform \u63d0\u4f9b\u4e00\u4e9b\u5185\u7f6e\u7684\u6570\u7ec4\u5e03\u5c40\uff0c\u5982\u679c\u4e0d\u6ee1\u8db3\u4f60\u7684\u9700\u6c42\uff0c\u4f60\u4e5f\u53ef\u4ee5\u5728\u4e0a\u5c42\u5b9e\u73b0\u65b0\u7684\u6570\u7ec4\u5e03\u5c40"))),Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"itemFactory")," \u7528\u4e8e\u8bbe\u7f6e\u6570\u7ec4\u4e2d\u65b0\u589e\u5143\u7d20\u7684\u521d\u59cb\u503c")),Object(i.b)("p",null,"\u793a\u4f8b\uff1a \u5728\u4e0b\u9762\u7684\u300c\u5ba2\u6237\u6ee1\u610f\u5ea6\u8c03\u67e5\u5217\u8868\u300d\u4e2d\uff0c\u6211\u4eec\u7528 Form.Array \u5305\u88f9\u4e86\u591a\u4e2a FormItem\u3002"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-jsx"},'<Form.Array name="tickets" layout={arrayCard({ showItemOrder: true })}>\n  <FormItem label="\u5ba2\u6237\u540d\u79f0" name="name" />\n  <FormItem label="\u8d2d\u4e70\u65e5\u671f" name="date" />\n  <FormItem label="\u54c1\u724c" name="brand" />\n  {/* \u8c03\u67e5\u7ed3\u679c\u8868\u5355\u5185\u5bb9 */}\n</Form.Array>\n')),Object(i.b)(R,{fn:j,mdxType:"Story"}),Object(i.b)("h2",{id:"\u5206\u5f62"},"\u5206\u5f62"),Object(i.b)("p",null,"\u6240\u8c13\u5206\u5f62\uff0c\u6307\u7684\u5c31\u662f ",Object(i.b)("del",{parentName:"p"},"\u8868\u5355\u5957\u5a03")," ",Object(i.b)("inlineCode",{parentName:"p"},"Form.Object")," \u4e0e ",Object(i.b)("inlineCode",{parentName:"p"},"Form.Array")," \u76f8\u4e92\u5d4c\u5957\u3002"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"\u89c6\u56fe\u5206\u5f62"),"\uff1a \u6bcf\u4e2a ",Object(i.b)("inlineCode",{parentName:"p"},"Form.Object"),"\uff0c",Object(i.b)("inlineCode",{parentName:"p"},"Form.Array"),"\uff0c",Object(i.b)("inlineCode",{parentName:"p"},"FormItem")," \u4e2d name \u5c5e\u6027\u63cf\u8ff0\u300c\u76f8\u5bf9\u4e8e\u4e0a\u5c42 model \u7684\u6570\u636e\u7d22\u5f15\u300d\u3002"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"\u6a21\u578b\u5206\u5f62"),"\uff1a \u6a21\u578b\u7684\u6570\u636e\u7ed3\u6784\u548c API \u53ef\u4ee5\u6ee1\u8db3\u5206\u5f62\u89c6\u56fe\u7684\u9700\u6c42\u3002\u8be6\u89c1\u4e0b\u65b9\u3002"),Object(i.b)("h2",{id:"model"},"Model"),Object(i.b)("p",null,"Model \u7528\u6765\u8868\u793a\u300c\u4e00\u4e2a\u5bf9\u8c61\u6216\u6570\u7ec4\u5bf9\u5e94\u7684\u8868\u5355\u6a21\u578b\u90e8\u5206\u300d\u3002"),Object(i.b)("p",null,"\u4e0e\u5206\u5f62\u89c6\u56fe\u7c7b\u4f3c\uff0c\u6574\u4e2a model \u7684\u7ed3\u6784\u4e5f\u662f\u5206\u5f62\u7684\u3002\u6240\u6709\u7684 model \u90fd\u662f\u4ece RootModel \u5f00\u59cb\u7684\uff0cRootModel \u4e00\u822c\u7531\u4e0a\u5c42\u5f00\u53d1\u8005\u624b\u52a8\u521b\u5efa\u3002"),Object(i.b)("h3",{id:"modelgetsubmodelname-model"},Object(i.b)("inlineCode",{parentName:"h3"},"model.getSubModel(name): Model")),Object(i.b)("p",null,"\u83b7\u53d6\u4e00\u4e2a\u5b50\u6a21\u578b\u3002 \u6ce8\u610f\uff1a"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("strong",{parentName:"li"},"\u5373\u4f7f name \u5bf9\u5e94\u7684\u5b50\u6a21\u578b\u5c1a\u4e0d\u5b58\u5728\uff0c\u8be5\u65b9\u6cd5\u4e5f\u603b\u662f\u4f1a\u8fd4\u56de\u4e00\u4e2a Model \u5bf9\u8c61\u3002")),Object(i.b)("li",{parentName:"ul"},"\u8fd9\u4e2a\u65b9\u6cd5\u4f1a\u5bf9 mobx observable \u8fdb\u884c\u8bfb\u53d6\uff0c\u8bf7\u5728 mobx reaction/computed \u4e2d\u8c03\u7528\u8be5\u65b9\u6cd5",Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},"\u5982\u679c\u4e00\u4e2a React \u7ec4\u4ef6\u7684 render \u4e2d\u8c03\u7528\u4e86\u8be5\u65b9\u6cd5\uff0c\u8bf7\u786e\u4fdd\u7ec4\u4ef6\u88ab observer \u6240\u5305\u88f9")))),Object(i.b)("p",null,"\u6240\u6709\u5bf9 subModel.values \u7684\u8bfb\u5199\u90fd\u4f1a\u53d8\u4e3a\u5bf9 parentModel.values \u7684\u8bfb\u5199\uff0c\u8fd9\u6837\u6211\u4eec\u53ef\u4ee5\u786e\u4fdd ",Object(i.b)("inlineCode",{parentName:"p"},"rootModel.values")," \u662f\u6574\u4e2a\u8868\u5355 values \u7684\u552f\u4e00\u53ef\u4fe1\u6765\u6e90\u3002"),Object(i.b)("p",null,"\u4f8b\u5982\uff0c ",Object(i.b)("inlineCode",{parentName:"p"},"me = familyModel.getSubModel('me')")," \u53ef\u4ee5\u83b7\u53d6\u5230 familyModel \u4e2d me \u5bf9\u5e94\u7684\u5b50\u6a21\u578b\uff0c \u5bf9 me.values \u7684\u4fee\u6539\u4f1a\u8f6c\u53d8\u4e3a familyModel.values \u7684\u4fee\u6539\u3002"),Object(i.b)("h3",{id:"modelgetsubarrayname"},Object(i.b)("inlineCode",{parentName:"h3"},"model.getSubArray(name)")),Object(i.b)("p",null,"\u83b7\u53d6\u4e00\u4e2a\u5b50\u6a21\u578b\uff0c\u4f46\u83b7\u53d6\u7684\u5b50\u6a21\u578b\u7684\u6570\u636e\u683c\u5f0f\u4e3a\u6570\u7ec4\u3002"),Object(i.b)("p",null,"\u4f8b\u5982\u5bf9\u4e8e\u300c\u5ba2\u6237\u6ee1\u610f\u5ea6\u8c03\u67e5\u5217\u8868\u300d\u4e2d\u7684 ",Object(i.b)("inlineCode",{parentName:"p"},"tickets"),"\uff0c\u6211\u4eec\u5e94\u8be5\u4f7f\u7528 ",Object(i.b)("inlineCode",{parentName:"p"},"familyModel.getSubArray('tickets')"),"\uff0c\u800c\u4e0d\u662f\u4f7f\u7528 getSubModel."),Object(i.b)("h3",{id:"model-\u4e2d\u7684\u5176\u4ed6\u5c5e\u6027\u65b9\u6cd5"},"model \u4e2d\u7684\u5176\u4ed6\u5c5e\u6027/\u65b9\u6cd5"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"model.root: RootModel")," \u6307\u5411 RootModel"),Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"model.path: string[]")," \u4ece RootModel \u5230\u5f53\u524d model \u7684\u6570\u636e\u8def\u5f84"),Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"model.parent: IModel")," \u6307\u5411\u4e0a\u4e00\u7ea7\u7684 model",Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},"\u4f8b\u5982\uff1a\u5982\u679c ",Object(i.b)("inlineCode",{parentName:"li"},"model")," \u7684\u8def\u5f84\u4e3a ",Object(i.b)("inlineCode",{parentName:"li"},"['a', 'b', 'c']"),"\uff0c\u5219 ",Object(i.b)("inlineCode",{parentName:"li"},"model.parent")," \u7684\u8def\u5f84\u4e3a ",Object(i.b)("inlineCode",{parentName:"li"},"['a', 'b']")),Object(i.b)("li",{parentName:"ul"},"\u6ce8\u610f\uff0c\u5982\u679c ",Object(i.b)("inlineCode",{parentName:"li"},"subModel = model.getSubModel('a.b')"),"\uff0c\u90a3\u4e48 ",Object(i.b)("inlineCode",{parentName:"li"},"subModel.parent.parent == model")," \u6210\u7acb"))),Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"model.values")," \u6a21\u578b\u4e0a\u7684\u6570\u636e",Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},"\u5bf9 values \u7684\u8bfb\u5199\u5176\u5b9e\u662f\u5bf9 ",Object(i.b)("inlineCode",{parentName:"li"},"model.parent.values")," \u7684\u8bfb\u5199"))),Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"model.getValue(name, defaultValue)")," \u4ee5\u5f53\u524d\u6a21\u578b\u4e3a\u8d77\u59cb\u8def\u5f84\uff0c\u8bfb\u53d6 name \u5904\u7684\u6570\u636e"),Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"model.setValue(name, value)")," \u4ee5\u5f53\u524d\u6a21\u578b\u4e3a\u8d77\u59cb\u8def\u5f84\uff0c\u4fee\u6539 name \u5904\u7684\u6570\u636e"),Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"model.state")," \u6a21\u578b\u7ea7\u522b\u7684\u72b6\u6001\uff0c\u8fd9\u662f\u4e00\u4e2a mobx observable \u5bf9\u8c61\uff0c\u9ed8\u8ba4\u4e3a ",Object(i.b)("inlineCode",{parentName:"li"},"{}"),"\uff0c\u4e00\u822c\u7528\u6765\u7ba1\u7406\u4e00\u4e9b\u8868\u5355\u7684 UI \u72b6\u6001\u3002",Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},"\u6bcf\u4e2a Model \u90fd\u6709\u72ec\u7acb\u7684 state"),Object(i.b)("li",{parentName:"ul"},"\u66f4\u65b0 parentModel.state \u4e0d\u4f1a\u5f71\u54cd subModel.state"),Object(i.b)("li",{parentName:"ul"},"\u66f4\u65b0 subModel.state \u4e5f\u4e0d\u4f1a\u5f71\u54cd parentModel.state"))),Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"model.id: string")," \u6a21\u578b\u5728\u6240\u5c5e\u8868\u5355\u5185\u7684\u552f\u4e00 id")),Object(i.b)("h2",{id:"field"},"Field"),Object(i.b)("p",null,"field \u7528\u6765\u8868\u793a\u300c\u4e00\u4e2a \u89c6\u56fe\u63a7\u4ef6 \u5bf9\u5e94\u7684\u8868\u5355\u6a21\u578b\u90e8\u5206\u300d\u3002model.values \u4e00\u822c\u4e3a\u4e00\u4e2a\u6570\u7ec4\u6216\u4e00\u4e2a\u5bf9\u8c61\uff0c\u800c field.value \u5219\u5f80\u5f80\u6bd4\u8f83\u7b80\u5355\uff0c\u4e00\u822c\u53ea\u662f\u4e00\u4e2a\u5b57\u7b26\u4e32\u6216\u6570\u5b57\u3002"),Object(i.b)("p",null,"field \u5bf9\u8c61\u9700\u8981\u4ece model \u4e2d\u83b7\u53d6\uff1a ",Object(i.b)("inlineCode",{parentName:"p"},"field = model.getField(name)")," \u83b7\u53d6 model \u4e2d name \u5bf9\u5e94\u7684\u5b57\u6bb5\u5bf9\u8c61\uff1bname \u53ef\u4ee5\u662f\u50cf ",Object(i.b)("inlineCode",{parentName:"p"},".foo")," \u8fd9\u6837\u7684\u7b80\u5355\u6807\u8bc6\u7b26\uff0c\u4e5f\u53ef\u4ee5\u662f ",Object(i.b)("inlineCode",{parentName:"p"},".cart.items.0.sku")," \u8fd9\u6837\u7684\u4e00\u4e2a\u5d4c\u5957\u7d22\u5f15\u3002"),Object(i.b)("p",null,"\u6ce8\u610f\uff1a"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("strong",{parentName:"li"},"\u5373\u4f7f name \u5bf9\u5e94\u7684\u5b57\u6bb5\u5c1a\u4e0d\u5b58\u5728\uff0c\u8be5\u65b9\u6cd5\u4e5f\u603b\u662f\u4f1a\u8fd4\u56de\u4e00\u4e2a Field \u5bf9\u8c61"),"\u3002"),Object(i.b)("li",{parentName:"ul"},"\u8fd9\u4e2a\u65b9\u6cd5\u4f1a\u5bf9 mobx observable \u8fdb\u884c\u8bfb\u53d6\uff0c\u8bf7\u5728 mobx reaction/computed \u4e2d\u8c03\u7528\u8be5\u65b9\u6cd5",Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},"\u5982\u679c\u4e00\u4e2a React \u7ec4\u4ef6\u7684 render \u4e2d\u8c03\u7528\u4e86\u8be5\u65b9\u6cd5\uff0c\u8bf7\u786e\u4fdd\u7ec4\u4ef6\u88ab observer \u6240\u5305\u88f9")))),Object(i.b)("p",null,"\u83b7\u53d6 Field \u5bf9\u8c61\u540e\u6211\u4eec\u4f7f\u7528\u4e0b\u5217\u65b9\u6cd5\u64cd\u4f5c\u5b57\u6bb5\uff1a"),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"field.value")," \u8bfb\u53d6\u6216\u8bbe\u7f6e\u5b57\u6bb5\u7684\u503c\u3002 Field \u5bf9\u8c61\u672c\u8eab\u4e0d\u4f1a\u8bb0\u5f55 value\uff0c\u6240\u6709\u5bf9 field.value \u7684\u8bfb\u5199\u90fd\u4f1a\u53d8\u4e3a\u5bf9 model.values \u7684\u8bfb\u5199\uff0c\u8fd9\u6837\u6211\u4eec\u53ef\u4ee5\u786e\u4fdd ",Object(i.b)("inlineCode",{parentName:"p"},"rootModel.values")," \u662f\u6574\u4e2a\u8868\u5355 values \u7684\u552f\u4e00\u53ef\u4fe1\u6765\u6e90\u3002"),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"field.state")," \u5b57\u6bb5\u72b6\u6001\uff0c\u8fd9\u662f\u4e00\u4e2a mobx observable \u5bf9\u8c61\uff0c\u9ed8\u8ba4\u4e3a ",Object(i.b)("inlineCode",{parentName:"p"},"{}"),"\u3002\u76ee\u524d\uff0c\u6211\u4eec\u7ea6\u5b9a\u4e86 ",Object(i.b)("inlineCode",{parentName:"p"},"field.state.error")," \u4f5c\u4e3a\u8be5\u5b57\u6bb5\u4e0a\u7684\u9519\u8bef\u72b6\u6001\uff0c\u5f53 state.error \u6709\u503c\u65f6\uff0c\u9875\u9762\u4e2d\u5c31\u4f1a\u5c55\u793a\u5bf9\u5e94\u7684\u51fa\u9519\u63d0\u793a\u3002"),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"field.config")," \u5b57\u6bb5\u914d\u7f6e\u4fe1\u606f\uff0c\u53cd\u6620\u8be5\u5b57\u6bb5\u5bf9\u5e94\u7684\u63a7\u4ef6\u6700\u8fd1\u4e00\u6b21\u88ab\u6e32\u67d3\u65f6 React Element \u4e0a\u7684 props\uff0c\u5305\u542b config, required, defaultValue \u7b49\u5c5e\u6027\u3002"),Object(i.b)("p",null,"\u5176\u4ed6\u4e0d\u5e38\u7528\u7684\u5c5e\u6027\uff1a"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"field.id: string")," \u5b57\u6bb5\u5728\u6240\u5c5e\u8868\u5355\u5185\u7684\u552f\u4e00 id"),Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"field.mountCount: number")," \u5b57\u6bb5\u5bf9\u5e94\u7684\u63a7\u4ef6\u7684\u52a0\u8f7d\u6570\u91cf",Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},"\u4e00\u822c\u4e3a 0 \u6216 1\uff0c\u8868\u793a\u5b57\u6bb5\u5bf9\u5e94\u7684\u63a7\u4ef6\u662f\u5426\u6e32\u67d3\u5728\u89c6\u56fe\u4e2d"),Object(i.b)("li",{parentName:"ul"},"\u591a\u4e2a\u6307\u5411\u540c\u4e00\u4e2a\u5b57\u6bb5\u7684\u63a7\u4ef6\u88ab\u540c\u65f6\u6e32\u67d3\u65f6\uff0c mountCount \u4f1a\u5927\u4e8e 1"))),Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"field.path: string[]")," \u4ece RootModel \u5230\u8be5\u5b57\u6bb5\u7684\u5b8c\u6574\u8def\u5f84"),Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"field.parent: IModel")," \u6307\u5411\u4e0a\u4e00\u7ea7\u7684 model",Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},"\u4f8b\u5982\uff1a\u5982\u679c ",Object(i.b)("inlineCode",{parentName:"li"},"field")," \u7684\u8def\u5f84\u4e3a ",Object(i.b)("inlineCode",{parentName:"li"},"['a', 'b', 'c']"),"\uff0c\u5219 ",Object(i.b)("inlineCode",{parentName:"li"},"field.parent")," \u7684\u8def\u5f84\u4e3a ",Object(i.b)("inlineCode",{parentName:"li"},"['a', 'b']"))))),Object(i.b)("h2",{id:"modelutils--fieldutils"},"modelUtils & fieldUtils"),Object(i.b)("p",null,"WIP"))}V.isMDXComponent=!0},207:function(e,n,t){"use strict";t.d(n,"h",(function(){return E})),t.d(n,"b",(function(){return x})),t.d(n,"d",(function(){return R})),t.d(n,"a",(function(){return B})),t.d(n,"c",(function(){return X})),t.d(n,"e",(function(){return H})),t.d(n,"f",(function(){return $})),t.d(n,"g",(function(){return P}));var a=t(168),r=t(182),o=t(0),l=t.n(o),i=t(232),s=t.n(i);function c(e){e.subModels.forEach((function(e,n){e.name=String(n)}))}function u(e,n,t){if(null!=e){var a=e[n];e[n]=e[t],e[t]=a}}function m(e){return String(Number.parseInt(e))===e}function d(e){return m(e)?"array":"object"}function p(e,n,t){for(var r=Array.isArray(n)?n:v(n),o=e,l=0;l<r.length;l+=1){if(!a.isObservable(o))return t;o=a.get(o,r[l])}return void 0===o?t:o}function b(e,n,t){for(var r=Array.isArray(n)?n:v(n),o=r.length-1,l=e,i=0;i<o;i+=1){var s=r[i];if(null==a.get(l,s)&&(m(r[i+1])?a.set(l,s,[]):a.set(l,s,{})),l=a.get(l,s),!a.isObservable(l))return}a.isObservable(l)&&a.set(l,r[o],t)}var f={append:Object(a.action)((function(e,n){var t;null==e.values&&(e.values=[]),e.values.push(null!==(t=null==n?void 0:n(e))&&void 0!==t?t:{})})),delete:Object(a.action)((function(e,n){e.values.splice(n,1),s()(Array.isArray(e._proxy.subModels),"arrayModel.subModels should be Array or observable.array"),e._proxy.subModels.splice(n,1),c(e._proxy)})),moveUp:Object(a.action)((function(e,n){0!==n&&(u(e.values,n,n-1),s()(Array.isArray(e._proxy.subModels),"arrayModel.attachedSubModels should be Array or observable.array"),u(e._proxy.subModels,n,n-1),c(e._proxy))})),moveDown:Object(a.action)((function(e,n){n!==e.values.length-1&&(u(e.values,n,n+1),s()(Array.isArray(e._proxy.subModels),"arrayModel.attachedSubModels should be Array or observable.array"),u(e._proxy.subModels,n,n+1),c(e._proxy))})),renderArrayItem:function(e,n,t){return l.a.createElement(C,{name:String(n)},t)},getKey:function(e,n){return e.getSubModel(String(n)).id}};function y(e,n){return void 0!==e?e:n}function v(e){return e.split(".")}try{d.displayName="keyToValueShape",d.__docgenInfo={description:"",displayName:"keyToValueShape",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/core/utils.tsx#keyToValueShape"]={docgenInfo:d.__docgenInfo,name:"keyToValueShape",path:"../xform/src/core/utils.tsx#keyToValueShape"})}catch(Q){}try{p.displayName="observableGetIn",p.__docgenInfo={description:"lodash.get(...) for mobx observables",displayName:"observableGetIn",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/core/utils.tsx#observableGetIn"]={docgenInfo:p.__docgenInfo,name:"observableGetIn",path:"../xform/src/core/utils.tsx#observableGetIn"})}catch(Q){}try{b.displayName="observableSetIn",b.__docgenInfo={description:"lodash.set(...) for mobx observables",displayName:"observableSetIn",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/core/utils.tsx#observableSetIn"]={docgenInfo:b.__docgenInfo,name:"observableSetIn",path:"../xform/src/core/utils.tsx#observableSetIn"})}catch(Q){}try{y.displayName="composeState",y.__docgenInfo={description:"\u5408\u5e76\u53d7\u63a7\u72b6\u6001\u548c \u975e\u53d7\u63a7\u72b6\u6001",displayName:"composeState",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/core/utils.tsx#composeState"]={docgenInfo:y.__docgenInfo,name:"composeState",path:"../xform/src/core/utils.tsx#composeState"})}catch(Q){}try{v.displayName="splitToPath",v.__docgenInfo={description:"",displayName:"splitToPath",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/core/utils.tsx#splitToPath"]={docgenInfo:v.__docgenInfo,name:"splitToPath",path:"../xform/src/core/utils.tsx#splitToPath"})}catch(Q){}var h=function(e,n){var t={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&n.indexOf(a)<0&&(t[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)n.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(t[a[r]]=e[a[r]])}return t},O=l.a.createContext(null),g=O.Provider,S=l.a.createContext({}),x=function(e){var n=e.children,t=h(e,["children"]),a=j();return l.a.createElement(S.Provider,{value:Object.assign(Object.assign({},a),t)},n)};function j(){return Object(o.useContext)(S)}function E(){return Object(o.useContext)(O)}var _=Object(r.a)((function(e){var n,t,a=e.name,r=e.children,o=e.layout,i=e.itemFactory,s=E();if("&"===a)throw new Error("XFormArray \u4e0d\u652f\u6301 name=&. path=("+(s.path.join(".")||"root")+")");var c=s.getSubArray(a),u=null!==(t=null===(n=c.values)||void 0===n?void 0:n.length)&&void 0!==t?t:0;return l.a.createElement(g,{value:c},o({arrayModel:c,itemCount:u,itemContent:r,itemFactory:i}))})),C=Object(r.a)((function(e){var n=e.name,t=e.children,a=E();return"&"===n?l.a.createElement(l.a.Fragment,null,t):l.a.createElement(g,{value:a.getSubModel(n),children:t})})),F=Object(r.a)((function(e){var n=e.name,t=e.required,r=e.children,o=e.defaultValue,l=E(),i=Object(a.computed)((function(){return"&"===n?l._asField():l.getField(n)})).get();i._useTrack(e);var s=y(i.value,o);return r({model:l,name:n,field:i,value:s,required:t,defaultValue:o})}));try{g.displayName="ModelProvider",g.__docgenInfo={description:"",displayName:"ModelProvider",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/core/components.tsx#ModelProvider"]={docgenInfo:g.__docgenInfo,name:"ModelProvider",path:"../xform/src/core/components.tsx#ModelProvider"})}catch(Q){}try{x.displayName="FormEnvProvider",x.__docgenInfo={description:"",displayName:"FormEnvProvider",props:{isPreview:{defaultValue:null,description:"",name:"isPreview",required:!1,type:{name:"boolean"}},onSubmit:{defaultValue:null,description:"",name:"onSubmit",required:!1,type:{name:"(submitValues: any, model: RootModel<unknown>) => void"}},onError:{defaultValue:null,description:"",name:"onError",required:!1,type:{name:"(errors: any, model: RootModel<unknown>) => void"}},onReset:{defaultValue:null,description:"",name:"onReset",required:!1,type:{name:"(model: RootModel<unknown>) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/core/components.tsx#FormEnvProvider"]={docgenInfo:x.__docgenInfo,name:"FormEnvProvider",path:"../xform/src/core/components.tsx#FormEnvProvider"})}catch(Q){}try{_.displayName="XFormArray",_.__docgenInfo={description:"\u5bf9\u8c61\u6570\u7ec4\u8868\u5355",displayName:"XFormArray",props:{name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"string"}},layout:{defaultValue:null,description:"",name:"layout",required:!0,type:{name:"(input: XFormArrayLayoutInput) => ReactElement<any, string | JSXElementConstructor<any>>"}},itemFactory:{defaultValue:null,description:"",name:"itemFactory",required:!1,type:{name:"(arrayModel: Model<unknown[]>) => any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/core/components.tsx#XFormArray"]={docgenInfo:_.__docgenInfo,name:"XFormArray",path:"../xform/src/core/components.tsx#XFormArray"})}catch(Q){}try{C.displayName="XFormObject",C.__docgenInfo={description:"\u4e3a\u8be5\u7ec4\u4ef6\u4e0b\u7684 XFormField \u6dfb\u52a0\u4e00\u4e2a\u6570\u636e\u5b57\u6bb5\u524d\u7f00",displayName:"XFormObject",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/core/components.tsx#XFormObject"]={docgenInfo:C.__docgenInfo,name:"XFormObject",path:"../xform/src/core/components.tsx#XFormObject"})}catch(Q){}try{F.displayName="XFormField",F.__docgenInfo={description:"\u8868\u5355\u5b57\u6bb5\uff08field\uff09\n\n\u5728 xform \u4e2d\uff0c\u4e00\u4e2a\u300c\u5b57\u6bb5\u300d\u5305\u542b\u4e00\u4e2a\u300c\u89c6\u56fe\u63a7\u4ef6\u5b9e\u4f8b\u300d\uff08\u4f8b\u5982 Input\uff0cSelect \u5b9e\u4f8b\uff09\u548c\u4e00\u4efd\u72b6\u6001\uff08\u4f8b\u5982 Input \u5305\u542b\u4e00\u4e2a\u5b57\u7b26\u4e32\u72b6\u6001\uff09\uff1b\nXFormField \u662f\u4e00\u4e2a\u9ad8\u9636\u7ec4\u4ef6 / \u57fa\u7840\u7ec4\u4ef6\uff0c\u6bcf\u4e2a\u5177\u4f53\u7684\u7ec4\u4ef6\u7c7b\u578b\uff08\u4f8b\u5982 Input\uff0cSelect \uff09\u90fd\u5e94\u8be5\u7ee7\u627f\u8be5\u7ec4\u4ef6\u5e76\u5c01\u88c5\u76f8\u5e94\u7684 FieldItem\uff1b",displayName:"XFormField",props:{name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"string"}},label:{defaultValue:null,description:"",name:"label",required:!1,type:{name:"ReactNode"}},validate:{defaultValue:null,description:"",name:"validate",required:!1,type:{name:"(value: any) => any"}},required:{defaultValue:null,description:"",name:"required",required:!1,type:{name:"boolean"}},defaultValue:{defaultValue:null,description:"",name:"defaultValue",required:!1,type:{name:"any"}},isEmpty:{defaultValue:null,description:"",name:"isEmpty",required:!1,type:{name:"(value: any) => boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/core/components.tsx#XFormField"]={docgenInfo:F.__docgenInfo,name:"XFormField",path:"../xform/src/core/components.tsx#XFormField"})}catch(Q){}var A=t(219),w=function(){function e(e,n){this.fieldMap=new Map,this.model=e,this.valueShape=n,this.subModels="array"===n?[]:{}}var n=e.prototype;return n.iterateModels=function(e){!function n(t){Object.values(t.subModels).forEach((function(t){e(t),n(t._proxy)}))}(this)},n.iterateFields=function(e){this.fieldMap.forEach(e),this.iterateModels((function(n){n._proxy.fieldMap.forEach(e)}))},n.getSubModel=function(e,n){void 0===n&&(n="object");for(var t=Array.isArray(e)?e:v(e),a=this.model,r=0;r<t.length-1;r++)a=a._proxy._getSubModel(t[r],d(t[r+1]));return a._proxy._getSubModel(t[t.length-1],n)},n._getSubModel=function(e,n){void 0===n&&(n="object"),s()(!e.includes("."),"name \u4e2d\u4e0d\u80fd\u5305\u542b .");var t=this.subModels[e];return null==t&&(t=new I(this.model,e,n),this.subModels[e]=t),t},n.getField=function(e){var n=Array.isArray(e)?e:v(e);if(n.length>1)return this.getSubModel(n[0],d(n[1])).getField(n.slice(1));var t=n[0],a=this.fieldMap.get(t);return null==a&&(a=new V(this.model,t),this.fieldMap.set(t,a)),a},e}(),N=[],R=function(){function e(e){void 0===e&&(e={}),this._nextModelId=1,this._nextFieldId=1,this.state={},this.root=this,this.parent=this,this.path=N,this.valueShape="object",this._proxy=new w(this,"object"),this.values=e,Object(a.makeObservable)(this,{values:a.observable,state:a.observable,setValue:a.action})}var n=e.prototype;return n.getNextModelId=function(){return"Model_"+this._nextModelId++},n.getNextFieldId=function(){return"Field_"+this._nextFieldId++},n.getValue=function(e,n){return p(this.values,e,n)},n.setValue=function(e,n){b(this.values,e,n)},n.getSubModel=function(e){return this._proxy.getSubModel(e,"object")},n.getSubArray=function(e){return this._proxy.getSubModel(e,"array")},n.getField=function(e){return this._proxy.getField(e)},n._asField=function(){throw new Error("RootModel \u4e0b\u4e0d\u652f\u6301\u4f7f\u7528 name=& \u7684 Field")},e}(),I=function(){function e(e,n,t){this.state={},s()(!n.includes("."),"name \u4e2d\u4e0d\u80fd\u5305\u542b ."),this.root=e.root,this.parent=e,this.name=n,this.valueShape=t,this._proxy=new w(this,t),this.id=this.root.getNextModelId(),Object(a.makeObservable)(this,{values:a.computed,state:a.observable,setValue:a.action,name:a.observable},{name:this.id+"("+this.name+")"})}var n=e.prototype;return n.getSubModel=function(e){return this._proxy.getSubModel(e,"object")},n.getSubArray=function(e){return this._proxy.getSubModel(e,"array")},n.getField=function(e){return this._proxy.getField(e)},n.getValue=function(e,n){return p(this.values,e,n)},n.setValue=function(e,n){null==this.values&&(this.values="array"===this.valueShape?[]:{}),b(this.values,e,n)},n._asField=function(){return this.parent.getField(this.name)},Object(A.a)(e,[{key:"path",get:function(){return[].concat(this.parent.path,[this.name])}},{key:"values",get:function(){return this.parent.getValue(this.name)},set:function(e){this.parent.setValue(this.name,e)}}]),e}(),V=function(){function e(e,n){this.config=null,this.mountCount=0,this.state={},this.parent=e,this.name=n,this.id=this.parent.root.getNextFieldId(),Object(a.makeObservable)(this,{state:a.observable,name:a.observable.ref,value:a.computed,path:a.computed,config:!1,mountCount:!1},{name:this.id+"("+this.name+")"})}return e.prototype._useTrack=function(e){var n=this;Object(o.useLayoutEffect)((function(){return n.config=e,n.mountCount+=1,function(){n.config=null,n.mountCount-=1}}),[e])},Object(A.a)(e,[{key:"value",get:function(){return this.parent.getValue(this.name)},set:function(e){this.parent.setValue(this.name,e)}},{key:"path",get:function(){return this.parent.path.concat([this.name])}}]),e}(),T=t(162),M={validate:Object(a.action)((function(e){if(null!=e.config){var n,t=e.config,a=t.validate,r=t.required,o=t.defaultValue,l=t.isEmpty,i=e.value;return n=r&&l(i)?"\u8be5\u5b57\u6bb5\u662f\u5fc5\u586b\u5b57\u6bb5":null==a?void 0:a(y(i,o)),e.state.error=n,n}})),handleBlur:function(e){M.validate(e)},handleChange:Object(a.action)((function(e,n){e.value=n,M.validate(e)}))},P={clearError:Object(a.action)((function(e){e._proxy.iterateFields((function(e){e.state.error=null}))})),validateAll:Object(a.action)((function(e){var n=Object(a.observable)("array"===e.valueShape?[]:{}),t=!1;return e._proxy.iterateFields((function(e){if(0!==e.mountCount){var a=M.validate(e);a&&(t=!0,b(n,e.path,a))}})),{hasError:t,errors:Object(a.toJS)(n)}}))},k=function(e,n){var t={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&n.indexOf(a)<0&&(t[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)n.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(t[a[r]]=e[a[r]])}return t};function B(e){var n=e.model,t=e.defaultValue,a=e.isPreview,r=e.isInline,i=e.labelPosition,s=e.onSubmit,c=e.onError,u=e.onReset,m=e.children,d=e.className,p=e.style,b=y(n,Object(o.useState)((function(){return new R(t)}))[0]);return l.a.createElement(x,{isPreview:a,onError:c,onReset:u,onSubmit:s},l.a.createElement(g,{value:b},l.a.createElement(T.FormLayout,{labelPosition:i,isInline:r,style:p,className:d},m)))}var q=Object(r.a)((function(e){var n=e.watch,t=e.effect,r=E(),l=r.getField(n);return Object(o.useEffect)((function(){return Object(a.reaction)((function(){return l.value}),(function(e,n){return t(e,{model:r,prev:n,next:e})}))}),[r,n,l,t]),null})),L=Object(r.a)((function(e){return(0,e.children)(E())}));B.Submit=function(e){var n=e.type,t=void 0===n?"primary":n,r=e.children,o=void 0===r?"\u63d0\u4ea4":r,i=k(e,["type","children"]),s=E().root,c=j(),u=c.onSubmit,m=c.onError;return l.a.createElement(T.Button,Object.assign({onClick:function(){var e=P.validateAll(s),n=e.hasError,t=e.errors;if(n)null==m||m(t,s);else if("function"==typeof u){var r=Object(a.observable)("array"===s.valueShape?[]:{});s._proxy.iterateFields((function(e){if(0!==e.mountCount){var n=e.path,t=e.value;b(r,n,t)}})),u(Object(a.toJS)(r),s)}},type:t,children:o},i))},B.Reset=function(e){var n=e.children,t=void 0===n?"\u91cd\u7f6e":n,r=k(e,["children"]),o=E().root,i=j().onReset;return l.a.createElement(T.Button,Object.assign({onClick:Object(a.action)((function(){o.values={},P.clearError(o),null==i||i(o)})),children:t},r))},B.Effect=q,B.Array=_,B.Object=C,B.Field=F,B.ModelConsumer=L;try{B.displayName="Form",B.__docgenInfo={description:"",displayName:"Form",props:{model:{defaultValue:null,description:"\u53d7\u63a7\u7528\u6cd5\u3002 xform \u6a21\u578b\u5bf9\u8c61\uff0c\u4e00\u822c\u7531\u4e0a\u5c42\u901a\u8fc7 new RootModel(...) \u521b\u5efa\u800c\u6210",name:"model",required:!1,type:{name:"IModel<unknown>"}},defaultValue:{defaultValue:null,description:"\u975e\u53d7\u63a7\u7528\u6cd5\u3002 \u8868\u5355\u7684\u9ed8\u8ba4\u503c",name:"defaultValue",required:!1,type:{name:"any"}},onSubmit:{defaultValue:null,description:"\u63d0\u4ea4\u8868\u5355\u65f6\u7684\u56de\u8c03\u51fd\u6570\uff0c\u9700\u914d\u5408 <Form.Submit /> \u4f7f\u7528",name:"onSubmit",required:!1,type:{name:"(submitValues: any, model: RootModel<unknown>) => void"}},onError:{defaultValue:null,description:"\u63d0\u4ea4\u8868\u5355\u65f6\u7684\u51fa\u9519\u56de\u8c03\u51fd\u6570\uff0c\u9700\u914d\u5408 <Form.Submit /> \u4f7f\u7528",name:"onError",required:!1,type:{name:"(errors: any, model: RootModel<unknown>) => void"}},onReset:{defaultValue:null,description:"\u6e05\u7a7a\u8868\u5355\u65f6\u7684\u56de\u8c03\u51fd\u6570\uff0c\u9700\u914d\u5408 <Form.Reset /> \u4f7f\u7528",name:"onReset",required:!1,type:{name:"(model: RootModel<unknown>) => void"}},isPreview:{defaultValue:{value:"false"},description:"\u662f\u5426\u4e3a\u9884\u89c8\u6001",name:"isPreview",required:!1,type:{name:"boolean"}},isInline:{defaultValue:{value:"false"},description:"\u662f\u5426\u5185\u8054\u5e03\u5c40\n@category \u5e03\u5c40",name:"isInline",required:!1,type:{name:"boolean"}},labelPosition:{defaultValue:{value:"'top'"},description:"\u6807\u7b7e\u4f4d\u7f6e\n@category \u5e03\u5c40",name:"labelPosition",required:!1,type:{name:'"top" | "left"'}},style:{defaultValue:null,description:"@category \u5e03\u5c40",name:"style",required:!1,type:{name:"CSSProperties"}},className:{defaultValue:null,description:"@category \u5e03\u5c40",name:"className",required:!1,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/form.tsx#Form"]={docgenInfo:B.__docgenInfo,name:"Form",path:"../xform/src/form.tsx#Form"})}catch(Q){}try{B.Submit.displayName="Form.Submit",B.Submit.__docgenInfo={description:"",displayName:"Form.Submit",props:{shape:{defaultValue:null,description:"",name:"shape",required:!1,type:{name:'"solid" | "text" | "link" | "warning" | "ghost"'}},type:{defaultValue:{value:"primary"},description:"",name:"type",required:!1,type:{name:'"normal" | "primary" | "secondary"'}},size:{defaultValue:null,description:"",name:"size",required:!1,type:{name:'"small" | "medium" | "large"'}},htmlType:{defaultValue:null,description:"",name:"htmlType",required:!1,type:{name:'"button" | "submit" | "reset"'}},isFullWidth:{defaultValue:null,description:"",name:"isFullWidth",required:!1,type:{name:"boolean"}},isSelected:{defaultValue:null,description:"",name:"isSelected",required:!1,type:{name:"boolean"}},loading:{defaultValue:null,description:"",name:"loading",required:!1,type:{name:"boolean"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},leftElement:{defaultValue:null,description:"",name:"leftElement",required:!1,type:{name:"ReactNode"}},rightElement:{defaultValue:null,description:"",name:"rightElement",required:!1,type:{name:"ReactNode"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/form.tsx#Form.Submit"]={docgenInfo:B.Submit.__docgenInfo,name:"Form.Submit",path:"../xform/src/form.tsx#Form.Submit"})}catch(Q){}try{B.Reset.displayName="Form.Reset",B.Reset.__docgenInfo={description:"",displayName:"Form.Reset",props:{shape:{defaultValue:null,description:"",name:"shape",required:!1,type:{name:'"solid" | "text" | "link" | "warning" | "ghost"'}},type:{defaultValue:null,description:"",name:"type",required:!1,type:{name:'"normal" | "primary" | "secondary"'}},size:{defaultValue:null,description:"",name:"size",required:!1,type:{name:'"small" | "medium" | "large"'}},htmlType:{defaultValue:null,description:"",name:"htmlType",required:!1,type:{name:'"button" | "submit" | "reset"'}},isFullWidth:{defaultValue:null,description:"",name:"isFullWidth",required:!1,type:{name:"boolean"}},isSelected:{defaultValue:null,description:"",name:"isSelected",required:!1,type:{name:"boolean"}},loading:{defaultValue:null,description:"",name:"loading",required:!1,type:{name:"boolean"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},leftElement:{defaultValue:null,description:"",name:"leftElement",required:!1,type:{name:"ReactNode"}},rightElement:{defaultValue:null,description:"",name:"rightElement",required:!1,type:{name:"ReactNode"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/form.tsx#Form.Reset"]={docgenInfo:B.Reset.__docgenInfo,name:"Form.Reset",path:"../xform/src/form.tsx#Form.Reset"})}catch(Q){}try{B.Effect.displayName="Form.Effect",B.Effect.__docgenInfo={description:"",displayName:"Form.Effect",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/form.tsx#Form.Effect"]={docgenInfo:B.Effect.__docgenInfo,name:"Form.Effect",path:"../xform/src/form.tsx#Form.Effect"})}catch(Q){}try{B.Array.displayName="Form.Array",B.Array.__docgenInfo={description:"",displayName:"Form.Array",props:{name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"string"}},layout:{defaultValue:null,description:"",name:"layout",required:!0,type:{name:"(input: XFormArrayLayoutInput) => ReactElement<any, string | JSXElementConstructor<any>>"}},itemFactory:{defaultValue:null,description:"",name:"itemFactory",required:!1,type:{name:"(arrayModel: Model<unknown[]>) => any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/form.tsx#Form.Array"]={docgenInfo:B.Array.__docgenInfo,name:"Form.Array",path:"../xform/src/form.tsx#Form.Array"})}catch(Q){}try{B.Object.displayName="Form.Object",B.Object.__docgenInfo={description:"",displayName:"Form.Object",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/form.tsx#Form.Object"]={docgenInfo:B.Object.__docgenInfo,name:"Form.Object",path:"../xform/src/form.tsx#Form.Object"})}catch(Q){}try{B.Field.displayName="Form.Field",B.Field.__docgenInfo={description:"",displayName:"Form.Field",props:{name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"string"}},label:{defaultValue:null,description:"",name:"label",required:!1,type:{name:"ReactNode"}},validate:{defaultValue:null,description:"",name:"validate",required:!1,type:{name:"(value: any) => any"}},required:{defaultValue:null,description:"",name:"required",required:!1,type:{name:"boolean"}},defaultValue:{defaultValue:null,description:"",name:"defaultValue",required:!1,type:{name:"any"}},isEmpty:{defaultValue:null,description:"",name:"isEmpty",required:!1,type:{name:"(value: any) => boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/form.tsx#Form.Field"]={docgenInfo:B.Field.__docgenInfo,name:"Form.Field",path:"../xform/src/form.tsx#Form.Field"})}catch(Q){}try{B.ModelConsumer.displayName="Form.ModelConsumer",B.ModelConsumer.__docgenInfo={description:"",displayName:"Form.ModelConsumer",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/form.tsx#Form.ModelConsumer"]={docgenInfo:B.ModelConsumer.__docgenInfo,name:"Form.ModelConsumer",path:"../xform/src/form.tsx#Form.ModelConsumer"})}catch(Q){}var Y=function(e,n){var t={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&n.indexOf(a)<0&&(t[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)n.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(t[a[r]]=e[a[r]])}return t};function K(e){var n;return null!==(n=e.value)&&void 0!==n?n:e.defaultValue}function J(e){return!e}function G(e){return null==e}function U(e){return null==e||Array.isArray(e)&&0===e.length}var D={};function z(e,n){function t(t){var a=t.defaultValue,r=void 0===a?n.fallbackValue:a,o=t.componentProps,i=t.value,s=t.onChange,c=t.onBlur,u=Y(t,["defaultValue","componentProps","value","onChange","onBlur"]),m=j().isPreview;return l.a.createElement(F,Object.assign({defaultValue:r,isEmpty:n.isEmpty},u),(function(t){t.model,t.name;var a=t.field,r=t.value,d=t.required,p=a.state.error,b=Object.assign(Object.assign(Object.assign({},Object(T.pick)(u,["dataSource","items"])),o),{value:void 0!==i?i:r,onChange:void 0!==s?s:function(e){return M.handleChange(a,e)},onBlur:void 0!==c?c:function(){return M.handleBlur(a)},status:p?"error":void 0});return l.a.createElement(T.FormControl,{label:u.label,required:d,error:p},m?n.previewRender(b):l.a.createElement(e,Object.assign({},b)))}))}t.displayName="FormItem("+n.name+")",D[n.name]=t}function X(e){var n=e.component,t=Y(e,["component"]),a=D[n];return null==a?l.a.createElement(T.FormControl,null,l.a.createElement("div",{style:{border:"1px dashed var(--rex-colors-error-hover)",fontSize:14,padding:4,color:"var(--rex-colors-error-normal)"}},l.a.createElement("code",null,"<FormItem component='",n,"' />")," \u6ca1\u6709\u627e\u5230\u5bf9\u5e94\u7ec4\u4ef6\uff0c\u8bf7\u68c0\u67e5\u7ec4\u4ef6\u540d\u79f0\u662f\u5426\u62fc\u5199\u6b63\u786e")):l.a.createElement(a,t)}z(T.Switch,{name:"switch",previewRender:function(e){var n;return(null!==(n=e.value)&&void 0!==n?n:e.defaultValue)?"\u662f":"\u5426"},fallbackValue:!1,isEmpty:J}),z(T.CheckboxGroup,{name:"checkboxGroup",fallbackValue:[],previewRender:function(e){var n,t=null!==(n=e.value)&&void 0!==n?n:e.defaultValue,a=new T.ListStore(e.dataSource);return t.map((function(e){var n=a.getItem(e);return n?n.label:e})).join("\u3001")},isEmpty:function(e){return null==e||0===e.length}}),z(T.RadioGroup,{name:"radioGroup",fallbackValue:null,previewRender:function(e){var n,t=null!==(n=e.value)&&void 0!==n?n:e.defaultValue,a=new T.ListStore(e.dataSource).getItem(t);return a?a.label:t},isEmpty:J}),z(T.DatePicker,{name:"datePicker",previewRender:K,fallbackValue:null,isEmpty:J}),z(T.DateRangePicker,{name:"dateRangePicker",previewRender:function(e){var n,t=(null!==(n=e.value)&&void 0!==n?n:e.defaultValue)||[];return(t[0]||"-")+" ~ "+(t[1]||"-")},fallbackValue:["",""],isEmpty:J}),z(T.TimePicker,{name:"timePicker",previewRender:K,fallbackValue:"",isEmpty:J}),z(T.FilePicker,{name:"filePicker",previewRender:function(e){var n,t=(null!==(n=e.value)&&void 0!==n?n:e.defaultValue)||[];return l.a.createElement(T.Flex,{spacing:"s",direction:"column"},t.map((function(e){var n=e.id,t=e.name,a=e.url;return l.a.createElement(T.FlexItem,{key:n,bg:"fill.layer1",px:"m"},l.a.createElement(T.Link,{href:a},t))})))},fallbackValue:[],isEmpty:U}),z(T.MediaPicker,{name:"mediaPicker",previewRender:function(e){var n,t=(null!==(n=e.value)&&void 0!==n?n:e.defaultValue)||[];return l.a.createElement(T.Flex,{spacing:"m"},t.map((function(e){var n=e.id,t=e.name,a=e.url,r=Object(T.colors)("fill.layer1")+" url("+a+") center center / 100% no-repeat";return l.a.createElement(T.Box,{key:n,size:"100px",title:t,display:"inline-block",style:{background:r}})})))},fallbackValue:[],isEmpty:U}),z(T.Input,{name:"input",previewRender:K,fallbackValue:"",isEmpty:J}),z(T.Textarea,{name:"textarea",previewRender:K,fallbackValue:"",isEmpty:J}),z(T.NumberInput,{name:"numberInput",previewRender:K,fallbackValue:null,isEmpty:G}),z(T.Range,{name:"range",previewRender:K,fallbackValue:0,isEmpty:G}),z(T.Select,{name:"select",previewRender:K,fallbackValue:null,isEmpty:G}),z(T.SingleSelect,{name:"singleSelect",previewRender:K,fallbackValue:null,isEmpty:J}),z(T.MultiSelect,{name:"multiSelect",previewRender:K,fallbackValue:[],isEmpty:U}),z(T.TreeSelect,{name:"treeSelect",previewRender:K,fallbackValue:null,isEmpty:U}),z(T.SingleTreeSelect,{name:"singleTreeSelect",previewRender:K,fallbackValue:null,isEmpty:J}),z(T.MultiTreeSelect,{name:"multiTreeSelect",previewRender:K,fallbackValue:[],isEmpty:U}),z((function(e){var n=e.items,t=e.value,a=e.onChange,r=Y(e,["items","value","onChange"]);return l.a.createElement("div",Object.assign({style:{display:"flex",gap:8}},r),n.map((function(e){return l.a.createElement(T.Button,{key:e,type:e===t?"primary":"normal",onClick:function(){return a(e)}},e)})))}),{name:"testButtonGroup",fallbackValue:"",previewRender:K,isEmpty:J});try{X.displayName="FormItem",X.__docgenInfo={description:"",displayName:"FormItem",props:{component:{defaultValue:null,description:"",name:"component",required:!0,type:{name:'"radioGroup" | "input" | "select" | "textarea" | "switch" | "singleSelect" | "multiSelect" | "treeSelect" | "checkboxGroup" | "datePicker" | "dateRangePicker" | "timePicker" | ... 6 more ... | "testButtonGroup"'}},componentProps:{defaultValue:null,description:"",name:"componentProps",required:!1,type:{name:"TimePickerProps | TextareaProps | RangeProps | SelectProps | MultiSelectProps | SwitchProps | ... 10 more ... | HTMLProps<...>"}},defaultValue:{defaultValue:null,description:"",name:"defaultValue",required:!1,type:{name:"any"}},name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"string"}},label:{defaultValue:null,description:"",name:"label",required:!1,type:{name:"ReactNode"}},validate:{defaultValue:null,description:"",name:"validate",required:!1,type:{name:"(value: any) => any"}},required:{defaultValue:null,description:"",name:"required",required:!1,type:{name:"boolean"}},isEmpty:{defaultValue:null,description:"",name:"isEmpty",required:!1,type:{name:"(value: any) => boolean"}},dataSource:{defaultValue:null,description:"",name:"dataSource",required:!1,type:{name:"ListNode<string>[] | (string | SelectItem)[] | ListNode<StringOrNumber>[] | TreeSelectItem[]"}},items:{defaultValue:null,description:"",name:"items",required:!0,type:{name:"string[]"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/form-item.tsx#FormItem"]={docgenInfo:X.__docgenInfo,name:"FormItem",path:"../xform/src/form-item.tsx#FormItem"})}catch(Q){}var W=function(e){for(var n=[],t=0;t<e;t++)n.push(t);return n},H=function(e){var n=void 0===e?{}:e,t=n.title,r=n.showItemCount,o=n.showItemOrder,i=n.style,s={position:"absolute",top:8,right:8,display:"flex",gap:8,zIndex:20};return function(e){var n=e.arrayModel,c=e.itemContent,u=e.itemCount,m=e.itemFactory;return l.a.createElement("div",{className:"xform-array",style:Object.assign({marginTop:16,marginBottom:8},i)},(t||r)&&l.a.createElement("h2",null,null!=t?t:"\u5217\u8868"," ",r&&"("+u+")"),0===u&&l.a.createElement("div",{style:{border:"1px dashed #aaa",marginTop:16,padding:8,position:"relative",fontSize:20}},"\u7a7a\u7a7a\u5982\u4e5f~~"),l.a.createElement("div",{className:"xform-array-items"},W(u).map((function(t){return l.a.createElement("div",{key:f.getKey(n,t),className:"xform-array-item",style:{border:"1px dashed #aaa",marginTop:16,padding:8,position:"relative"}},o&&l.a.createElement("code",{style:{fontSize:16}},n.path.join("."),"#",t),l.a.createElement(Z,Object.assign({},e,{itemIndex:t,style:s})),f.renderArrayItem(n,t,c))}))),l.a.createElement("div",{style:{marginTop:12}},l.a.createElement(T.Button,{onClick:Object(a.action)((function(){f.append(n,m)}))},"\u6dfb\u52a0\u4e00\u9879")))}},Z=Object(r.a)((function(e){var n=e.arrayModel,t=e.itemCount,r=e.itemIndex,o=e.style;return l.a.createElement("div",{style:o},l.a.createElement(T.Button,{size:"small",onClick:Object(a.action)((function(){f.delete(n,r)}))},"\u5220\u9664"),l.a.createElement(T.Button,{size:"small",disabled:0===r,onClick:Object(a.action)((function(){f.moveUp(n,r)}))},"\u4e0a\u79fb"),l.a.createElement(T.Button,{size:"small",disabled:r===t-1,onClick:Object(a.action)((function(){f.moveDown(n,r)}))},"\u4e0b\u79fb"))})),$=function(e){var n=void 0===e?{}:e,t=n.defaultColumnWidth,a=n.orderColumn,r=n.operationColumn,o=n.className,i=n.style,s={display:"flex",gap:0};return function(e){var n=e.arrayModel,c=e.itemContent,u=e.itemCount,m=e.itemFactory,d=l.a.Children.toArray(c).filter((function(e){return e.type===X})).map((function(e){return Object.assign(Object.assign({name:"string"==typeof e.props.label?e.props.label:null,title:e.props.label},e.props["x-table-column"]),{render:function(n,t){return l.a.createElement(C,{name:String(t.itemIndex)},l.a.cloneElement(e,{label:null,isInline:!0}))}})}));return null!=a&&d.unshift(Object.assign(Object.assign({name:"#"},a),{getValue:function(e){return e.itemIndex+1}})),null!=r&&d.push(Object.assign(Object.assign({name:""},r),{render:function(n,t){return l.a.createElement(Z,Object.assign({},e,{itemIndex:t.itemIndex,style:s}))}})),l.a.createElement("div",{style:i,className:o},l.a.createElement(T.BaseTable,{className:"bordered",primaryKey:"rowKey",defaultColumnWidth:t,dataSource:W(u).map((function(e){return{rowKey:f.getKey(n,e),itemIndex:e}})),columns:d}),l.a.createElement("div",{style:{padding:4,height:48,display:"flex",alignItems:"center",justifyContent:"center",background:"#f5f5f5"}},l.a.createElement(T.Button,{type:"primary",onClick:function(){f.append(n,m)}},"\u6dfb\u52a0\u4e00\u884c")))}};try{H.displayName="arrayCard",H.__docgenInfo={description:"",displayName:"arrayCard",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/array-layouts.tsx#arrayCard"]={docgenInfo:H.__docgenInfo,name:"arrayCard",path:"../xform/src/array-layouts.tsx#arrayCard"})}catch(Q){}try{$.displayName="arrayTable",$.__docgenInfo={description:"",displayName:"arrayTable",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/array-layouts.tsx#arrayTable"]={docgenInfo:$.__docgenInfo,name:"arrayTable",path:"../xform/src/array-layouts.tsx#arrayTable"})}catch(Q){}},312:function(e,n,t){"use strict";t.d(n,"a",(function(){return v}));var a=t(173),r=t(4),o=t(314),l=t(3),i=t(162),s=t(207),c=t(168),u=t(182),m=t(0),d=t.n(m);function p(e){var n=e.children,t=e.fallback;return"undefined"==typeof document||null==n?null!=t?t:null:d.a.createElement(d.a.Fragment,null,n())}var b={filename:"/Users/feichao.sfc/code/github/alibaba/rex-design/packages/story/src/xform/helpers.tsx",loc:{start:{line:9,column:0},end:{line:21,column:1}},name:"BrowserOnly",value:p,source:" function _nullishCoalesce(lhs, rhsFn) { if (lhs != null) { return lhs; } else { return rhsFn(); } }function BrowserOnly({\n  children,\n  fallback,\n}\n\n\n) {\n  if (typeof document === 'undefined' || children == null) {\n    return _nullishCoalesce(fallback, () => ( null));\n  }\n\n  return <>{children()}</>;\n}",deps:function(){return[]},provides:{React:d.a}},f=function(e){return d.a.createElement(p,null,(function(){var n=t(373).default;return d.a.createElement(n,Object(l.a)({style:Object.assign({marginTop:8,fontSize:12},e.style)},e))}))},y={filename:"/Users/feichao.sfc/code/github/alibaba/rex-design/packages/story/src/xform/helpers.tsx",loc:{start:{line:23,column:7},end:{line:32,column:2}},name:"BrowserOnlyReactJson",value:f,source:"const BrowserOnlyReactJson = (props) => {\n  return (\n    <BrowserOnly>\n      {() => {\n        const ReactJson = require('react-json-view').default;\n        return <ReactJson style={{ marginTop: 8, fontSize: 12, ...props.style }} {...props} />;\n      }}\n    </BrowserOnly>\n  );\n};",deps:function(){return[b]},provides:{}};f.__doc_info=y,f.__inner_source="(props) => {\n  return (\n    <BrowserOnly>\n      {() => {\n        const ReactJson = require('react-json-view').default;\n        return <ReactJson style={{ marginTop: 8, fontSize: 12, ...props.style }} {...props} />;\n      }}\n    </BrowserOnly>\n  );\n}";var v=Object(u.a)((function(e){var n,t=e.style,a=e.defaultShow,r=Object(s.h)(),o=Object(c.toJS)(r.values),l=null!==(n=r.state.showReactJson)&&void 0!==n?n:a;return d.a.createElement("div",{style:Object.assign({marginTop:16},t)},d.a.createElement("div",{style:{marginTop:8,display:"flex",alignItems:"center",gap:8}},d.a.createElement(i.Switch,{value:l,onChange:Object(c.action)((function(e){r.state.showReactJson=e}))}),d.a.createElement("span",{style:{fontSize:12}},"\u663e\u793a JSON")),l&&d.a.createElement(f,{name:"\u8868\u5355\u72b6\u6001\u9884\u89c8",src:o}))})),h=(u.a,d.a,s.h,c.toJS,i.Switch,c.action,Object(u.a)((function(e){var n=e.label,t=e.printAll,a=Object(s.h)();return Object(m.useEffect)((function(){return Object(c.autorun)((function(){console.log("[ValuePrinter] "+(null!=n?n:"")+"\n",t?Object.assign({},a,{values:Object(c.toJS)(a.values)}):Object(c.toJS)(a.values))}))}),[n,a,t]),null}))),O=(u.a,s.h,m.useEffect,c.autorun,c.toJS,Object(u.a)((function(){var e=Object(s.h)().root;return d.a.createElement("div",{style:{display:"flex",gap:8}},d.a.createElement(i.Button,{onClick:function(){return s.g.validateAll(e)}},"\u6821\u9a8c\u5168\u90e8"),d.a.createElement(i.Button,{onClick:function(){return s.g.clearError(e)}},"\u6e05\u7a7a\u9519\u8bef"),d.a.createElement(i.Button,{onClick:Object(c.action)((function(){e.values={opCount:0,sku:{code:"test"}},s.g.clearError(e)}))},"\u91cd\u7f6e\u8868\u5355"))})),u.a,s.h,i.Button,s.g,c.action,Object(u.a)((function(){var e=Object(s.h)();return Object(m.useEffect)((function(){return window.model=e,window.toJS=c.toJS,window.mobx=c,function(){delete window.model,delete window.toJS,delete window.mobx}}),[e]),d.a.createElement(d.a.Fragment,null)})),u.a,s.h,m.useEffect,c.toJS,function(e){function n(){return e.apply(this,arguments)||this}return Object(r.a)(n,e),n}(Object(o.a)(Error))),g={filename:"/Users/feichao.sfc/code/github/alibaba/rex-design/packages/story/src/xform/helpers.tsx",loc:{start:null,end:null},name:"AsyncLoadingError",value:O,source:" function _nullishCoalesce(lhs, rhsFn) { if (lhs != null) { return lhs; } else { return rhsFn(); } } function _optionalChain(ops) { let lastAccessLHS = undefined; let value = ops[0]; let i = 1; while (i < ops.length) { const op = ops[i]; const fn = ops[i + 1]; i += 2; if ((op === 'optionalAccess' || op === 'optionalCall') && value == null) { return undefined; } if (op === 'access' || op === 'optionalAccess') { lastAccessLHS = value; value = fn(value); } else if (op === 'call' || op === 'optionalCall') { value = fn((...args) => value.call(lastAccessLHS, ...args)); lastAccessLHS = undefined; } } return value; }import { Button, Switch } from '@rexd/core';\nimport { modelUtils, useModel } from '@rexd/xform';\nimport * as mobx from 'mobx';\nimport { action, autorun, computed, toJS } from 'mobx';\nimport { observer } from 'mobx-react-lite';\nimport React, { useEffect } from 'react';\n\n\nfunction BrowserOnly({\n  children,\n  fallback,\n}\n\n\n) {\n  if (typeof document === 'undefined' || children == null) {\n    return _nullishCoalesce(fallback, () => ( null));\n  }\n\n  return <>{children()}</>;\n}\n\nexport const BrowserOnlyReactJson = (props) => {\n  return (\n    <BrowserOnly>\n      {() => {\n        const ReactJson = require('react-json-view').default;\n        return <ReactJson style={{ marginTop: 8, fontSize: 12, ...props.style }} {...props} />;\n      }}\n    </BrowserOnly>\n  );\n};\n\n// https://github.com/mac-s-g/react-json-view/issues/121#issuecomment-670431408\n\nexport const ValuePreview = observer(\n  ({ style, defaultShow }) => {\n    const model = useModel();\n    const data = toJS(model.values) ;\n    const showReactJson = _nullishCoalesce(model.state.showReactJson, () => ( defaultShow));\n\n    return (\n      <div style={{ marginTop: 16, ...style }}>\n        <div style={{ marginTop: 8, display: 'flex', alignItems: 'center', gap: 8 }}>\n          <Switch\n            value={showReactJson}\n            onChange={action((b) => {\n              model.state.showReactJson = b;\n            })}\n          />\n          <span style={{ fontSize: 12 }}>\u663e\u793a JSON</span>\n        </div>\n        {showReactJson && <BrowserOnlyReactJson name=\"\u8868\u5355\u72b6\u6001\u9884\u89c8\" src={data} />}\n      </div>\n    );\n  },\n);\n\nexport const ValuePrinter = observer(({ label, printAll }) => {\n  const model = useModel();\n\n  useEffect(() => {\n    return autorun(() => {\n      console.log(\n        `[ValuePrinter] ${_nullishCoalesce(label, () => ( ''))}\\n`,\n        printAll ? { ...model, values: toJS(model.values) } : toJS(model.values),\n      );\n    });\n  }, [label, model, printAll]);\n\n  return null;\n});\n\nexport const Actions = observer(() => {\n  const model = useModel().root;\n\n  return (\n    <div style={{ display: 'flex', gap: 8 }}>\n      <Button onClick={() => modelUtils.validateAll(model)}>\u6821\u9a8c\u5168\u90e8</Button>\n      <Button onClick={() => modelUtils.clearError(model)}>\u6e05\u7a7a\u9519\u8bef</Button>\n      <Button\n        onClick={action(() => {\n          model.values = {\n            opCount: 0,\n            sku: { code: 'test' },\n          };\n          modelUtils.clearError(model);\n        })}\n      >\n        \u91cd\u7f6e\u8868\u5355\n      </Button>\n    </div>\n  );\n});\n\nexport const InjectModelToGlobal = observer(() => {\n  const model = useModel();\n\n  useEffect(() => {\n    // @ts-ignore\n    window.model = model;\n    // @ts-ignore\n    window.toJS = toJS;\n    // @ts-ignore\n    window.mobx = mobx;\n\n    return () => {\n      // @ts-ignore\n      delete window.model;\n      // @ts-ignore\n      delete window.toJS;\n      // @ts-ignore\n      delete window.mobx;\n    };\n  }, [model]);\n\n  return <></>;\n});\n\n\n\nclass AsyncLoadingError extends Error {}\n\n\n\n\n\n\n\n\nfunction getFromAsyncValue(x) {\n  if (x.status !== 'ready') {\n    throw new AsyncLoadingError();\n  }\n  return x.current;\n}\n\nexport function makeAsyncValue(getter, initValue) {\n  const atom = mobx.createAtom('atom@asyncSelect');\n  const disposers = [];\n\n  let status = 'loading';\n  let current = initValue;\n\n  const computedStatus = computed(() => {\n    atom.reportObserved();\n    return status;\n  });\n  const computedCurrent = computed(() => {\n    atom.reportObserved();\n    return current;\n  });\n\n  let reaction;\n  let cancelLastGetter;\n\n  const start = () => {\n    reaction = new mobx.Reaction('async', () => {\n      if (status !== 'loading') {\n        status = 'loading';\n        atom.reportChanged();\n      }\n\n      reaction.track(() => {\n        _optionalChain([cancelLastGetter, 'optionalCall', _ => _()]);\n\n        let cancelled = false;\n        cancelLastGetter = () => {\n          cancelled = true;\n        };\n\n        getter(getFromAsyncValue)\n          .then(\n            action((newValue) => {\n              if (cancelled) {\n                return;\n              }\n              status = 'ready';\n              current = newValue;\n              atom.reportChanged();\n\n              return newValue;\n            }),\n          )\n          .catch((e) => {\n            if (e instanceof AsyncLoadingError) {\n              // still loading, do nothing\n              return;\n            }\n            // TODO \u5904\u7406 error \u72b6\u6001\n            throw e;\n          });\n      });\n    });\n    reaction.schedule_();\n  };\n\n  const stop = () => {\n    if (reaction) {\n      reaction.dispose();\n      reaction = null;\n    }\n  };\n\n  disposers.push(mobx.onBecomeObserved(atom, start));\n  disposers.push(mobx.onBecomeUnobserved(atom, stop));\n  disposers.push(stop);\n\n  return {\n    get status() {\n      return computedStatus.get();\n    },\n    get current() {\n      return computedCurrent.get();\n    },\n    dispose() {\n      for (const fn of disposers) {\n        fn();\n      }\n    },\n    refresh() {\n      _optionalChain([reaction, 'optionalAccess', _2 => _2.onBecomeStale_, 'call', _3 => _3()]);\n    },\n  };\n}\n",deps:function(){return[]},provides:{}};function S(e){if("ready"!==e.status)throw new O;return e.current}var x={filename:"/Users/feichao.sfc/code/github/alibaba/rex-design/packages/story/src/xform/helpers.tsx",loc:{start:{line:131,column:0},end:{line:136,column:1}},name:"getFromAsyncValue",value:S,source:"function getFromAsyncValue(x) {\n  if (x.status !== 'ready') {\n    throw new AsyncLoadingError();\n  }\n  return x.current;\n}",deps:function(){return[g]},provides:{}};function j(e,n){var t,r,o=c.createAtom("atom@asyncSelect"),l=[],i="loading",s=n,u=Object(c.computed)((function(){return o.reportObserved(),i})),m=Object(c.computed)((function(){return o.reportObserved(),s})),d=function(){t&&(t.dispose(),t=null)};return l.push(c.onBecomeObserved(o,(function(){(t=new c.Reaction("async",(function(){"loading"!==i&&(i="loading",o.reportChanged()),t.track((function(){var n;null===(n=r)||void 0===n||n();var t=!1;r=function(){t=!0},e(S).then(Object(c.action)((function(e){if(!t)return i="ready",s=e,o.reportChanged(),e}))).catch((function(e){if(!(e instanceof O))throw e}))}))}))).schedule_()}))),l.push(c.onBecomeUnobserved(o,d)),l.push(d),{get status(){return u.get()},get current(){return m.get()},dispose:function(){for(var e,n=Object(a.a)(l);!(e=n()).done;){(0,e.value)()}},refresh:function(){var e;null===(e=t)||void 0===e||e.onBecomeStale_()}}}var E={filename:"/Users/feichao.sfc/code/github/alibaba/rex-design/packages/story/src/xform/helpers.tsx",loc:{start:{line:138,column:7},end:{line:225,column:1}},name:"makeAsyncValue",value:j,source:" function _optionalChain(ops) { let lastAccessLHS = undefined; let value = ops[0]; let i = 1; while (i < ops.length) { const op = ops[i]; const fn = ops[i + 1]; i += 2; if ((op === 'optionalAccess' || op === 'optionalCall') && value == null) { return undefined; } if (op === 'access' || op === 'optionalAccess') { lastAccessLHS = value; value = fn(value); } else if (op === 'call' || op === 'optionalCall') { value = fn((...args) => value.call(lastAccessLHS, ...args)); lastAccessLHS = undefined; } } return value; }function makeAsyncValue(getter, initValue) {\n  const atom = mobx.createAtom('atom@asyncSelect');\n  const disposers = [];\n\n  let status = 'loading';\n  let current = initValue;\n\n  const computedStatus = computed(() => {\n    atom.reportObserved();\n    return status;\n  });\n  const computedCurrent = computed(() => {\n    atom.reportObserved();\n    return current;\n  });\n\n  let reaction;\n  let cancelLastGetter;\n\n  const start = () => {\n    reaction = new mobx.Reaction('async', () => {\n      if (status !== 'loading') {\n        status = 'loading';\n        atom.reportChanged();\n      }\n\n      reaction.track(() => {\n        _optionalChain([cancelLastGetter, 'optionalCall', _ => _()]);\n\n        let cancelled = false;\n        cancelLastGetter = () => {\n          cancelled = true;\n        };\n\n        getter(getFromAsyncValue)\n          .then(\n            action((newValue) => {\n              if (cancelled) {\n                return;\n              }\n              status = 'ready';\n              current = newValue;\n              atom.reportChanged();\n\n              return newValue;\n            }),\n          )\n          .catch((e) => {\n            if (e instanceof AsyncLoadingError) {\n              // still loading, do nothing\n              return;\n            }\n            // TODO \u5904\u7406 error \u72b6\u6001\n            throw e;\n          });\n      });\n    });\n    reaction.schedule_();\n  };\n\n  const stop = () => {\n    if (reaction) {\n      reaction.dispose();\n      reaction = null;\n    }\n  };\n\n  disposers.push(mobx.onBecomeObserved(atom, start));\n  disposers.push(mobx.onBecomeUnobserved(atom, stop));\n  disposers.push(stop);\n\n  return {\n    get status() {\n      return computedStatus.get();\n    },\n    get current() {\n      return computedCurrent.get();\n    },\n    dispose() {\n      for (const fn of disposers) {\n        fn();\n      }\n    },\n    refresh() {\n      _optionalChain([reaction, 'optionalAccess', _2 => _2.onBecomeStale_, 'call', _3 => _3()]);\n    },\n  };\n}",deps:function(){return[x,g]},provides:{mobx:c,computed:c.computed,action:c.action}};j.__inner_source=" function _optionalChain(ops) { let lastAccessLHS = undefined; let value = ops[0]; let i = 1; while (i < ops.length) { const op = ops[i]; const fn = ops[i + 1]; i += 2; if ((op === 'optionalAccess' || op === 'optionalCall') && value == null) { return undefined; } if (op === 'access' || op === 'optionalAccess') { lastAccessLHS = value; value = fn(value); } else if (op === 'call' || op === 'optionalCall') { value = fn((...args) => value.call(lastAccessLHS, ...args)); lastAccessLHS = undefined; } } return value; }function makeAsyncValue(getter, initValue) {\n  const atom = mobx.createAtom('atom@asyncSelect');\n  const disposers = [];\n\n  let status = 'loading';\n  let current = initValue;\n\n  const computedStatus = computed(() => {\n    atom.reportObserved();\n    return status;\n  });\n  const computedCurrent = computed(() => {\n    atom.reportObserved();\n    return current;\n  });\n\n  let reaction;\n  let cancelLastGetter;\n\n  const start = () => {\n    reaction = new mobx.Reaction('async', () => {\n      if (status !== 'loading') {\n        status = 'loading';\n        atom.reportChanged();\n      }\n\n      reaction.track(() => {\n        _optionalChain([cancelLastGetter, 'optionalCall', _ => _()]);\n\n        let cancelled = false;\n        cancelLastGetter = () => {\n          cancelled = true;\n        };\n\n        getter(getFromAsyncValue)\n          .then(\n            action((newValue) => {\n              if (cancelled) {\n                return;\n              }\n              status = 'ready';\n              current = newValue;\n              atom.reportChanged();\n\n              return newValue;\n            }),\n          )\n          .catch((e) => {\n            if (e instanceof AsyncLoadingError) {\n              // still loading, do nothing\n              return;\n            }\n            // TODO \u5904\u7406 error \u72b6\u6001\n            throw e;\n          });\n      });\n    });\n    reaction.schedule_();\n  };\n\n  const stop = () => {\n    if (reaction) {\n      reaction.dispose();\n      reaction = null;\n    }\n  };\n\n  disposers.push(mobx.onBecomeObserved(atom, start));\n  disposers.push(mobx.onBecomeUnobserved(atom, stop));\n  disposers.push(stop);\n\n  return {\n    get status() {\n      return computedStatus.get();\n    },\n    get current() {\n      return computedCurrent.get();\n    },\n    dispose() {\n      for (const fn of disposers) {\n        fn();\n      }\n    },\n    refresh() {\n      _optionalChain([reaction, 'optionalAccess', _2 => _2.onBecomeStale_, 'call', _3 => _3()]);\n    },\n  };\n}",j.__doc_info=E;try{f.displayName="BrowserOnlyReactJson",f.__docgenInfo={description:"",displayName:"BrowserOnlyReactJson",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../story/src/xform/helpers.tsx#BrowserOnlyReactJson"]={docgenInfo:f.__docgenInfo,name:"BrowserOnlyReactJson",path:"../story/src/xform/helpers.tsx#BrowserOnlyReactJson"})}catch(_){}try{v.displayName="ValuePreview",v.__docgenInfo={description:"",displayName:"ValuePreview",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../story/src/xform/helpers.tsx#ValuePreview"]={docgenInfo:v.__docgenInfo,name:"ValuePreview",path:"../story/src/xform/helpers.tsx#ValuePreview"})}catch(_){}try{h.displayName="ValuePrinter",h.__docgenInfo={description:"",displayName:"ValuePrinter",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../story/src/xform/helpers.tsx#ValuePrinter"]={docgenInfo:h.__docgenInfo,name:"ValuePrinter",path:"../story/src/xform/helpers.tsx#ValuePrinter"})}catch(_){}}}]);
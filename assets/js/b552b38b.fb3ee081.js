(window.webpackJsonp=window.webpackJsonp||[]).push([[57],{145:function(e,n,t){"use strict";t.r(n),t.d(n,"frontMatter",(function(){return _})),t.d(n,"metadata",(function(){return E})),t.d(n,"toc",(function(){return x})),t.d(n,"default",(function(){return A}));var r=t(3),a=t(7),o=t(0),l=t.n(o),s=t(164),i=t(205),c=t(180),u=t(309);function m(){const e=Object(i.f)({defaultColumnWidth:180,operationColumn:{lock:!0},orderColumn:{width:50,lock:!0}});return l.a.createElement(i.a,{defaultValue:{array:[{},{}]}},l.a.createElement(i.a.Array,{name:"array",layout:e},l.a.createElement(i.c,{component:"input",name:"aa",label:"\u5b57\u6bb51",required:!0}),l.a.createElement(i.c,{component:"input",name:"bb",label:"\u5b57\u6bb52"}),l.a.createElement(i.c,{component:"input",name:"cc",label:"\u5b57\u6bb53"}),l.a.createElement(i.c,{component:"dateRangePicker",name:"dd",label:"\u5b57\u6bb54",required:!0,"x-table-column":{width:240}})),l.a.createElement(i.a.ModelConsumer,null,e=>e.getValue("array",[]).length>3&&l.a.createElement("div",{style:{color:"var(--rex-colors-red-50)",marginTop:4}},"\u8868\u683c\u5185\u7684\u6761\u76ee\u6570\u91cf\u4e0d\u80fd\u5927\u4e8e3")),l.a.createElement(u.a,null))}const d={filename:"/Users/feichao.sfc/code/github/alibaba/rex-design/packages/story/src/xform/3-biz-examples.stories.tsx",loc:{start:{line:9,column:7},end:{line:36,column:1}},name:"TableLayout",value:m,source:'function TableLayout() {\n  const layout = arrayTable({\n    defaultColumnWidth: 180,\n    operationColumn: { lock: true },\n    orderColumn: { width: 50, lock: true },\n  });\n\n  return (\n    <Form defaultValue={{ array: [{}, {}] }}>\n      <Form.Array name="array" layout={layout}>\n        <FormItem component="input" name="aa" label="\u5b57\u6bb51" required />\n        <FormItem component="input" name="bb" label="\u5b57\u6bb52" />\n        <FormItem component="input" name="cc" label="\u5b57\u6bb53" />\n        <FormItem component="dateRangePicker" name="dd" label="\u5b57\u6bb54" required x-table-column={{ width: 240 }} />\n      </Form.Array>\n\n      <Form.ModelConsumer>\n        {(mod) =>\n          mod.getValue(\'array\', []).length > 3 && (\n            <div style={{ color: \'var(--rex-colors-red-50)\', marginTop: 4 }}>\u8868\u683c\u5185\u7684\u6761\u76ee\u6570\u91cf\u4e0d\u80fd\u5927\u4e8e3</div>\n          )\n        }\n      </Form.ModelConsumer>\n\n      <ValuePreview />\n    </Form>\n  );\n}',deps:()=>[],provides:{arrayTable:i.f,Form:i.a,FormItem:i.c,ValuePreview:u.a}};function p(){return l.a.createElement(i.a,{defaultValue:{array:[{show:!0},{show:!1}]},labelPosition:"left"},l.a.createElement(i.a.Array,{name:"array",layout:Object(i.e)({showItemOrder:!0}),itemFactory:e=>({show:e.values.length%2==0})},l.a.createElement(i.c,{component:"switch",name:"show",label:"\u662f\u5426\u663e\u793a \u8f93\u5165\u6846",defaultValue:!1}),l.a.createElement(i.a.ModelConsumer,null,e=>e.getValue("show")&&l.a.createElement(i.c,{component:"input",name:"input",label:"\u8f93\u5165\u6846",required:!0}))))}m.__doc_info=d,m.__inner_source='function TableLayout() {\n  const layout = arrayTable({\n    defaultColumnWidth: 180,\n    operationColumn: { lock: true },\n    orderColumn: { width: 50, lock: true },\n  });\n\n  return (\n    <Form defaultValue={{ array: [{}, {}] }}>\n      <Form.Array name="array" layout={layout}>\n        <FormItem component="input" name="aa" label="\u5b57\u6bb51" required />\n        <FormItem component="input" name="bb" label="\u5b57\u6bb52" />\n        <FormItem component="input" name="cc" label="\u5b57\u6bb53" />\n        <FormItem component="dateRangePicker" name="dd" label="\u5b57\u6bb54" required x-table-column={{ width: 240 }} />\n      </Form.Array>\n\n      <Form.ModelConsumer>\n        {(mod) =>\n          mod.getValue(\'array\', []).length > 3 && (\n            <div style={{ color: \'var(--rex-colors-red-50)\', marginTop: 4 }}>\u8868\u683c\u5185\u7684\u6761\u76ee\u6570\u91cf\u4e0d\u80fd\u5927\u4e8e3</div>\n          )\n        }\n      </Form.ModelConsumer>\n\n      <ValuePreview />\n    </Form>\n  );\n}';const f={filename:"/Users/feichao.sfc/code/github/alibaba/rex-design/packages/story/src/xform/3-biz-examples.stories.tsx",loc:{start:{line:39,column:7},end:{line:56,column:1}},name:"VisibilityControlInArrayItem",value:p,source:'function VisibilityControlInArrayItem() {\n  return (\n    <Form defaultValue={{ array: [{ show: true }, { show: false }] }} labelPosition="left">\n      <Form.Array\n        name="array"\n        layout={arrayCard({ showItemOrder: true })}\n        itemFactory={(arrayModel) => {\n          return { show: arrayModel.values.length % 2 === 0 };\n        }}\n      >\n        <FormItem component="switch" name="show" label="\u662f\u5426\u663e\u793a \u8f93\u5165\u6846" defaultValue={false} />\n        <Form.ModelConsumer>\n          {(mod) => mod.getValue(\'show\') && <FormItem component="input" name="input" label="\u8f93\u5165\u6846" required />}\n        </Form.ModelConsumer>\n      </Form.Array>\n    </Form>\n  );\n}',deps:()=>[],provides:{Form:i.a,arrayCard:i.e,FormItem:i.c}};function y(){return l.a.createElement(i.a,null,l.a.createElement(i.a.Effect,{watch:"person.effects.aaa",effect:(e,{model:n})=>{"123"===e?n.setValue("ddd","this is linkage relationship"):""===e&&n.setValue("ddd","")}}),l.a.createElement("p",null,"\u5185\u90e8\u8ba2\u9605, \u76d1\u542c person.effects.aaa \u503c\u6539\u53d8\uff0c\u5f53\u53d8\u4e3a 123 \u65f6\uff0cddd \u7684\u503c\u88ab\u8bbe\u7f6e\uff1b\u5f53 aaa \u53d8\u4e3a\u7a7a\u65f6\uff0cddd \u4e5f\u88ab\u6e05\u7a7a"),l.a.createElement(i.a.Object,{name:"person.effects"},l.a.createElement(i.c,{component:"input",name:"aaa",label:"person.effects.aaa"}),l.a.createElement(i.c,{component:"input",name:"bbb",label:"person.effects.bbb"})),l.a.createElement(i.c,{component:"input",name:"ccc",label:"ccc"}),l.a.createElement(i.c,{component:"input",name:"ddd",label:"ddd"}),l.a.createElement(u.a,null))}p.__doc_info=f,p.__inner_source='function VisibilityControlInArrayItem() {\n  return (\n    <Form defaultValue={{ array: [{ show: true }, { show: false }] }} labelPosition="left">\n      <Form.Array\n        name="array"\n        layout={arrayCard({ showItemOrder: true })}\n        itemFactory={(arrayModel) => {\n          return { show: arrayModel.values.length % 2 === 0 };\n        }}\n      >\n        <FormItem component="switch" name="show" label="\u662f\u5426\u663e\u793a \u8f93\u5165\u6846" defaultValue={false} />\n        <Form.ModelConsumer>\n          {(mod) => mod.getValue(\'show\') && <FormItem component="input" name="input" label="\u8f93\u5165\u6846" required />}\n        </Form.ModelConsumer>\n      </Form.Array>\n    </Form>\n  );\n}';const b={filename:"/Users/feichao.sfc/code/github/alibaba/rex-design/packages/story/src/xform/3-biz-examples.stories.tsx",loc:{start:{line:59,column:7},end:{line:85,column:1}},name:"DeclarativeEffect",value:y,source:'function DeclarativeEffect() {\n  return (\n    <Form>\n      <Form.Effect\n        watch="person.effects.aaa"\n        effect={(value, { model }) => {\n          if (value === \'123\') {\n            model.setValue(\'ddd\', \'this is linkage relationship\');\n          } else if (value === \'\') {\n            model.setValue(\'ddd\', \'\');\n          }\n        }}\n      />\n\n      <p>\u5185\u90e8\u8ba2\u9605, \u76d1\u542c person.effects.aaa \u503c\u6539\u53d8\uff0c\u5f53\u53d8\u4e3a 123 \u65f6\uff0cddd \u7684\u503c\u88ab\u8bbe\u7f6e\uff1b\u5f53 aaa \u53d8\u4e3a\u7a7a\u65f6\uff0cddd \u4e5f\u88ab\u6e05\u7a7a</p>\n\n      <Form.Object name="person.effects">\n        <FormItem component="input" name="aaa" label="person.effects.aaa" />\n        <FormItem component="input" name="bbb" label="person.effects.bbb" />\n      </Form.Object>\n      <FormItem component="input" name="ccc" label="ccc" />\n      <FormItem component="input" name="ddd" label="ddd" />\n\n      <ValuePreview />\n    </Form>\n  );\n}',deps:()=>[],provides:{Form:i.a,FormItem:i.c,ValuePreview:u.a}};y.__doc_info=b,y.__inner_source='function DeclarativeEffect() {\n  return (\n    <Form>\n      <Form.Effect\n        watch="person.effects.aaa"\n        effect={(value, { model }) => {\n          if (value === \'123\') {\n            model.setValue(\'ddd\', \'this is linkage relationship\');\n          } else if (value === \'\') {\n            model.setValue(\'ddd\', \'\');\n          }\n        }}\n      />\n\n      <p>\u5185\u90e8\u8ba2\u9605, \u76d1\u542c person.effects.aaa \u503c\u6539\u53d8\uff0c\u5f53\u53d8\u4e3a 123 \u65f6\uff0cddd \u7684\u503c\u88ab\u8bbe\u7f6e\uff1b\u5f53 aaa \u53d8\u4e3a\u7a7a\u65f6\uff0cddd \u4e5f\u88ab\u6e05\u7a7a</p>\n\n      <Form.Object name="person.effects">\n        <FormItem component="input" name="aaa" label="person.effects.aaa" />\n        <FormItem component="input" name="bbb" label="person.effects.bbb" />\n      </Form.Object>\n      <FormItem component="input" name="ccc" label="ccc" />\n      <FormItem component="input" name="ddd" label="ddd" />\n\n      <ValuePreview />\n    </Form>\n  );\n}';const h=Object(c.a)(()=>{const e=Object(i.h)();return l.a.createElement(l.a.Fragment,null,l.a.createElement(i.c,{component:"switch",name:"preview",label:"\u5f00\u542f\u9884\u89c8"}),l.a.createElement(i.b,{isPreview:e.getValue("preview")},l.a.createElement(i.c,{component:"input",name:"username",label:"\u7528\u6237\u540d"}),l.a.createElement(i.c,{component:"numberInput",name:"age",label:"\u5e74\u9f84",defaultValue:18})))}),g={filename:"/Users/feichao.sfc/code/github/alibaba/rex-design/packages/story/src/xform/3-biz-examples.stories.tsx",loc:{start:{line:87,column:0},end:{line:99,column:3}},name:"SubGroup",value:h,source:'const SubGroup = observer(() => {\n  const model = useModel();\n\n  return (\n    <>\n      <FormItem component="switch" name="preview" label="\u5f00\u542f\u9884\u89c8" />\n      <FormEnvProvider isPreview={model.getValue(\'preview\')}>\n        <FormItem component="input" name="username" label="\u7528\u6237\u540d" />\n        <FormItem component="numberInput" name="age" label="\u5e74\u9f84" defaultValue={18} />\n      </FormEnvProvider>\n    </>\n  );\n});',deps:()=>[],provides:{observer:c.a,useModel:i.h,FormItem:i.c,FormEnvProvider:i.b}};function v(){return l.a.createElement(i.a,{style:{fontSize:12},defaultValue:{primary:{},users:[{},{username:"My Name",preview:!0}]},labelPosition:"left"},l.a.createElement(i.a.Object,{name:"primary"},l.a.createElement(h,null)),l.a.createElement(i.a.Array,{name:"users",layout:Object(i.e)({showItemOrder:!0})},l.a.createElement(h,null)),l.a.createElement(u.a,null))}const S={filename:"/Users/feichao.sfc/code/github/alibaba/rex-design/packages/story/src/xform/3-biz-examples.stories.tsx",loc:{start:{line:101,column:7},end:{line:119,column:1}},name:"LogicsWithinArrayItem",value:v,source:'function LogicsWithinArrayItem() {\n  return (\n    <Form\n      style={{ fontSize: 12 }}\n      defaultValue={{ primary: {}, users: [{}, { username: \'My Name\', preview: true }] }}\n      labelPosition="left"\n    >\n      <Form.Object name="primary">\n        <SubGroup />\n      </Form.Object>\n\n      <Form.Array name="users" layout={arrayCard({ showItemOrder: true })}>\n        <SubGroup />\n      </Form.Array>\n\n      <ValuePreview />\n    </Form>\n  );\n}',deps:()=>[g],provides:{Form:i.a,arrayCard:i.e,ValuePreview:u.a}};v.__inner_source='function LogicsWithinArrayItem() {\n  return (\n    <Form\n      style={{ fontSize: 12 }}\n      defaultValue={{ primary: {}, users: [{}, { username: \'My Name\', preview: true }] }}\n      labelPosition="left"\n    >\n      <Form.Object name="primary">\n        <SubGroup />\n      </Form.Object>\n\n      <Form.Array name="users" layout={arrayCard({ showItemOrder: true })}>\n        <SubGroup />\n      </Form.Array>\n\n      <ValuePreview />\n    </Form>\n  );\n}',v.__doc_info=S;var O,_={id:"biz",title:"xform \u4e1a\u52a1\u793a\u4f8b"},E={unversionedId:"xform/biz",id:"xform/biz",isDocsHomePage:!1,title:"xform \u4e1a\u52a1\u793a\u4f8b",description:"\u4e1a\u52a1\u8868\u5355\u793a\u4f8b\u3002",source:"@site/docs/xform/biz.mdx",sourceDirName:"xform",slug:"/xform/biz",permalink:"/rex-design/docs/xform/biz",editUrl:"https://github.com/alibaba/rex-design/edit/main/packages/doc/docs/xform/biz.mdx",version:"current",frontMatter:{id:"biz",title:"xform \u4e1a\u52a1\u793a\u4f8b"},sidebar:"docs",previous:{title:"xform \u8fdb\u9636",permalink:"/rex-design/docs/xform/advanced"},next:{title:"xform core",permalink:"/rex-design/docs/xform/core"}},x=[{value:"\u8868\u683c\u5e03\u5c40",id:"\u8868\u683c\u5e03\u5c40",children:[]},{value:"\u6570\u7ec4\u5143\u7d20\u5185\u90e8\u8054\u52a8",id:"\u6570\u7ec4\u5143\u7d20\u5185\u90e8\u8054\u52a8",children:[]},{value:"\u6570\u7ec4\u5143\u7d20\u5185\u7684\u8054\u52a8 2",id:"\u6570\u7ec4\u5143\u7d20\u5185\u7684\u8054\u52a8-2",children:[]}],F=(O="Story",function(e){return console.warn("Component "+O+" was not imported, exported, or provided by MDXProvider as global scope"),Object(s.b)("div",e)}),C={toc:x};function A(e){var n=e.components,t=Object(a.a)(e,["components"]);return Object(s.b)("wrapper",Object(r.a)({},C,t,{components:n,mdxType:"MDXLayout"}),Object(s.b)("p",null,"\u4e1a\u52a1\u8868\u5355\u793a\u4f8b\u3002"),Object(s.b)("h2",{id:"\u8868\u683c\u5e03\u5c40"},"\u8868\u683c\u5e03\u5c40"),Object(s.b)(F,{fn:m,mdxType:"Story"}),Object(s.b)("h2",{id:"\u6570\u7ec4\u5143\u7d20\u5185\u90e8\u8054\u52a8"},"\u6570\u7ec4\u5143\u7d20\u5185\u90e8\u8054\u52a8"),Object(s.b)("p",null,"TODO \u793a\u4f8b\u8bf4\u660e"),Object(s.b)(F,{fn:p,mdxType:"Story"}),Object(s.b)("h2",{id:"\u6570\u7ec4\u5143\u7d20\u5185\u7684\u8054\u52a8-2"},"\u6570\u7ec4\u5143\u7d20\u5185\u7684\u8054\u52a8 2"),Object(s.b)("p",null,"TODO \u793a\u4f8b\u8bf4\u660e"),Object(s.b)(F,{fn:v,mdxType:"Story"}))}A.isMDXComponent=!0},205:function(e,n,t){"use strict";t.d(n,"h",(function(){return x})),t.d(n,"b",(function(){return _})),t.d(n,"d",(function(){return I})),t.d(n,"a",(function(){return B})),t.d(n,"c",(function(){return D})),t.d(n,"e",(function(){return W})),t.d(n,"f",(function(){return H})),t.d(n,"g",(function(){return M}));var r=t(167),a=t(180),o=t(0),l=t.n(o),s=t(215),i=t.n(s);function c(e){e.subModels.forEach((e,n)=>{e.name=String(n)})}function u(e,n,t){if(null==e)return;const r=e[n];e[n]=e[t],e[t]=r}function m(e){return String(Number.parseInt(e))===e}function d(e){return m(e)?"array":"object"}function p(e,n,t){const a=Array.isArray(n)?n:h(n);let o=e;for(let l=0;l<a.length;l+=1){if(!r.isObservable(o))return t;o=r.get(o,a[l])}return void 0===o?t:o}function f(e,n,t){const a=Array.isArray(n)?n:h(n),o=a.length-1;let l=e;for(let s=0;s<o;s+=1){const e=a[s];if(null==r.get(l,e)&&(m(a[s+1])?r.set(l,e,[]):r.set(l,e,{})),l=r.get(l,e),!r.isObservable(l))return}r.isObservable(l)&&r.set(l,a[o],t)}const y={append:Object(r.action)((e,n)=>{var t;null==e.values&&(e.values=[]),e.values.push(null!==(t=null==n?void 0:n(e))&&void 0!==t?t:{})}),delete:Object(r.action)((e,n)=>{e.values.splice(n,1),i()(Array.isArray(e._proxy.subModels),"arrayModel.subModels should be Array or observable.array"),e._proxy.subModels.splice(n,1),c(e._proxy)}),moveUp:Object(r.action)((e,n)=>{0!==n&&(u(e.values,n,n-1),i()(Array.isArray(e._proxy.subModels),"arrayModel.attachedSubModels should be Array or observable.array"),u(e._proxy.subModels,n,n-1),c(e._proxy))}),moveDown:Object(r.action)((e,n)=>{n!==e.values.length-1&&(u(e.values,n,n+1),i()(Array.isArray(e._proxy.subModels),"arrayModel.attachedSubModels should be Array or observable.array"),u(e._proxy.subModels,n,n+1),c(e._proxy))}),renderArrayItem:(e,n,t)=>l.a.createElement(C,{name:String(n)},t),getKey:(e,n)=>e.getSubModel(String(n)).id};function b(e,n){return void 0!==e?e:n}function h(e){return e.split(".")}try{d.displayName="keyToValueShape",d.__docgenInfo={description:"",displayName:"keyToValueShape",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/core/utils.tsx#keyToValueShape"]={docgenInfo:d.__docgenInfo,name:"keyToValueShape",path:"../xform/src/core/utils.tsx#keyToValueShape"})}catch(Q){}try{p.displayName="observableGetIn",p.__docgenInfo={description:"lodash.get(...) for mobx observables",displayName:"observableGetIn",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/core/utils.tsx#observableGetIn"]={docgenInfo:p.__docgenInfo,name:"observableGetIn",path:"../xform/src/core/utils.tsx#observableGetIn"})}catch(Q){}try{f.displayName="observableSetIn",f.__docgenInfo={description:"lodash.set(...) for mobx observables",displayName:"observableSetIn",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/core/utils.tsx#observableSetIn"]={docgenInfo:f.__docgenInfo,name:"observableSetIn",path:"../xform/src/core/utils.tsx#observableSetIn"})}catch(Q){}try{b.displayName="composeState",b.__docgenInfo={description:"\u5408\u5e76\u53d7\u63a7\u72b6\u6001\u548c \u975e\u53d7\u63a7\u72b6\u6001",displayName:"composeState",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/core/utils.tsx#composeState"]={docgenInfo:b.__docgenInfo,name:"composeState",path:"../xform/src/core/utils.tsx#composeState"})}catch(Q){}try{h.displayName="splitToPath",h.__docgenInfo={description:"",displayName:"splitToPath",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/core/utils.tsx#splitToPath"]={docgenInfo:h.__docgenInfo,name:"splitToPath",path:"../xform/src/core/utils.tsx#splitToPath"})}catch(Q){}var g=function(e,n){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)n.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(t[r[a]]=e[r[a]])}return t};const v=l.a.createContext(null),S=v.Provider,O=l.a.createContext({}),_=e=>{var{children:n}=e,t=g(e,["children"]);const r=E();return l.a.createElement(O.Provider,{value:Object.assign(Object.assign({},r),t)},n)};function E(){return Object(o.useContext)(O)}function x(){return Object(o.useContext)(v)}const F=Object(a.a)(({name:e,children:n,layout:t,itemFactory:r})=>{var a,o;const s=x();if("&"===e)throw new Error(`XFormArray \u4e0d\u652f\u6301 name=&. path=(${s.path.join(".")||"root"})`);const i=s.getSubArray(e),c=null!==(o=null===(a=i.values)||void 0===a?void 0:a.length)&&void 0!==o?o:0;return l.a.createElement(S,{value:i},t({arrayModel:i,itemCount:c,itemContent:n,itemFactory:r}))}),C=Object(a.a)(({name:e,children:n})=>{const t=x();return"&"===e?l.a.createElement(l.a.Fragment,null,n):l.a.createElement(S,{value:t.getSubModel(e),children:n})}),A=Object(a.a)(e=>{const{name:n,required:t,children:a,defaultValue:o}=e,l=x(),s=Object(r.computed)(()=>"&"===n?l._asField():l.getField(n)).get();s._useTrack(e);const i=b(s.value,o);return a({model:l,name:n,field:s,value:i,required:t,defaultValue:o})});try{S.displayName="ModelProvider",S.__docgenInfo={description:"",displayName:"ModelProvider",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/core/components.tsx#ModelProvider"]={docgenInfo:S.__docgenInfo,name:"ModelProvider",path:"../xform/src/core/components.tsx#ModelProvider"})}catch(Q){}try{_.displayName="FormEnvProvider",_.__docgenInfo={description:"",displayName:"FormEnvProvider",props:{isPreview:{defaultValue:null,description:"",name:"isPreview",required:!1,type:{name:"boolean"}},onSubmit:{defaultValue:null,description:"",name:"onSubmit",required:!1,type:{name:"(submitValues: any, model: RootModel<unknown>) => void"}},onError:{defaultValue:null,description:"",name:"onError",required:!1,type:{name:"(errors: any, model: RootModel<unknown>) => void"}},onReset:{defaultValue:null,description:"",name:"onReset",required:!1,type:{name:"(model: RootModel<unknown>) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/core/components.tsx#FormEnvProvider"]={docgenInfo:_.__docgenInfo,name:"FormEnvProvider",path:"../xform/src/core/components.tsx#FormEnvProvider"})}catch(Q){}try{F.displayName="XFormArray",F.__docgenInfo={description:"\u5bf9\u8c61\u6570\u7ec4\u8868\u5355",displayName:"XFormArray",props:{name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"string"}},layout:{defaultValue:null,description:"",name:"layout",required:!0,type:{name:"(input: XFormArrayLayoutInput) => ReactElement<any, string | JSXElementConstructor<any>>"}},itemFactory:{defaultValue:null,description:"",name:"itemFactory",required:!1,type:{name:"(arrayModel: Model<unknown[]>) => any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/core/components.tsx#XFormArray"]={docgenInfo:F.__docgenInfo,name:"XFormArray",path:"../xform/src/core/components.tsx#XFormArray"})}catch(Q){}try{C.displayName="XFormObject",C.__docgenInfo={description:"\u4e3a\u8be5\u7ec4\u4ef6\u4e0b\u7684 XFormField \u6dfb\u52a0\u4e00\u4e2a\u6570\u636e\u5b57\u6bb5\u524d\u7f00",displayName:"XFormObject",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/core/components.tsx#XFormObject"]={docgenInfo:C.__docgenInfo,name:"XFormObject",path:"../xform/src/core/components.tsx#XFormObject"})}catch(Q){}try{A.displayName="XFormField",A.__docgenInfo={description:"\u8868\u5355\u5b57\u6bb5\uff08field\uff09\n\n\u5728 xform \u4e2d\uff0c\u4e00\u4e2a\u300c\u5b57\u6bb5\u300d\u5305\u542b\u4e00\u4e2a\u300c\u89c6\u56fe\u63a7\u4ef6\u5b9e\u4f8b\u300d\uff08\u4f8b\u5982 Input\uff0cSelect \u5b9e\u4f8b\uff09\u548c\u4e00\u4efd\u72b6\u6001\uff08\u4f8b\u5982 Input \u5305\u542b\u4e00\u4e2a\u5b57\u7b26\u4e32\u72b6\u6001\uff09\uff1b\nXFormField \u662f\u4e00\u4e2a\u9ad8\u9636\u7ec4\u4ef6 / \u57fa\u7840\u7ec4\u4ef6\uff0c\u6bcf\u4e2a\u5177\u4f53\u7684\u7ec4\u4ef6\u7c7b\u578b\uff08\u4f8b\u5982 Input\uff0cSelect \uff09\u90fd\u5e94\u8be5\u7ee7\u627f\u8be5\u7ec4\u4ef6\u5e76\u5c01\u88c5\u76f8\u5e94\u7684 FieldItem\uff1b",displayName:"XFormField",props:{name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"string"}},label:{defaultValue:null,description:"",name:"label",required:!1,type:{name:"ReactNode"}},validate:{defaultValue:null,description:"",name:"validate",required:!1,type:{name:"(value: any) => any"}},required:{defaultValue:null,description:"",name:"required",required:!1,type:{name:"boolean"}},defaultValue:{defaultValue:null,description:"",name:"defaultValue",required:!1,type:{name:"any"}},isEmpty:{defaultValue:null,description:"",name:"isEmpty",required:!1,type:{name:"(value: any) => boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/core/components.tsx#XFormField"]={docgenInfo:A.__docgenInfo,name:"XFormField",path:"../xform/src/core/components.tsx#XFormField"})}catch(Q){}class V{constructor(e,n){this.fieldMap=new Map,this.model=e,this.valueShape=n,this.subModels="array"===n?[]:{}}iterateModels(e){const n=t=>{Object.values(t.subModels).forEach(t=>{e(t),n(t._proxy)})};n(this)}iterateFields(e){this.fieldMap.forEach(e),this.iterateModels(n=>{n._proxy.fieldMap.forEach(e)})}getSubModel(e,n="object"){const t=Array.isArray(e)?e:h(e);let r=this.model;for(let a=0;a<t.length-1;a++)r=r._proxy._getSubModel(t[a],d(t[a+1]));return r._proxy._getSubModel(t[t.length-1],n)}_getSubModel(e,n="object"){i()(!e.includes("."),"name \u4e2d\u4e0d\u80fd\u5305\u542b .");let t=this.subModels[e];return null==t&&(t=new R(this.model,e,n),this.subModels[e]=t),t}getField(e){const n=Array.isArray(e)?e:h(e);if(n.length>1){return this.getSubModel(n[0],d(n[1])).getField(n.slice(1))}const t=n[0];let r=this.fieldMap.get(t);return null==r&&(r=new T(this.model,t),this.fieldMap.set(t,r)),r}}const w=[];class I{constructor(e={}){this._nextModelId=1,this._nextFieldId=1,this.state={},this.root=this,this.parent=this,this.path=w,this.valueShape="object",this._proxy=new V(this,"object"),this.values=e,Object(r.makeObservable)(this,{values:r.observable,state:r.observable,setValue:r.action})}getNextModelId(){return"Model_"+this._nextModelId++}getNextFieldId(){return"Field_"+this._nextFieldId++}getValue(e,n){return p(this.values,e,n)}setValue(e,n){f(this.values,e,n)}getSubModel(e){return this._proxy.getSubModel(e,"object")}getSubArray(e){return this._proxy.getSubModel(e,"array")}getField(e){return this._proxy.getField(e)}_asField(){throw new Error("RootModel \u4e0b\u4e0d\u652f\u6301\u4f7f\u7528 name=& \u7684 Field")}}class R{constructor(e,n,t){this.state={},i()(!n.includes("."),"name \u4e2d\u4e0d\u80fd\u5305\u542b ."),this.root=e.root,this.parent=e,this.name=n,this.valueShape=t,this._proxy=new V(this,t),this.id=this.root.getNextModelId(),Object(r.makeObservable)(this,{values:r.computed,state:r.observable,setValue:r.action,name:r.observable},{name:`${this.id}(${this.name})`})}get path(){return[...this.parent.path,this.name]}getSubModel(e){return this._proxy.getSubModel(e,"object")}getSubArray(e){return this._proxy.getSubModel(e,"array")}get values(){return this.parent.getValue(this.name)}set values(e){this.parent.setValue(this.name,e)}getField(e){return this._proxy.getField(e)}getValue(e,n){return p(this.values,e,n)}setValue(e,n){null==this.values&&(this.values="array"===this.valueShape?[]:{}),f(this.values,e,n)}_asField(){return this.parent.getField(this.name)}}class T{constructor(e,n){this.config=null,this.mountCount=0,this.state={},this.parent=e,this.name=n,this.id=this.parent.root.getNextFieldId(),Object(r.makeObservable)(this,{state:r.observable,name:r.observable.ref,value:r.computed,path:r.computed,config:!1,mountCount:!1},{name:`${this.id}(${this.name})`})}get value(){return this.parent.getValue(this.name)}set value(e){this.parent.setValue(this.name,e)}get path(){return this.parent.path.concat([this.name])}_useTrack(e){Object(o.useLayoutEffect)(()=>(this.config=e,this.mountCount+=1,()=>{this.config=null,this.mountCount-=1}),[e])}}var j=t(162);const k={validate:Object(r.action)(e=>{if(null==e.config)return;const{validate:n,required:t,defaultValue:r,isEmpty:a}=e.config,o=e.value;let l;return l=t&&a(o)?"\u8be5\u5b57\u6bb5\u662f\u5fc5\u586b\u5b57\u6bb5":null==n?void 0:n(b(o,r)),e.state.error=l,l}),handleBlur(e){k.validate(e)},handleChange:Object(r.action)((e,n)=>{e.value=n,k.validate(e)})},M={clearError:Object(r.action)(e=>{e._proxy.iterateFields(e=>{e.state.error=null})}),validateAll:Object(r.action)(e=>{const n=Object(r.observable)("array"===e.valueShape?[]:{});let t=!1;return e._proxy.iterateFields(e=>{if(0===e.mountCount)return;const r=k.validate(e);r&&(t=!0,f(n,e.path,r))}),{hasError:t,errors:Object(r.toJS)(n)}})};var P=function(e,n){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)n.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(t[r[a]]=e[r[a]])}return t};function B({model:e,defaultValue:n,isPreview:t,isInline:r,labelPosition:a,onSubmit:s,onError:i,onReset:c,children:u,className:m,style:d}){const[p]=Object(o.useState)(()=>new I(n)),f=b(e,p);return l.a.createElement(_,{isPreview:t,onError:i,onReset:c,onSubmit:s},l.a.createElement(S,{value:f},l.a.createElement(j.FormLayout,{labelPosition:a,isInline:r,style:d,className:m},u)))}const q=Object(a.a)(({watch:e,effect:n})=>{const t=x(),a=t.getField(e);return Object(o.useEffect)(()=>Object(r.reaction)(()=>a.value,(e,r)=>n(e,{model:t,prev:r,next:e})),[t,e,a,n]),null}),L=Object(a.a)(({children:e})=>e(x()));B.Submit=function(e){var{type:n="primary",children:t="\u63d0\u4ea4"}=e,a=P(e,["type","children"]);const o=x().root,{onSubmit:s,onError:i}=E();return l.a.createElement(j.Button,Object.assign({onClick:()=>{const{hasError:e,errors:n}=M.validateAll(o);if(e)null==i||i(n,o);else if("function"==typeof s){const e=Object(r.observable)("array"===o.valueShape?[]:{});o._proxy.iterateFields(n=>{if(0===n.mountCount)return;const{path:t,value:r}=n;f(e,t,r)}),s(Object(r.toJS)(e),o)}},type:n,children:t},a))},B.Reset=function(e){var{children:n="\u91cd\u7f6e"}=e,t=P(e,["children"]);const a=x().root,{onReset:o}=E();return l.a.createElement(j.Button,Object.assign({onClick:Object(r.action)(()=>{a.values={},M.clearError(a),null==o||o(a)}),children:n},t))},B.Effect=q,B.Array=F,B.Object=C,B.Field=A,B.ModelConsumer=L;try{B.displayName="Form",B.__docgenInfo={description:"",displayName:"Form",props:{model:{defaultValue:null,description:"\u53d7\u63a7\u7528\u6cd5\u3002 xform \u6a21\u578b\u5bf9\u8c61\uff0c\u4e00\u822c\u7531\u4e0a\u5c42\u901a\u8fc7 new RootModel(...) \u521b\u5efa\u800c\u6210",name:"model",required:!1,type:{name:"IModel<unknown>"}},defaultValue:{defaultValue:null,description:"\u975e\u53d7\u63a7\u7528\u6cd5\u3002 \u8868\u5355\u7684\u9ed8\u8ba4\u503c",name:"defaultValue",required:!1,type:{name:"any"}},onSubmit:{defaultValue:null,description:"\u63d0\u4ea4\u8868\u5355\u65f6\u7684\u56de\u8c03\u51fd\u6570\uff0c\u9700\u914d\u5408 <Form.Submit /> \u4f7f\u7528",name:"onSubmit",required:!1,type:{name:"(submitValues: any, model: RootModel<unknown>) => void"}},onError:{defaultValue:null,description:"\u63d0\u4ea4\u8868\u5355\u65f6\u7684\u51fa\u9519\u56de\u8c03\u51fd\u6570\uff0c\u9700\u914d\u5408 <Form.Submit /> \u4f7f\u7528",name:"onError",required:!1,type:{name:"(errors: any, model: RootModel<unknown>) => void"}},onReset:{defaultValue:null,description:"\u6e05\u7a7a\u8868\u5355\u65f6\u7684\u56de\u8c03\u51fd\u6570\uff0c\u9700\u914d\u5408 <Form.Reset /> \u4f7f\u7528",name:"onReset",required:!1,type:{name:"(model: RootModel<unknown>) => void"}},isPreview:{defaultValue:{value:"false"},description:"\u662f\u5426\u4e3a\u9884\u89c8\u6001",name:"isPreview",required:!1,type:{name:"boolean"}},isInline:{defaultValue:{value:"false"},description:"\u662f\u5426\u5185\u8054\u5e03\u5c40\n@category \u5e03\u5c40",name:"isInline",required:!1,type:{name:"boolean"}},labelPosition:{defaultValue:{value:"'top'"},description:"\u6807\u7b7e\u4f4d\u7f6e\n@category \u5e03\u5c40",name:"labelPosition",required:!1,type:{name:'"top" | "left"'}},style:{defaultValue:null,description:"@category \u5e03\u5c40",name:"style",required:!1,type:{name:"CSSProperties"}},className:{defaultValue:null,description:"@category \u5e03\u5c40",name:"className",required:!1,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/form.tsx#Form"]={docgenInfo:B.__docgenInfo,name:"Form",path:"../xform/src/form.tsx#Form"})}catch(Q){}try{B.Submit.displayName="Form.Submit",B.Submit.__docgenInfo={description:"",displayName:"Form.Submit",props:{shape:{defaultValue:null,description:"",name:"shape",required:!1,type:{name:'"link" | "text" | "solid" | "ghost" | "warning"'}},type:{defaultValue:{value:"primary"},description:"",name:"type",required:!1,type:{name:'"primary" | "secondary" | "normal"'}},size:{defaultValue:null,description:"",name:"size",required:!1,type:{name:'"small" | "medium" | "large"'}},htmlType:{defaultValue:null,description:"",name:"htmlType",required:!1,type:{name:'"button" | "submit" | "reset"'}},isFullWidth:{defaultValue:null,description:"",name:"isFullWidth",required:!1,type:{name:"boolean"}},isSelected:{defaultValue:null,description:"",name:"isSelected",required:!1,type:{name:"boolean"}},loading:{defaultValue:null,description:"",name:"loading",required:!1,type:{name:"boolean"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},leftElement:{defaultValue:null,description:"",name:"leftElement",required:!1,type:{name:"ReactNode"}},rightElement:{defaultValue:null,description:"",name:"rightElement",required:!1,type:{name:"ReactNode"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/form.tsx#Form.Submit"]={docgenInfo:B.Submit.__docgenInfo,name:"Form.Submit",path:"../xform/src/form.tsx#Form.Submit"})}catch(Q){}try{B.Reset.displayName="Form.Reset",B.Reset.__docgenInfo={description:"",displayName:"Form.Reset",props:{shape:{defaultValue:null,description:"",name:"shape",required:!1,type:{name:'"link" | "text" | "solid" | "ghost" | "warning"'}},type:{defaultValue:null,description:"",name:"type",required:!1,type:{name:'"primary" | "secondary" | "normal"'}},size:{defaultValue:null,description:"",name:"size",required:!1,type:{name:'"small" | "medium" | "large"'}},htmlType:{defaultValue:null,description:"",name:"htmlType",required:!1,type:{name:'"button" | "submit" | "reset"'}},isFullWidth:{defaultValue:null,description:"",name:"isFullWidth",required:!1,type:{name:"boolean"}},isSelected:{defaultValue:null,description:"",name:"isSelected",required:!1,type:{name:"boolean"}},loading:{defaultValue:null,description:"",name:"loading",required:!1,type:{name:"boolean"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},leftElement:{defaultValue:null,description:"",name:"leftElement",required:!1,type:{name:"ReactNode"}},rightElement:{defaultValue:null,description:"",name:"rightElement",required:!1,type:{name:"ReactNode"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/form.tsx#Form.Reset"]={docgenInfo:B.Reset.__docgenInfo,name:"Form.Reset",path:"../xform/src/form.tsx#Form.Reset"})}catch(Q){}try{B.Effect.displayName="Form.Effect",B.Effect.__docgenInfo={description:"",displayName:"Form.Effect",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/form.tsx#Form.Effect"]={docgenInfo:B.Effect.__docgenInfo,name:"Form.Effect",path:"../xform/src/form.tsx#Form.Effect"})}catch(Q){}try{B.Array.displayName="Form.Array",B.Array.__docgenInfo={description:"",displayName:"Form.Array",props:{name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"string"}},layout:{defaultValue:null,description:"",name:"layout",required:!0,type:{name:"(input: XFormArrayLayoutInput) => ReactElement<any, string | JSXElementConstructor<any>>"}},itemFactory:{defaultValue:null,description:"",name:"itemFactory",required:!1,type:{name:"(arrayModel: Model<unknown[]>) => any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/form.tsx#Form.Array"]={docgenInfo:B.Array.__docgenInfo,name:"Form.Array",path:"../xform/src/form.tsx#Form.Array"})}catch(Q){}try{B.Object.displayName="Form.Object",B.Object.__docgenInfo={description:"",displayName:"Form.Object",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/form.tsx#Form.Object"]={docgenInfo:B.Object.__docgenInfo,name:"Form.Object",path:"../xform/src/form.tsx#Form.Object"})}catch(Q){}try{B.Field.displayName="Form.Field",B.Field.__docgenInfo={description:"",displayName:"Form.Field",props:{name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"string"}},label:{defaultValue:null,description:"",name:"label",required:!1,type:{name:"ReactNode"}},validate:{defaultValue:null,description:"",name:"validate",required:!1,type:{name:"(value: any) => any"}},required:{defaultValue:null,description:"",name:"required",required:!1,type:{name:"boolean"}},defaultValue:{defaultValue:null,description:"",name:"defaultValue",required:!1,type:{name:"any"}},isEmpty:{defaultValue:null,description:"",name:"isEmpty",required:!1,type:{name:"(value: any) => boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/form.tsx#Form.Field"]={docgenInfo:B.Field.__docgenInfo,name:"Form.Field",path:"../xform/src/form.tsx#Form.Field"})}catch(Q){}try{B.ModelConsumer.displayName="Form.ModelConsumer",B.ModelConsumer.__docgenInfo={description:"",displayName:"Form.ModelConsumer",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/form.tsx#Form.ModelConsumer"]={docgenInfo:B.ModelConsumer.__docgenInfo,name:"Form.ModelConsumer",path:"../xform/src/form.tsx#Form.ModelConsumer"})}catch(Q){}var N=function(e,n){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)n.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(t[r[a]]=e[r[a]])}return t};function K(e){var n;return null!==(n=e.value)&&void 0!==n?n:e.defaultValue}function Y(e){return!e}function z(e){return null==e}function J(e){return null==e||Array.isArray(e)&&0===e.length}const G={};function X(e,n){function t(t){var{defaultValue:r=n.fallbackValue,componentProps:a,value:o,onChange:s,onBlur:i}=t,c=N(t,["defaultValue","componentProps","value","onChange","onBlur"]);const{isPreview:u}=E();return l.a.createElement(A,Object.assign({defaultValue:r,isEmpty:n.isEmpty},c),({model:t,name:r,field:m,value:d,required:p})=>{const f=m.state.error,y=Object.assign(Object.assign(Object.assign({},Object(j.pick)(c,["dataSource","items"])),a),{value:void 0!==o?o:d,onChange:void 0!==s?s:e=>k.handleChange(m,e),onBlur:void 0!==i?i:()=>k.handleBlur(m),status:f?"error":void 0});return l.a.createElement(j.FormControl,{label:c.label,required:p,error:f},u?n.previewRender(y):l.a.createElement(e,Object.assign({},y)))})}t.displayName=`FormItem(${n.name})`,G[n.name]=t}function D(e){var{component:n}=e,t=N(e,["component"]);const r=G[n];return null==r?l.a.createElement(j.FormControl,null,l.a.createElement("div",{style:{border:"1px dashed var(--rex-colors-error-hover)",fontSize:14,padding:4,color:"var(--rex-colors-error-normal)"}},l.a.createElement("code",null,"<FormItem component='",n,"' />")," \u6ca1\u6709\u627e\u5230\u5bf9\u5e94\u7ec4\u4ef6\uff0c\u8bf7\u68c0\u67e5\u7ec4\u4ef6\u540d\u79f0\u662f\u5426\u62fc\u5199\u6b63\u786e")):l.a.createElement(r,t)}X(j.Switch,{name:"switch",previewRender(e){var n;return(null!==(n=e.value)&&void 0!==n?n:e.defaultValue)?"\u662f":"\u5426"},fallbackValue:!1,isEmpty:Y}),X(j.CheckboxGroup,{name:"checkboxGroup",fallbackValue:[],previewRender(e){var n;const t=null!==(n=e.value)&&void 0!==n?n:e.defaultValue,r=new j.ListStore(e.dataSource);return t.map(e=>{const n=r.getItem(e);return n?n.label:e}).join("\u3001")},isEmpty:e=>null==e||0===e.length}),X(j.RadioGroup,{name:"radioGroup",fallbackValue:null,previewRender(e){var n;const t=null!==(n=e.value)&&void 0!==n?n:e.defaultValue,r=new j.ListStore(e.dataSource).getItem(t);return r?r.label:t},isEmpty:Y}),X(j.DatePicker,{name:"datePicker",previewRender:K,fallbackValue:null,isEmpty:Y}),X(j.DateRangePicker,{name:"dateRangePicker",previewRender(e){var n;const t=(null!==(n=e.value)&&void 0!==n?n:e.defaultValue)||[];return`${t[0]||"-"} ~ ${t[1]||"-"}`},fallbackValue:["",""],isEmpty:Y}),X(j.TimePicker,{name:"timePicker",previewRender:K,fallbackValue:"",isEmpty:Y}),X(j.FilePicker,{name:"filePicker",previewRender(e){var n;const t=(null!==(n=e.value)&&void 0!==n?n:e.defaultValue)||[];return l.a.createElement(j.Flex,{spacing:"s",direction:"column"},t.map(({id:e,name:n,url:t})=>l.a.createElement(j.FlexItem,{key:e,bg:"fill.layer1",px:"m"},l.a.createElement(j.Link,{href:t},n))))},fallbackValue:[],isEmpty:J}),X(j.MediaPicker,{name:"mediaPicker",previewRender(e){var n;const t=(null!==(n=e.value)&&void 0!==n?n:e.defaultValue)||[];return l.a.createElement(j.Flex,{spacing:"m"},t.map(({id:e,name:n,url:t})=>{const r=`${Object(j.colors)("fill.layer1")} url(${t}) center center / 100% no-repeat`;return l.a.createElement(j.Box,{key:e,size:"100px",title:n,display:"inline-block",style:{background:r}})}))},fallbackValue:[],isEmpty:J}),X(j.Input,{name:"input",previewRender:K,fallbackValue:"",isEmpty:Y}),X(j.Textarea,{name:"textarea",previewRender:K,fallbackValue:"",isEmpty:Y}),X(j.NumberInput,{name:"numberInput",previewRender:K,fallbackValue:null,isEmpty:z}),X(j.Range,{name:"range",previewRender:K,fallbackValue:0,isEmpty:z}),X(j.Select,{name:"select",previewRender:K,fallbackValue:null,isEmpty:z}),X(j.SingleSelect,{name:"singleSelect",previewRender:K,fallbackValue:null,isEmpty:Y}),X(j.MultiSelect,{name:"multiSelect",previewRender:K,fallbackValue:[],isEmpty:J}),X(j.TreeSelect,{name:"treeSelect",previewRender:K,fallbackValue:null,isEmpty:J}),X(j.SingleTreeSelect,{name:"singleTreeSelect",previewRender:K,fallbackValue:null,isEmpty:Y}),X(j.MultiTreeSelect,{name:"multiTreeSelect",previewRender:K,fallbackValue:[],isEmpty:J}),X((function(e){var{items:n,value:t,onChange:r}=e,a=N(e,["items","value","onChange"]);return l.a.createElement("div",Object.assign({style:{display:"flex",gap:8}},a),n.map(e=>l.a.createElement(j.Button,{key:e,type:e===t?"primary":"normal",onClick:()=>r(e)},e)))}),{name:"testButtonGroup",fallbackValue:"",previewRender:K,isEmpty:Y});try{D.displayName="FormItem",D.__docgenInfo={description:"",displayName:"FormItem",props:{component:{defaultValue:null,description:"",name:"component",required:!0,type:{name:'"switch" | "checkboxGroup" | "radioGroup" | "datePicker" | "dateRangePicker" | "timePicker" | "filePicker" | "mediaPicker" | "input" | "textarea" | "numberInput" | "range" | ... 6 more ... | "testButtonGroup"'}},componentProps:{defaultValue:null,description:"",name:"componentProps",required:!1,type:{name:"SwitchProps | CheckboxGroupProps | RadioGroupProps | DatePickerProps | DateRangePickerProps | ... 11 more ... | HTMLProps<...>"}},defaultValue:{defaultValue:null,description:"",name:"defaultValue",required:!1,type:{name:"any"}},name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"string"}},label:{defaultValue:null,description:"",name:"label",required:!1,type:{name:"ReactNode"}},validate:{defaultValue:null,description:"",name:"validate",required:!1,type:{name:"(value: any) => any"}},required:{defaultValue:null,description:"",name:"required",required:!1,type:{name:"boolean"}},isEmpty:{defaultValue:null,description:"",name:"isEmpty",required:!1,type:{name:"(value: any) => boolean"}},dataSource:{defaultValue:null,description:"",name:"dataSource",required:!1,type:{name:"ListNode<StringOrNumber>[] | ListNode<string>[] | (string | SelectItem)[] | TreeSelectItem[]"}},items:{defaultValue:null,description:"",name:"items",required:!0,type:{name:"string[]"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/form-item.tsx#FormItem"]={docgenInfo:D.__docgenInfo,name:"FormItem",path:"../xform/src/form-item.tsx#FormItem"})}catch(Q){}const U=e=>{const n=[];for(let t=0;t<e;t++)n.push(t);return n},W=({title:e,showItemCount:n,showItemOrder:t,style:a}={})=>{const o={position:"absolute",top:8,right:8,display:"flex",gap:8,zIndex:20};return s=>{const{arrayModel:i,itemContent:c,itemCount:u,itemFactory:m}=s;return l.a.createElement("div",{className:"xform-array",style:Object.assign({marginTop:16,marginBottom:8},a)},(e||n)&&l.a.createElement("h2",null,null!=e?e:"\u5217\u8868"," ",n&&`(${u})`),0===u&&l.a.createElement("div",{style:{border:"1px dashed #aaa",marginTop:16,padding:8,position:"relative",fontSize:20}},"\u7a7a\u7a7a\u5982\u4e5f~~"),l.a.createElement("div",{className:"xform-array-items"},U(u).map(e=>l.a.createElement("div",{key:y.getKey(i,e),className:"xform-array-item",style:{border:"1px dashed #aaa",marginTop:16,padding:8,position:"relative"}},t&&l.a.createElement("code",{style:{fontSize:16}},i.path.join("."),"#",e),l.a.createElement($,Object.assign({},s,{itemIndex:e,style:o})),y.renderArrayItem(i,e,c)))),l.a.createElement("div",{style:{marginTop:12}},l.a.createElement(j.Button,{onClick:Object(r.action)(()=>{y.append(i,m)})},"\u6dfb\u52a0\u4e00\u9879")))}},$=Object(a.a)(({arrayModel:e,itemCount:n,itemIndex:t,style:a})=>l.a.createElement("div",{style:a},l.a.createElement(j.Button,{size:"small",onClick:Object(r.action)(()=>{y.delete(e,t)})},"\u5220\u9664"),l.a.createElement(j.Button,{size:"small",disabled:0===t,onClick:Object(r.action)(()=>{y.moveUp(e,t)})},"\u4e0a\u79fb"),l.a.createElement(j.Button,{size:"small",disabled:t===n-1,onClick:Object(r.action)(()=>{y.moveDown(e,t)})},"\u4e0b\u79fb"))),H=({defaultColumnWidth:e,orderColumn:n,operationColumn:t,className:r,style:a}={})=>{const o={display:"flex",gap:0};return s=>{const{arrayModel:i,itemContent:c,itemCount:u,itemFactory:m}=s,d=l.a.Children.toArray(c).filter(e=>e.type===D).map(e=>Object.assign(Object.assign({name:"string"==typeof e.props.label?e.props.label:null,title:e.props.label},e.props["x-table-column"]),{render:(n,t)=>l.a.createElement(C,{name:String(t.itemIndex)},l.a.cloneElement(e,{label:null,isInline:!0}))}));return null!=n&&d.unshift(Object.assign(Object.assign({name:"#"},n),{getValue:e=>e.itemIndex+1})),null!=t&&d.push(Object.assign(Object.assign({name:""},t),{render:(e,n)=>l.a.createElement($,Object.assign({},s,{itemIndex:n.itemIndex,style:o}))})),l.a.createElement("div",{style:a,className:r},l.a.createElement(j.BaseTable,{className:"bordered",primaryKey:"rowKey",defaultColumnWidth:e,dataSource:U(u).map(e=>({rowKey:y.getKey(i,e),itemIndex:e})),columns:d}),l.a.createElement("div",{style:{padding:4,height:48,display:"flex",alignItems:"center",justifyContent:"center",background:"#f5f5f5"}},l.a.createElement(j.Button,{type:"primary",onClick:()=>{y.append(i,m)}},"\u6dfb\u52a0\u4e00\u884c")))}};try{W.displayName="arrayCard",W.__docgenInfo={description:"",displayName:"arrayCard",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/array-layouts.tsx#arrayCard"]={docgenInfo:W.__docgenInfo,name:"arrayCard",path:"../xform/src/array-layouts.tsx#arrayCard"})}catch(Q){}try{H.displayName="arrayTable",H.__docgenInfo={description:"",displayName:"arrayTable",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/array-layouts.tsx#arrayTable"]={docgenInfo:H.__docgenInfo,name:"arrayTable",path:"../xform/src/array-layouts.tsx#arrayTable"})}catch(Q){}},309:function(e,n,t){"use strict";t.d(n,"a",(function(){return f}));var r=t(3),a=t(162),o=t(205),l=t(167),s=t(180),i=t(0),c=t.n(i);function u({children:e,fallback:n}){return"undefined"==typeof document||null==e?null!=n?n:null:c.a.createElement(c.a.Fragment,null,e())}const m={filename:"/Users/feichao.sfc/code/github/alibaba/rex-design/packages/story/src/xform/helpers.tsx",loc:{start:{line:9,column:0},end:{line:21,column:1}},name:"BrowserOnly",value:u,source:" function _nullishCoalesce(lhs, rhsFn) { if (lhs != null) { return lhs; } else { return rhsFn(); } }function BrowserOnly({\n  children,\n  fallback,\n}\n\n\n) {\n  if (typeof document === 'undefined' || children == null) {\n    return _nullishCoalesce(fallback, () => ( null));\n  }\n\n  return <>{children()}</>;\n}",deps:()=>[],provides:{React:c.a}},d=e=>c.a.createElement(u,null,()=>{const n=t(368).default;return c.a.createElement(n,Object(r.a)({style:Object.assign({marginTop:8,fontSize:12},e.style)},e))}),p={filename:"/Users/feichao.sfc/code/github/alibaba/rex-design/packages/story/src/xform/helpers.tsx",loc:{start:{line:23,column:7},end:{line:32,column:2}},name:"BrowserOnlyReactJson",value:d,source:"const BrowserOnlyReactJson = (props) => {\n  return (\n    <BrowserOnly>\n      {() => {\n        const ReactJson = require('react-json-view').default;\n        return <ReactJson style={{ marginTop: 8, fontSize: 12, ...props.style }} {...props} />;\n      }}\n    </BrowserOnly>\n  );\n};",deps:()=>[m],provides:{}};d.__doc_info=p,d.__inner_source="(props) => {\n  return (\n    <BrowserOnly>\n      {() => {\n        const ReactJson = require('react-json-view').default;\n        return <ReactJson style={{ marginTop: 8, fontSize: 12, ...props.style }} {...props} />;\n      }}\n    </BrowserOnly>\n  );\n}";const f=Object(s.a)(({style:e,defaultShow:n})=>{var t;const r=Object(o.h)(),s=Object(l.toJS)(r.values),i=null!==(t=r.state.showReactJson)&&void 0!==t?t:n;return c.a.createElement("div",{style:Object.assign({marginTop:16},e)},c.a.createElement("div",{style:{marginTop:8,display:"flex",alignItems:"center",gap:8}},c.a.createElement(a.Switch,{value:i,onChange:Object(l.action)(e=>{r.state.showReactJson=e})}),c.a.createElement("span",{style:{fontSize:12}},"\u663e\u793a JSON")),i&&c.a.createElement(d,{name:"\u8868\u5355\u72b6\u6001\u9884\u89c8",src:s}))}),y=(s.a,c.a,o.h,l.toJS,a.Switch,l.action,Object(s.a)(({label:e,printAll:n})=>{const t=Object(o.h)();return Object(i.useEffect)(()=>Object(l.autorun)(()=>{console.log(`[ValuePrinter] ${null!=e?e:""}\n`,n?Object.assign(Object.assign({},t),{values:Object(l.toJS)(t.values)}):Object(l.toJS)(t.values))}),[e,t,n]),null}));s.a,o.h,i.useEffect,l.autorun,l.toJS,Object(s.a)(()=>{const e=Object(o.h)().root;return c.a.createElement("div",{style:{display:"flex",gap:8}},c.a.createElement(a.Button,{onClick:()=>o.g.validateAll(e)},"\u6821\u9a8c\u5168\u90e8"),c.a.createElement(a.Button,{onClick:()=>o.g.clearError(e)},"\u6e05\u7a7a\u9519\u8bef"),c.a.createElement(a.Button,{onClick:Object(l.action)(()=>{e.values={opCount:0,sku:{code:"test"}},o.g.clearError(e)})},"\u91cd\u7f6e\u8868\u5355"))}),s.a,o.h,a.Button,o.g,l.action,Object(s.a)(()=>{const e=Object(o.h)();return Object(i.useEffect)(()=>(window.model=e,window.toJS=l.toJS,window.mobx=l,()=>{delete window.model,delete window.toJS,delete window.mobx}),[e]),c.a.createElement(c.a.Fragment,null)}),s.a,o.h,i.useEffect,l.toJS;class b extends Error{}function h(e){if("ready"!==e.status)throw new b;return e.current}const g={filename:"/Users/feichao.sfc/code/github/alibaba/rex-design/packages/story/src/xform/helpers.tsx",loc:{start:{line:131,column:0},end:{line:136,column:1}},name:"getFromAsyncValue",value:h,source:"function getFromAsyncValue(x) {\n  if (x.status !== 'ready') {\n    throw new AsyncLoadingError();\n  }\n  return x.current;\n}",deps:()=>[__doc_info_AsyncLoadingError],provides:{}};function v(e,n){const t=l.createAtom("atom@asyncSelect"),r=[];let a="loading",o=n;const s=Object(l.computed)(()=>(t.reportObserved(),a)),i=Object(l.computed)(()=>(t.reportObserved(),o));let c,u;const m=()=>{c&&(c.dispose(),c=null)};return r.push(l.onBecomeObserved(t,()=>{c=new l.Reaction("async",()=>{"loading"!==a&&(a="loading",t.reportChanged()),c.track(()=>{var n;null===(n=u)||void 0===n||n();let r=!1;u=()=>{r=!0},e(h).then(Object(l.action)(e=>{if(!r)return a="ready",o=e,t.reportChanged(),e})).catch(e=>{if(!(e instanceof b))throw e})})}),c.schedule_()})),r.push(l.onBecomeUnobserved(t,m)),r.push(m),{get status(){return s.get()},get current(){return i.get()},dispose(){for(const e of r)e()},refresh(){var e;null===(e=c)||void 0===e||e.onBecomeStale_()}}}const S={filename:"/Users/feichao.sfc/code/github/alibaba/rex-design/packages/story/src/xform/helpers.tsx",loc:{start:{line:138,column:7},end:{line:225,column:1}},name:"makeAsyncValue",value:v,source:" function _optionalChain(ops) { let lastAccessLHS = undefined; let value = ops[0]; let i = 1; while (i < ops.length) { const op = ops[i]; const fn = ops[i + 1]; i += 2; if ((op === 'optionalAccess' || op === 'optionalCall') && value == null) { return undefined; } if (op === 'access' || op === 'optionalAccess') { lastAccessLHS = value; value = fn(value); } else if (op === 'call' || op === 'optionalCall') { value = fn((...args) => value.call(lastAccessLHS, ...args)); lastAccessLHS = undefined; } } return value; }function makeAsyncValue(getter, initValue) {\n  const atom = mobx.createAtom('atom@asyncSelect');\n  const disposers = [];\n\n  let status = 'loading';\n  let current = initValue;\n\n  const computedStatus = computed(() => {\n    atom.reportObserved();\n    return status;\n  });\n  const computedCurrent = computed(() => {\n    atom.reportObserved();\n    return current;\n  });\n\n  let reaction;\n  let cancelLastGetter;\n\n  const start = () => {\n    reaction = new mobx.Reaction('async', () => {\n      if (status !== 'loading') {\n        status = 'loading';\n        atom.reportChanged();\n      }\n\n      reaction.track(() => {\n        _optionalChain([cancelLastGetter, 'optionalCall', _ => _()]);\n\n        let cancelled = false;\n        cancelLastGetter = () => {\n          cancelled = true;\n        };\n\n        getter(getFromAsyncValue)\n          .then(\n            action((newValue) => {\n              if (cancelled) {\n                return;\n              }\n              status = 'ready';\n              current = newValue;\n              atom.reportChanged();\n\n              return newValue;\n            }),\n          )\n          .catch((e) => {\n            if (e instanceof AsyncLoadingError) {\n              // still loading, do nothing\n              return;\n            }\n            // TODO \u5904\u7406 error \u72b6\u6001\n            throw e;\n          });\n      });\n    });\n    reaction.schedule_();\n  };\n\n  const stop = () => {\n    if (reaction) {\n      reaction.dispose();\n      reaction = null;\n    }\n  };\n\n  disposers.push(mobx.onBecomeObserved(atom, start));\n  disposers.push(mobx.onBecomeUnobserved(atom, stop));\n  disposers.push(stop);\n\n  return {\n    get status() {\n      return computedStatus.get();\n    },\n    get current() {\n      return computedCurrent.get();\n    },\n    dispose() {\n      for (const fn of disposers) {\n        fn();\n      }\n    },\n    refresh() {\n      _optionalChain([reaction, 'optionalAccess', _2 => _2.onBecomeStale_, 'call', _3 => _3()]);\n    },\n  };\n}",deps:()=>[g,__doc_info_AsyncLoadingError],provides:{mobx:l,computed:l.computed,action:l.action}};v.__inner_source=" function _optionalChain(ops) { let lastAccessLHS = undefined; let value = ops[0]; let i = 1; while (i < ops.length) { const op = ops[i]; const fn = ops[i + 1]; i += 2; if ((op === 'optionalAccess' || op === 'optionalCall') && value == null) { return undefined; } if (op === 'access' || op === 'optionalAccess') { lastAccessLHS = value; value = fn(value); } else if (op === 'call' || op === 'optionalCall') { value = fn((...args) => value.call(lastAccessLHS, ...args)); lastAccessLHS = undefined; } } return value; }function makeAsyncValue(getter, initValue) {\n  const atom = mobx.createAtom('atom@asyncSelect');\n  const disposers = [];\n\n  let status = 'loading';\n  let current = initValue;\n\n  const computedStatus = computed(() => {\n    atom.reportObserved();\n    return status;\n  });\n  const computedCurrent = computed(() => {\n    atom.reportObserved();\n    return current;\n  });\n\n  let reaction;\n  let cancelLastGetter;\n\n  const start = () => {\n    reaction = new mobx.Reaction('async', () => {\n      if (status !== 'loading') {\n        status = 'loading';\n        atom.reportChanged();\n      }\n\n      reaction.track(() => {\n        _optionalChain([cancelLastGetter, 'optionalCall', _ => _()]);\n\n        let cancelled = false;\n        cancelLastGetter = () => {\n          cancelled = true;\n        };\n\n        getter(getFromAsyncValue)\n          .then(\n            action((newValue) => {\n              if (cancelled) {\n                return;\n              }\n              status = 'ready';\n              current = newValue;\n              atom.reportChanged();\n\n              return newValue;\n            }),\n          )\n          .catch((e) => {\n            if (e instanceof AsyncLoadingError) {\n              // still loading, do nothing\n              return;\n            }\n            // TODO \u5904\u7406 error \u72b6\u6001\n            throw e;\n          });\n      });\n    });\n    reaction.schedule_();\n  };\n\n  const stop = () => {\n    if (reaction) {\n      reaction.dispose();\n      reaction = null;\n    }\n  };\n\n  disposers.push(mobx.onBecomeObserved(atom, start));\n  disposers.push(mobx.onBecomeUnobserved(atom, stop));\n  disposers.push(stop);\n\n  return {\n    get status() {\n      return computedStatus.get();\n    },\n    get current() {\n      return computedCurrent.get();\n    },\n    dispose() {\n      for (const fn of disposers) {\n        fn();\n      }\n    },\n    refresh() {\n      _optionalChain([reaction, 'optionalAccess', _2 => _2.onBecomeStale_, 'call', _3 => _3()]);\n    },\n  };\n}",v.__doc_info=S;try{d.displayName="BrowserOnlyReactJson",d.__docgenInfo={description:"",displayName:"BrowserOnlyReactJson",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../story/src/xform/helpers.tsx#BrowserOnlyReactJson"]={docgenInfo:d.__docgenInfo,name:"BrowserOnlyReactJson",path:"../story/src/xform/helpers.tsx#BrowserOnlyReactJson"})}catch(O){}try{f.displayName="ValuePreview",f.__docgenInfo={description:"",displayName:"ValuePreview",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../story/src/xform/helpers.tsx#ValuePreview"]={docgenInfo:f.__docgenInfo,name:"ValuePreview",path:"../story/src/xform/helpers.tsx#ValuePreview"})}catch(O){}try{y.displayName="ValuePrinter",y.__docgenInfo={description:"",displayName:"ValuePrinter",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../story/src/xform/helpers.tsx#ValuePrinter"]={docgenInfo:y.__docgenInfo,name:"ValuePrinter",path:"../story/src/xform/helpers.tsx#ValuePrinter"})}catch(O){}}}]);
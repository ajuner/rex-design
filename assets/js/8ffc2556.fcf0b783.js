(window.webpackJsonp=window.webpackJsonp||[]).push([[44],{137:function(e,n,t){"use strict";t.r(n),t.d(n,"frontMatter",(function(){return V})),t.d(n,"metadata",(function(){return I})),t.d(n,"toc",(function(){return T})),t.d(n,"default",(function(){return M}));var r=t(3),o=t(7),a=t(0),l=t.n(a),i=t(166),c=t(213),s=t(163),u=t(170),d=t(318),m=new c.d({name:"\u5c0f\u6cb3\u9a6c",phone:"188-8888-8888",address:"\u676d\u5dde\u5e02\u4f59\u676d\u533a\u6587\u4e00\u897f\u8def969\u53f7"}),p={filename:"/Users/feichao.sfc/code/github/alibaba/rex-design/packages/story/src/xform/basic-examples.stories.tsx",loc:{start:{line:9,column:0},end:{line:13,column:3}},name:"simpleFormModel",value:m,source:"const simpleFormModel = new RootModel({\n  name: '\u5c0f\u6cb3\u9a6c',\n  phone: '188-8888-8888',\n  address: '\u676d\u5dde\u5e02\u4f59\u676d\u533a\u6587\u4e00\u897f\u8def969\u53f7',\n});",deps:function(){return[]},provides:{RootModel:c.d}};function f(){return l.a.createElement(c.a,{model:m},l.a.createElement(c.c,{component:"input",label:"\u59d3\u540d",name:"name",required:!0}),l.a.createElement(c.c,{component:"input",label:"\u7535\u8bdd",name:"phone",required:!0}),l.a.createElement(c.c,{component:"input",label:"\u5730\u5740",name:"address"}),l.a.createElement(d.a,null))}var b={filename:"/Users/feichao.sfc/code/github/alibaba/rex-design/packages/story/src/xform/basic-examples.stories.tsx",loc:{start:{line:15,column:7},end:{line:24,column:1}},name:"Basic",value:f,source:'function Basic() {\n  return (\n    <Form model={simpleFormModel}>\n      <FormItem component="input" label="\u59d3\u540d" name="name" required />\n      <FormItem component="input" label="\u7535\u8bdd" name="phone" required />\n      <FormItem component="input" label="\u5730\u5740" name="address" />\n      <ValuePreview />\n    </Form>\n  );\n}',deps:function(){return[p]},provides:{Form:c.a,FormItem:c.c,ValuePreview:d.a}};function y(){return l.a.createElement(c.a,{defaultValue:{name:"\u5c0f\u6cb3\u9a6c",phone:"",address:"\u676d\u5dde\u5e02\u4f59\u676d\u533a\u6587\u4e00\u897f\u8def969\u53f7"},onSubmit:function(e,n){return console.log("onSubmit:",e)},onError:function(e,n){return console.log("onError:",e)},onReset:function(e){return console.log("onReset")}},l.a.createElement(c.c,{component:"input",label:"\u59d3\u540d",name:"name",required:!0}),l.a.createElement(c.c,{component:"input",label:"\u7535\u8bdd",name:"phone",required:!0}),l.a.createElement(c.c,{component:"input",label:"\u5730\u5740",name:"address"}),l.a.createElement(s.Group,{mt:"8px"},l.a.createElement(c.a.Submit,null),l.a.createElement(c.a.Reset,null)))}f.__doc_info=b,f.__inner_source='function Basic() {\n  return (\n    <Form model={simpleFormModel}>\n      <FormItem component="input" label="\u59d3\u540d" name="name" required />\n      <FormItem component="input" label="\u7535\u8bdd" name="phone" required />\n      <FormItem component="input" label="\u5730\u5740" name="address" />\n      <ValuePreview />\n    </Form>\n  );\n}';var h={filename:"/Users/feichao.sfc/code/github/alibaba/rex-design/packages/story/src/xform/basic-examples.stories.tsx",loc:{start:{line:26,column:7},end:{line:48,column:1}},name:"BasicUncontrolled",value:y,source:'function BasicUncontrolled() {\n  return (\n    <Form\n      defaultValue={{\n        name: \'\u5c0f\u6cb3\u9a6c\',\n        phone: \'\',\n        address: \'\u676d\u5dde\u5e02\u4f59\u676d\u533a\u6587\u4e00\u897f\u8def969\u53f7\',\n      }}\n      onSubmit={(values, model) => console.log(\'onSubmit:\', values)}\n      onError={(errors, model) => console.log(\'onError:\', errors)}\n      onReset={(model) => console.log(\'onReset\')}\n    >\n      <FormItem component="input" label="\u59d3\u540d" name="name" required />\n      <FormItem component="input" label="\u7535\u8bdd" name="phone" required />\n      <FormItem component="input" label="\u5730\u5740" name="address" />\n\n      <Group mt="8px">\n        <Form.Submit />\n        <Form.Reset />\n      </Group>\n    </Form>\n  );\n}',deps:function(){return[j]},provides:{Form:c.a,FormItem:c.c,Group:s.Group}};function v(){return l.a.createElement(c.a,null,l.a.createElement(c.c,{component:"input",label:"\u540d\u79f0",name:"foo.bar.buzz",required:!0}),l.a.createElement(d.a,{defaultShow:!0}))}y.__doc_info=h,y.__inner_source='function BasicUncontrolled() {\n  return (\n    <Form\n      defaultValue={{\n        name: \'\u5c0f\u6cb3\u9a6c\',\n        phone: \'\',\n        address: \'\u676d\u5dde\u5e02\u4f59\u676d\u533a\u6587\u4e00\u897f\u8def969\u53f7\',\n      }}\n      onSubmit={(values, model) => console.log(\'onSubmit:\', values)}\n      onError={(errors, model) => console.log(\'onError:\', errors)}\n      onReset={(model) => console.log(\'onReset\')}\n    >\n      <FormItem component="input" label="\u59d3\u540d" name="name" required />\n      <FormItem component="input" label="\u7535\u8bdd" name="phone" required />\n      <FormItem component="input" label="\u5730\u5740" name="address" />\n\n      <Group mt="8px">\n        <Form.Submit />\n        <Form.Reset />\n      </Group>\n    </Form>\n  );\n}';var g={filename:"/Users/feichao.sfc/code/github/alibaba/rex-design/packages/story/src/xform/basic-examples.stories.tsx",loc:{start:{line:50,column:7},end:{line:57,column:1}},name:"NestedField",value:v,source:'function NestedField() {\n  return (\n    <Form>\n      <FormItem component="input" label="\u540d\u79f0" name="foo.bar.buzz" required />\n      <ValuePreview defaultShow />\n    </Form>\n  );\n}',deps:function(){return[]},provides:{Form:c.a,FormItem:c.c,ValuePreview:d.a}};function S(){return l.a.createElement(c.a,null,l.a.createElement(c.c,{component:"input",label:"\u540d\u79f0",name:"\u5546\u54c1\u7f16\u7801",required:!0,componentProps:{placeholder:"\u8bf7\u8f93\u5165\u5546\u54c1\u7f16\u7801"},validate:function(e){var n;return e?"sku1234"!==e.toLowerCase()&&(n="\u53ef\u4ee5\u8f93\u5165 sku1234 \u8bd5\u8bd5"):n="\u8be5\u5b57\u6bb5\u5fc5\u586b",n}}))}v.__doc_info=g,v.__inner_source='function NestedField() {\n  return (\n    <Form>\n      <FormItem component="input" label="\u540d\u79f0" name="foo.bar.buzz" required />\n      <ValuePreview defaultShow />\n    </Form>\n  );\n}';var O={filename:"/Users/feichao.sfc/code/github/alibaba/rex-design/packages/story/src/xform/basic-examples.stories.tsx",loc:{start:{line:59,column:7},end:{line:80,column:1}},name:"Validation",value:S,source:"function Validation() {\n  return (\n    <Form>\n      <FormItem\n        component=\"input\"\n        label=\"\u540d\u79f0\"\n        name=\"\u5546\u54c1\u7f16\u7801\"\n        required\n        componentProps={{ placeholder: '\u8bf7\u8f93\u5165\u5546\u54c1\u7f16\u7801' }}\n        validate={(value) => {\n          let error;\n          if (!value) {\n            error = '\u8be5\u5b57\u6bb5\u5fc5\u586b';\n          } else if (value.toLowerCase() !== 'sku1234') {\n            error = '\u53ef\u4ee5\u8f93\u5165 sku1234 \u8bd5\u8bd5';\n          }\n          return error;\n        }}\n      />\n    </Form>\n  );\n}",deps:function(){return[]},provides:{Form:c.a,FormItem:c.c}};function x(){return l.a.createElement(c.a,{defaultValue:{subsidiary:"\u5317\u4eac",shops:["\u676d\u5dde\u4e1c\u65b0\u4e1c\u8def\u5e97"]}},l.a.createElement(c.a.Effect,{watch:"subsidiary",effect:function(e,n){n.model.setValue("shops",[])}}),l.a.createElement(c.c,{component:"singleSelect",label:"\u5b50\u516c\u53f8 (\u5207\u6362\u5b50\u516c\u53f8\u540e\uff0c\u95e8\u5e97\u5c06\u88ab\u6e05\u7a7a)",name:"subsidiary",componentProps:{dataSource:"\u5317\u4eac\uff0c\u4e0a\u6d77\uff0c\u6d59\u6c5f\uff0c\u5e7f\u5dde".split("\uff0c")}}),l.a.createElement(c.c,{component:"multiSelect",name:"shops",label:"\u95e8\u5e97",componentProps:{hasClear:!0,dataSource:["\u676d\u5dde\u4e1c\u65b0\u4e1c\u8def\u5e97","\u76d2\u9a6c\u676d\u5dde\u89e3\u767e\u5e97","\u676d\u5dde\u4e34\u5e73\u4e2d\u90fd\u5e97","\u676d\u5dde\u4eb2\u6a59\u91cc\u5e97","\u676d\u5dde\u5e86\u6625\u5e97","\u676d\u5dde\u4e0b\u6c99\u94f6\u6cf0\u5e97","\u676d\u5dde\u661f\u5149\u5927\u9053\u5e97","\u676d\u5dde\u897f\u6eaa\u9f99\u6e56\u5e97","\u676d\u5dde\u95f8\u5f04\u53e3\u5e97"]}}),l.a.createElement(d.a,null))}S.__doc_info=O,S.__inner_source="function Validation() {\n  return (\n    <Form>\n      <FormItem\n        component=\"input\"\n        label=\"\u540d\u79f0\"\n        name=\"\u5546\u54c1\u7f16\u7801\"\n        required\n        componentProps={{ placeholder: '\u8bf7\u8f93\u5165\u5546\u54c1\u7f16\u7801' }}\n        validate={(value) => {\n          let error;\n          if (!value) {\n            error = '\u8be5\u5b57\u6bb5\u5fc5\u586b';\n          } else if (value.toLowerCase() !== 'sku1234') {\n            error = '\u53ef\u4ee5\u8f93\u5165 sku1234 \u8bd5\u8bd5';\n          }\n          return error;\n        }}\n      />\n    </Form>\n  );\n}";var _={filename:"/Users/feichao.sfc/code/github/alibaba/rex-design/packages/story/src/xform/basic-examples.stories.tsx",loc:{start:{line:82,column:7},end:{line:122,column:1}},name:"BasicEffect",value:x,source:"function BasicEffect() {\n  return (\n    <Form defaultValue={{ subsidiary: '\u5317\u4eac', shops: ['\u676d\u5dde\u4e1c\u65b0\u4e1c\u8def\u5e97'] }}>\n      <Form.Effect\n        watch=\"subsidiary\"\n        effect={(value, { model }) => {\n          model.setValue('shops', []);\n        }}\n      />\n      <FormItem\n        component=\"singleSelect\"\n        label=\"\u5b50\u516c\u53f8 (\u5207\u6362\u5b50\u516c\u53f8\u540e\uff0c\u95e8\u5e97\u5c06\u88ab\u6e05\u7a7a)\"\n        name=\"subsidiary\"\n        componentProps={{\n          dataSource: '\u5317\u4eac\uff0c\u4e0a\u6d77\uff0c\u6d59\u6c5f\uff0c\u5e7f\u5dde'.split('\uff0c'),\n        }}\n      />\n      <FormItem\n        component=\"multiSelect\"\n        name=\"shops\"\n        label=\"\u95e8\u5e97\"\n        componentProps={{\n          hasClear: true,\n          dataSource: [\n            '\u676d\u5dde\u4e1c\u65b0\u4e1c\u8def\u5e97',\n            '\u76d2\u9a6c\u676d\u5dde\u89e3\u767e\u5e97',\n            '\u676d\u5dde\u4e34\u5e73\u4e2d\u90fd\u5e97',\n            '\u676d\u5dde\u4eb2\u6a59\u91cc\u5e97',\n            '\u676d\u5dde\u5e86\u6625\u5e97',\n            '\u676d\u5dde\u4e0b\u6c99\u94f6\u6cf0\u5e97',\n            '\u676d\u5dde\u661f\u5149\u5927\u9053\u5e97',\n            '\u676d\u5dde\u897f\u6eaa\u9f99\u6e56\u5e97',\n            '\u676d\u5dde\u95f8\u5f04\u53e3\u5e97',\n          ],\n        }}\n      />\n\n      <ValuePreview />\n    </Form>\n  );\n}",deps:function(){return[j]},provides:{Form:c.a,FormItem:c.c,ValuePreview:d.a}};function E(){return l.a.createElement(c.a,{labelPosition:"left"},l.a.createElement("div",{style:{border:"1px dashed #ccc",padding:8}},l.a.createElement("p",{style:{marginBottom:8,fontWeight:"bold"}},"\u5546\u54c1\u53c2\u6570"),l.a.createElement(c.c,{component:"input",label:"SKU code",name:"sku.code",required:!0}),l.a.createElement(c.c,{component:"input",label:"SKU \u540d\u79f0",name:"sku.name"})),l.a.createElement("div",{style:{marginTop:12,border:"1px dashed #ccc",padding:8}},l.a.createElement("p",{style:{marginBottom:8,fontWeight:"bold"}},"\u67e5\u8be2\u53c2\u6570"),l.a.createElement(c.c,{component:"datePicker",label:"\u67e5\u8be2\u65e5\u671f",name:"date.current",defaultValue:Object(s.dayjs)().format("YYYY-MM-DD"),componentProps:{format:"YYYY-MM-DD"}}),l.a.createElement(c.c,{component:"datePicker",label:"\u5bf9\u6bd4\u65e5\u671f",name:"date.compare",defaultValue:Object(s.dayjs)().subtract(1,"day").format("YYYY-MM-DD"),componentProps:{format:"YYYY-MM-DD"}})),l.a.createElement(d.a,null))}x.__doc_info=_,x.__inner_source="function BasicEffect() {\n  return (\n    <Form defaultValue={{ subsidiary: '\u5317\u4eac', shops: ['\u676d\u5dde\u4e1c\u65b0\u4e1c\u8def\u5e97'] }}>\n      <Form.Effect\n        watch=\"subsidiary\"\n        effect={(value, { model }) => {\n          model.setValue('shops', []);\n        }}\n      />\n      <FormItem\n        component=\"singleSelect\"\n        label=\"\u5b50\u516c\u53f8 (\u5207\u6362\u5b50\u516c\u53f8\u540e\uff0c\u95e8\u5e97\u5c06\u88ab\u6e05\u7a7a)\"\n        name=\"subsidiary\"\n        componentProps={{\n          dataSource: '\u5317\u4eac\uff0c\u4e0a\u6d77\uff0c\u6d59\u6c5f\uff0c\u5e7f\u5dde'.split('\uff0c'),\n        }}\n      />\n      <FormItem\n        component=\"multiSelect\"\n        name=\"shops\"\n        label=\"\u95e8\u5e97\"\n        componentProps={{\n          hasClear: true,\n          dataSource: [\n            '\u676d\u5dde\u4e1c\u65b0\u4e1c\u8def\u5e97',\n            '\u76d2\u9a6c\u676d\u5dde\u89e3\u767e\u5e97',\n            '\u676d\u5dde\u4e34\u5e73\u4e2d\u90fd\u5e97',\n            '\u676d\u5dde\u4eb2\u6a59\u91cc\u5e97',\n            '\u676d\u5dde\u5e86\u6625\u5e97',\n            '\u676d\u5dde\u4e0b\u6c99\u94f6\u6cf0\u5e97',\n            '\u676d\u5dde\u661f\u5149\u5927\u9053\u5e97',\n            '\u676d\u5dde\u897f\u6eaa\u9f99\u6e56\u5e97',\n            '\u676d\u5dde\u95f8\u5f04\u53e3\u5e97',\n          ],\n        }}\n      />\n\n      <ValuePreview />\n    </Form>\n  );\n}";var F={filename:"/Users/feichao.sfc/code/github/alibaba/rex-design/packages/story/src/xform/basic-examples.stories.tsx",loc:{start:{line:124,column:7},end:{line:153,column:1}},name:"InnerLayout",value:E,source:'function InnerLayout() {\n  return (\n    <Form labelPosition="left">\n      <div style={{ border: \'1px dashed #ccc\', padding: 8 }}>\n        <p style={{ marginBottom: 8, fontWeight: \'bold\' }}>\u5546\u54c1\u53c2\u6570</p>\n        <FormItem component="input" label="SKU code" name="sku.code" required />\n        <FormItem component="input" label="SKU \u540d\u79f0" name="sku.name" />\n      </div>\n\n      <div style={{ marginTop: 12, border: \'1px dashed #ccc\', padding: 8 }}>\n        <p style={{ marginBottom: 8, fontWeight: \'bold\' }}>\u67e5\u8be2\u53c2\u6570</p>\n        <FormItem\n          component="datePicker"\n          label="\u67e5\u8be2\u65e5\u671f"\n          name="date.current"\n          defaultValue={dayjs().format(\'YYYY-MM-DD\')}\n          componentProps={{ format: \'YYYY-MM-DD\' }}\n        />\n        <FormItem\n          component="datePicker"\n          label="\u5bf9\u6bd4\u65e5\u671f"\n          name="date.compare"\n          defaultValue={dayjs().subtract(1, \'day\').format(\'YYYY-MM-DD\')}\n          componentProps={{ format: \'YYYY-MM-DD\' }}\n        />\n      </div>\n      <ValuePreview />\n    </Form>\n  );\n}',deps:function(){return[]},provides:{Form:c.a,FormItem:c.c,dayjs:s.dayjs,ValuePreview:d.a}};E.__doc_info=F,E.__inner_source='function InnerLayout() {\n  return (\n    <Form labelPosition="left">\n      <div style={{ border: \'1px dashed #ccc\', padding: 8 }}>\n        <p style={{ marginBottom: 8, fontWeight: \'bold\' }}>\u5546\u54c1\u53c2\u6570</p>\n        <FormItem component="input" label="SKU code" name="sku.code" required />\n        <FormItem component="input" label="SKU \u540d\u79f0" name="sku.name" />\n      </div>\n\n      <div style={{ marginTop: 12, border: \'1px dashed #ccc\', padding: 8 }}>\n        <p style={{ marginBottom: 8, fontWeight: \'bold\' }}>\u67e5\u8be2\u53c2\u6570</p>\n        <FormItem\n          component="datePicker"\n          label="\u67e5\u8be2\u65e5\u671f"\n          name="date.current"\n          defaultValue={dayjs().format(\'YYYY-MM-DD\')}\n          componentProps={{ format: \'YYYY-MM-DD\' }}\n        />\n        <FormItem\n          component="datePicker"\n          label="\u5bf9\u6bd4\u65e5\u671f"\n          name="date.compare"\n          defaultValue={dayjs().subtract(1, \'day\').format(\'YYYY-MM-DD\')}\n          componentProps={{ format: \'YYYY-MM-DD\' }}\n        />\n      </div>\n      <ValuePreview />\n    </Form>\n  );\n}';var C=new c.d({name:"\u5c0f\u6cb3\u9a6c",phone:"",address:"\u676d\u5dde\u5e02\u4f59\u676d\u533a\u6587\u4e00\u897f\u8def969\u53f7",idType:"id"}),j={filename:"/Users/feichao.sfc/code/github/alibaba/rex-design/packages/story/src/xform/basic-examples.stories.tsx",loc:{start:{line:155,column:0},end:{line:160,column:3}},name:"model",value:C,source:"const model = new RootModel({\n  name: '\u5c0f\u6cb3\u9a6c',\n  phone: '',\n  address: '\u676d\u5dde\u5e02\u4f59\u676d\u533a\u6587\u4e00\u897f\u8def969\u53f7',\n  idType: 'id',\n});",deps:function(){return[]},provides:{RootModel:c.d}};function w(){return l.a.createElement("div",null,l.a.createElement("div",{style:{display:"flex",gap:8,marginBottom:12}},l.a.createElement(s.Button,{onClick:function(){return c.g.validateAll(C)}},"\u6821\u9a8c\u5168\u90e8"),l.a.createElement(s.Button,{onClick:function(){return c.g.clearError(C)}},"\u6e05\u7a7a\u9519\u8bef"),l.a.createElement(s.Button,{onClick:Object(u.action)((function(){C.values={},c.g.clearError(C)}))},"\u91cd\u7f6e\u8868\u5355")),l.a.createElement(c.a,{model:C},l.a.createElement(c.c,{component:"input",label:"\u59d3\u540d",name:"name",required:!0}),l.a.createElement(c.c,{component:"input",label:"\u7535\u8bdd",name:"phone",required:!0}),l.a.createElement(c.c,{component:"input",label:"\u5730\u5740",name:"address"}),l.a.createElement(d.a,null)))}var R={filename:"/Users/feichao.sfc/code/github/alibaba/rex-design/packages/story/src/xform/basic-examples.stories.tsx",loc:{start:{line:162,column:7},end:{line:186,column:1}},name:"WithActions",value:w,source:'function WithActions() {\n  return (\n    <div>\n      <div style={{ display: \'flex\', gap: 8, marginBottom: 12 }}>\n        <Button onClick={() => modelUtils.validateAll(model)}>\u6821\u9a8c\u5168\u90e8</Button>\n        <Button onClick={() => modelUtils.clearError(model)}>\u6e05\u7a7a\u9519\u8bef</Button>\n        <Button\n          onClick={action(() => {\n            model.values = {} ;\n            modelUtils.clearError(model);\n          })}\n        >\n          \u91cd\u7f6e\u8868\u5355\n        </Button>\n      </div>\n\n      <Form model={model}>\n        <FormItem component="input" label="\u59d3\u540d" name="name" required />\n        <FormItem component="input" label="\u7535\u8bdd" name="phone" required />\n        <FormItem component="input" label="\u5730\u5740" name="address" />\n        <ValuePreview />\n      </Form>\n    </div>\n  );\n}',deps:function(){return[j]},provides:{Button:s.Button,modelUtils:c.g,action:u.action,Form:c.a,FormItem:c.c,ValuePreview:d.a}};w.__inner_source='function WithActions() {\n  return (\n    <div>\n      <div style={{ display: \'flex\', gap: 8, marginBottom: 12 }}>\n        <Button onClick={() => modelUtils.validateAll(model)}>\u6821\u9a8c\u5168\u90e8</Button>\n        <Button onClick={() => modelUtils.clearError(model)}>\u6e05\u7a7a\u9519\u8bef</Button>\n        <Button\n          onClick={action(() => {\n            model.values = {} ;\n            modelUtils.clearError(model);\n          })}\n        >\n          \u91cd\u7f6e\u8868\u5355\n        </Button>\n      </div>\n\n      <Form model={model}>\n        <FormItem component="input" label="\u59d3\u540d" name="name" required />\n        <FormItem component="input" label="\u7535\u8bdd" name="phone" required />\n        <FormItem component="input" label="\u5730\u5740" name="address" />\n        <ValuePreview />\n      </Form>\n    </div>\n  );\n}',w.__doc_info=R;var A,V={id:"usage",title:"xform"},I={unversionedId:"xform/usage",id:"xform/usage",isDocsHomePage:!1,title:"xform",description:"@rexd/xform\uff1a \u4e00\u4e2a\u57fa\u4e8e mobx \u7684\u8868\u5355\u65b9\u6848\u3002",source:"@site/docs/xform/usage.mdx",sourceDirName:"xform",slug:"/xform/usage",permalink:"/rex-design/docs/xform/usage",editUrl:"https://github.com/alibaba/rex-design/edit/main/packages/doc/docs/xform/usage.mdx",version:"current",frontMatter:{id:"usage",title:"xform"},sidebar:"docs",previous:{title:"CrossTreeTable \u4ea4\u53c9\u6811\u72b6\u8868\u683c",permalink:"/rex-design/docs/cross-tree-table"},next:{title:"xform \u8fdb\u9636",permalink:"/rex-design/docs/xform/advanced"}},T=[{value:"\u7279\u70b9",id:"\u7279\u70b9",children:[{value:"\u5b57\u6bb5\u9650\u5236",id:"\u5b57\u6bb5\u9650\u5236",children:[]}]},{value:"\u5f00\u59cb\u4f7f\u7528",id:"\u5f00\u59cb\u4f7f\u7528",children:[]},{value:"\u793a\u4f8b",id:"\u793a\u4f8b",children:[{value:"\u57fa\u672c\u793a\u4f8b",id:"\u57fa\u672c\u793a\u4f8b",children:[]},{value:"\u975e\u53d7\u63a7\u7528\u6cd5",id:"\u975e\u53d7\u63a7\u7528\u6cd5",children:[]},{value:"\u5d4c\u5957\u5b57\u6bb5",id:"\u5d4c\u5957\u5b57\u6bb5",children:[]},{value:"\u5b57\u6bb5\u6821\u9a8c",id:"\u5b57\u6bb5\u6821\u9a8c",children:[]},{value:"\u8054\u52a8",id:"\u8054\u52a8",children:[]},{value:"\u81ea\u5b9a\u4e49\u5e03\u5c40",id:"\u81ea\u5b9a\u4e49\u5e03\u5c40",children:[]},{value:"\u5bf9\u8868\u5355\u8fdb\u884c\u64cd\u4f5c",id:"\u5bf9\u8868\u5355\u8fdb\u884c\u64cd\u4f5c",children:[]}]},{value:"API",id:"api",children:[]}],k=(A="Story",function(e){return console.warn("Component "+A+" was not imported, exported, or provided by MDXProvider as global scope"),Object(i.b)("div",e)}),B={toc:T};function M(e){var n=e.components,t=Object(o.a)(e,["components"]);return Object(i.b)("wrapper",Object(r.a)({},B,t,{components:n,mdxType:"MDXLayout"}),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"@rexd/xform"),"\uff1a \u4e00\u4e2a\u57fa\u4e8e mobx \u7684\u8868\u5355\u65b9\u6848\u3002"),Object(i.b)("h2",{id:"\u7279\u70b9"},"\u7279\u70b9"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"\u4e0a\u624b\u7b80\u5355\uff0c\u642d\u914d mobx \u53ef\u4ee5\u8fdb\u884c\u5feb\u901f\u5f00\u53d1"),Object(i.b)("li",{parentName:"ul"},"\u7cbe\u786e\u6e32\u67d3\uff0c\u8f7b\u677e\u5e94\u5bf9\u5927\u8868\u5355\u573a\u666f"),Object(i.b)("li",{parentName:"ul"},Object(i.b)("strong",{parentName:"li"},"\u91cd\u5ea6\u4f9d\u8d56 ",Object(i.b)("a",{parentName:"strong",href:"https://mobx.js.org/"},"mobx"),"\uff0c\u7ee7\u627f mobx \u7684\u4f18\u7f3a\u70b9"),Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},"\u8868\u5355\u5185\u6838\u91c7\u7528 mobx \u63d0\u4f9b\u7684\u6570\u636e\u7ed3\u6784\uff0c\u65e0\u7f1d\u5bf9\u63a5 mobx \u751f\u6001"))),Object(i.b)("li",{parentName:"ul"},"\u6982\u5ff5\u8f83\u5c11\uff0c\u5b66\u4e60\u6210\u672c\u4f4e")),Object(i.b)("h3",{id:"\u5b57\u6bb5\u9650\u5236"},"\u5b57\u6bb5\u9650\u5236"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"\u5b57\u6bb5\u540d\u79f0\u4e0d\u80fd\u5305\u542b ",Object(i.b)("inlineCode",{parentName:"li"},".")),Object(i.b)("li",{parentName:"ul"},"\u5b57\u6bb5\u540d\u79f0\u4e0d\u80fd\u4e3a ",Object(i.b)("inlineCode",{parentName:"li"},"&"))),Object(i.b)("h2",{id:"\u5f00\u59cb\u4f7f\u7528"},"\u5f00\u59cb\u4f7f\u7528"),Object(i.b)("p",null,"\u5728\u4f7f\u7528\u8868\u5355\u4e4b\u524d\uff0c\u6211\u4eec\u9700\u8981\u5148\u521b\u5efa\u4e00\u4e2a Model \u5bf9\u8c61\uff0c\u7136\u540e\u5c06\u5176\u4f20\u9012\u7ed9 Form \u7ec4\u4ef6\u7684 props.model\u3002"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-jsx"},'import { Form, FormItem, RootModel } from \'@rexd/xform\';\n\n// step1 \u521b\u5efa\u8868\u5355\u6a21\u578b\nconst model = new RootModel({\n  name: \'\u5c0f\u6cb3\u9a6c\',\n  phone: \'188-8888-8888\',\n  address: \'\u676d\u5dde\u5e02\u4f59\u676d\u533a\u6587\u4e00\u897f\u8def969\u53f7\',\n});\n\n// step2 \u4f7f\u7528\nexport function Basic() {\n  return (\n    <Form model={model}>\n      <FormItem component="input" label="\u59d3\u540d" name="name" required />\n      <FormItem component="input" label="\u7535\u8bdd" name="phone" required />\n      <FormItem component="input" label="\u5730\u5740" name="address" />\n    </Form>\n  );\n}\n')),Object(i.b)("p",null,"\u5982\u679c\u4f60\u4f7f\u7528 mobx \u7ba1\u7406\u5e94\u7528\u72b6\u6001\uff0c\u90a3\u4e48\u53ef\u4ee5\u5728 store \u4e2d\u521b\u5efa model \u5bf9\u8c61\uff1a"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-jsx"},"import { observable, computed, makeObservable } from 'mobx';\nimport { RootModel } from '@rexd/xform';\n\nclass Store {\n  @observable\n  model = new RootModel({\n    name: '\u5c0f\u6cb3\u9a6c',\n    phone: '188-8888-8888',\n    address: '\u676d\u5dde\u5e02\u4f59\u676d\u533a\u6587\u4e00\u897f\u8def969\u53f7',\n  });\n\n  @computed\n  get formValues() {\n    return model.values;\n  }\n\n  constructor() {\n    makeObservable(this);\n  }\n}\n")),Object(i.b)("h2",{id:"\u793a\u4f8b"},"\u793a\u4f8b"),Object(i.b)("h3",{id:"\u57fa\u672c\u793a\u4f8b"},"\u57fa\u672c\u793a\u4f8b"),Object(i.b)(k,{fn:f,mdxType:"Story"}),Object(i.b)("h3",{id:"\u975e\u53d7\u63a7\u7528\u6cd5"},"\u975e\u53d7\u63a7\u7528\u6cd5"),Object(i.b)("p",null,"xform \u652f\u6301\u975e\u53d7\u63a7\u7528\u6cd5\uff0c\u6b64\u65f6\u6211\u4eec\u7528 ",Object(i.b)("inlineCode",{parentName:"p"},"defaultValue")," \u6765\u8bbe\u7f6e\u8868\u5355\u7684\u521d\u59cb\u503c\uff0c\u5e76\u914d\u5408 ",Object(i.b)("inlineCode",{parentName:"p"},"<Form.Submit />")," \u548c ",Object(i.b)("inlineCode",{parentName:"p"},"onSubmit()")," \u56de\u8c03\u6765\u5b9e\u73b0\u8868\u5355\u903b\u8f91\u3002"),Object(i.b)(k,{fn:y,mdxType:"Story"}),Object(i.b)("h3",{id:"\u5d4c\u5957\u5b57\u6bb5"},"\u5d4c\u5957\u5b57\u6bb5"),Object(i.b)("p",null,"\u652f\u6301\u4f7f\u7528 ",Object(i.b)("inlineCode",{parentName:"p"},'name="foo.bar.buzz"')," \u7684\u5f62\u5f0f\u6765\u58f0\u660e\u4f7f\u7528\u5d4c\u5957\u7684\u5bf9\u8c61\u3002"),Object(i.b)(k,{fn:v,mdxType:"Story"}),Object(i.b)("h3",{id:"\u5b57\u6bb5\u6821\u9a8c"},"\u5b57\u6bb5\u6821\u9a8c"),Object(i.b)("p",null,"\u652f\u6301\u4f7f\u7528 ",Object(i.b)("inlineCode",{parentName:"p"},"validate={ value => error }")," \u8fdb\u884c\u7b80\u5355\u7684\u6821\u9a8c\u3002"),Object(i.b)(k,{fn:S,mdxType:"Story"}),Object(i.b)("h3",{id:"\u8054\u52a8"},"\u8054\u52a8"),Object(i.b)("p",null,"\u4f7f\u7528 ",Object(i.b)("inlineCode",{parentName:"p"},"<Form.Effect watch={watch} effect={effect} />")," \u540e\uff0c\u6bcf\u5f53 ",Object(i.b)("inlineCode",{parentName:"p"},"watch")," \u5bf9\u5e94\u7684\u503c\u53d1\u751f\u53d8\u5316\u65f6\uff0ceffect \u90fd\u4f1a\u88ab\u8c03\u7528\uff0c\u4f60\u53ef\u4ee5\u7531\u6b64\u6765\u521b\u5efa\u7b80\u5355\u7684\u8054\u52a8\u3002"),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"effect()")," \u88ab\u8c03\u7528\u65f6\uff0c\u53ef\u4ee5\u83b7\u53d6\u5230\u4e24\u4e2a\u53c2\u6570\uff1a"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"value: any"),": \u65b0\u7684\u503c"),Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"detail: { prev: any, model: IModel, next: any }")," \u5305\u542b\u65e7\u7684\u503c\uff0c\u65b0\u7684\u503c\uff0c\u4ee5\u53ca\u5f53\u524d\u6a21\u578b\u7684\u4e00\u4e2a\u5bf9\u8c61")),Object(i.b)(k,{fn:x,mdxType:"Story"}),Object(i.b)("h3",{id:"\u81ea\u5b9a\u4e49\u5e03\u5c40"},"\u81ea\u5b9a\u4e49\u5e03\u5c40"),Object(i.b)("p",null,"FormItem \u4e0e\u666e\u901a\u5143\u7d20\uff08div\uff0cp\uff0cspan\uff09\u4e00\u8d77\u4f7f\u7528\uff0c\u5b9e\u73b0\u81ea\u5b9a\u4e49\u7684\u8868\u5355\u5185\u5e03\u5c40\u3002"),Object(i.b)(k,{fn:E,mdxType:"Story"}),Object(i.b)("h3",{id:"\u5bf9\u8868\u5355\u8fdb\u884c\u64cd\u4f5c"},"\u5bf9\u8868\u5355\u8fdb\u884c\u64cd\u4f5c"),Object(i.b)("p",null,"modelUtils \u63d0\u4f9b\u4e86\u4e00\u4e9b\u9488\u5bf9 model \u7684\u5de5\u5177\u65b9\u6cd5\uff0c\u4f8b\u5982 \u6279\u91cf\u6821\u9a8c ",Object(i.b)("inlineCode",{parentName:"p"},"validateAll"),"\uff0c\u6e05\u9664\u9519\u8bef ",Object(i.b)("inlineCode",{parentName:"p"},"clearError")," \u7b49\u3002"),Object(i.b)("p",null,"fieldUtils \u63d0\u4f9b\u4e86\u4e00\u4e9b\u9488\u5bf9 field \u7684\u5de5\u5177\uff0c\u4f8b\u5982 validate \u7b49\u3002 \u5177\u4f53 API \u8be6\u89c1 ",Object(i.b)("a",{parentName:"p",href:"api"},"xform API"),"."),Object(i.b)("p",null,"\u5f15\u5165\u65b9\u5f0f\uff1a ",Object(i.b)("inlineCode",{parentName:"p"},"import { modelUtils, fieldUtils } from '@rexd/xform';")),Object(i.b)(k,{fn:w,mdxType:"Story"}),Object(i.b)("h2",{id:"api"},"API"),Object(i.b)("p",null,"\u8be6\u89c1 ",Object(i.b)("a",{parentName:"p",href:"api"},"xform API"),"."))}M.isMDXComponent=!0},213:function(e,n,t){"use strict";t.d(n,"h",(function(){return E})),t.d(n,"b",(function(){return x})),t.d(n,"d",(function(){return V})),t.d(n,"a",(function(){return N})),t.d(n,"c",(function(){return z})),t.d(n,"e",(function(){return W})),t.d(n,"f",(function(){return $})),t.d(n,"g",(function(){return M}));var r=t(170),o=t(173),a=t(0),l=t.n(a),i=t(220),c=t.n(i);function s(e){e.subModels.forEach((function(e,n){e.name=String(n)}))}function u(e,n,t){if(null!=e){var r=e[n];e[n]=e[t],e[t]=r}}function d(e){return String(Number.parseInt(e))===e}function m(e){return d(e)?"array":"object"}function p(e,n,t){for(var o=Array.isArray(n)?n:h(n),a=e,l=0;l<o.length;l+=1){if(!r.isObservable(a))return t;a=r.get(a,o[l])}return void 0===a?t:a}function f(e,n,t){for(var o=Array.isArray(n)?n:h(n),a=o.length-1,l=e,i=0;i<a;i+=1){var c=o[i];if(null==r.get(l,c)&&(d(o[i+1])?r.set(l,c,[]):r.set(l,c,{})),l=r.get(l,c),!r.isObservable(l))return}r.isObservable(l)&&r.set(l,o[a],t)}var b={append:Object(r.action)((function(e,n){var t;null==e.values&&(e.values=[]),e.values.push(null!==(t=null==n?void 0:n(e))&&void 0!==t?t:{})})),delete:Object(r.action)((function(e,n){e.values.splice(n,1),c()(Array.isArray(e._proxy.subModels),"arrayModel.subModels should be Array or observable.array"),e._proxy.subModels.splice(n,1),s(e._proxy)})),moveUp:Object(r.action)((function(e,n){0!==n&&(u(e.values,n,n-1),c()(Array.isArray(e._proxy.subModels),"arrayModel.attachedSubModels should be Array or observable.array"),u(e._proxy.subModels,n,n-1),s(e._proxy))})),moveDown:Object(r.action)((function(e,n){n!==e.values.length-1&&(u(e.values,n,n+1),c()(Array.isArray(e._proxy.subModels),"arrayModel.attachedSubModels should be Array or observable.array"),u(e._proxy.subModels,n,n+1),s(e._proxy))})),renderArrayItem:function(e,n,t){return l.a.createElement(C,{name:String(n)},t)},getKey:function(e,n){return e.getSubModel(String(n)).id}};function y(e,n){return void 0!==e?e:n}function h(e){return e.split(".")}try{m.displayName="keyToValueShape",m.__docgenInfo={description:"",displayName:"keyToValueShape",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/core/utils.tsx#keyToValueShape"]={docgenInfo:m.__docgenInfo,name:"keyToValueShape",path:"../xform/src/core/utils.tsx#keyToValueShape"})}catch(Q){}try{p.displayName="observableGetIn",p.__docgenInfo={description:"lodash.get(...) for mobx observables",displayName:"observableGetIn",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/core/utils.tsx#observableGetIn"]={docgenInfo:p.__docgenInfo,name:"observableGetIn",path:"../xform/src/core/utils.tsx#observableGetIn"})}catch(Q){}try{f.displayName="observableSetIn",f.__docgenInfo={description:"lodash.set(...) for mobx observables",displayName:"observableSetIn",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/core/utils.tsx#observableSetIn"]={docgenInfo:f.__docgenInfo,name:"observableSetIn",path:"../xform/src/core/utils.tsx#observableSetIn"})}catch(Q){}try{y.displayName="composeState",y.__docgenInfo={description:"\u5408\u5e76\u53d7\u63a7\u72b6\u6001\u548c \u975e\u53d7\u63a7\u72b6\u6001",displayName:"composeState",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/core/utils.tsx#composeState"]={docgenInfo:y.__docgenInfo,name:"composeState",path:"../xform/src/core/utils.tsx#composeState"})}catch(Q){}try{h.displayName="splitToPath",h.__docgenInfo={description:"",displayName:"splitToPath",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/core/utils.tsx#splitToPath"]={docgenInfo:h.__docgenInfo,name:"splitToPath",path:"../xform/src/core/utils.tsx#splitToPath"})}catch(Q){}var v=function(e,n){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)n.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(t[r[o]]=e[r[o]])}return t},g=l.a.createContext(null),S=g.Provider,O=l.a.createContext({}),x=function(e){var n=e.children,t=v(e,["children"]),r=_();return l.a.createElement(O.Provider,{value:Object.assign(Object.assign({},r),t)},n)};function _(){return Object(a.useContext)(O)}function E(){return Object(a.useContext)(g)}var F=Object(o.c)((function(e){var n,t,r=e.name,o=e.children,a=e.layout,i=e.itemFactory,c=E();if("&"===r)throw new Error("XFormArray \u4e0d\u652f\u6301 name=&. path=("+(c.path.join(".")||"root")+")");var s=c.getSubArray(r),u=null!==(t=null===(n=s.values)||void 0===n?void 0:n.length)&&void 0!==t?t:0;return l.a.createElement(S,{value:s},a({arrayModel:s,itemCount:u,itemContent:o,itemFactory:i}))})),C=Object(o.c)((function(e){var n=e.name,t=e.children,r=E();return"&"===n?l.a.createElement(l.a.Fragment,null,t):l.a.createElement(S,{value:r.getSubModel(n),children:t})})),j=Object(o.c)((function(e){var n=e.name,t=e.required,o=e.children,a=e.defaultValue,l=E(),i=Object(r.computed)((function(){return"&"===n?l._asField():l.getField(n)})).get();i._useTrack(e);var c=y(i.value,a);return o({model:l,name:n,field:i,value:c,required:t,defaultValue:a})}));try{S.displayName="ModelProvider",S.__docgenInfo={description:"",displayName:"ModelProvider",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/core/components.tsx#ModelProvider"]={docgenInfo:S.__docgenInfo,name:"ModelProvider",path:"../xform/src/core/components.tsx#ModelProvider"})}catch(Q){}try{x.displayName="FormEnvProvider",x.__docgenInfo={description:"",displayName:"FormEnvProvider",props:{isPreview:{defaultValue:null,description:"",name:"isPreview",required:!1,type:{name:"boolean"}},onSubmit:{defaultValue:null,description:"",name:"onSubmit",required:!1,type:{name:"(submitValues: any, model: RootModel<unknown>) => void"}},onError:{defaultValue:null,description:"",name:"onError",required:!1,type:{name:"(errors: any, model: RootModel<unknown>) => void"}},onReset:{defaultValue:null,description:"",name:"onReset",required:!1,type:{name:"(model: RootModel<unknown>) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/core/components.tsx#FormEnvProvider"]={docgenInfo:x.__docgenInfo,name:"FormEnvProvider",path:"../xform/src/core/components.tsx#FormEnvProvider"})}catch(Q){}try{F.displayName="XFormArray",F.__docgenInfo={description:"\u5bf9\u8c61\u6570\u7ec4\u8868\u5355",displayName:"XFormArray",props:{name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"string"}},layout:{defaultValue:null,description:"",name:"layout",required:!0,type:{name:"(input: XFormArrayLayoutInput) => ReactElement<any, string | JSXElementConstructor<any>>"}},itemFactory:{defaultValue:null,description:"",name:"itemFactory",required:!1,type:{name:"(arrayModel: Model<unknown[]>) => any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/core/components.tsx#XFormArray"]={docgenInfo:F.__docgenInfo,name:"XFormArray",path:"../xform/src/core/components.tsx#XFormArray"})}catch(Q){}try{C.displayName="XFormObject",C.__docgenInfo={description:"\u4e3a\u8be5\u7ec4\u4ef6\u4e0b\u7684 XFormField \u6dfb\u52a0\u4e00\u4e2a\u6570\u636e\u5b57\u6bb5\u524d\u7f00",displayName:"XFormObject",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/core/components.tsx#XFormObject"]={docgenInfo:C.__docgenInfo,name:"XFormObject",path:"../xform/src/core/components.tsx#XFormObject"})}catch(Q){}try{j.displayName="XFormField",j.__docgenInfo={description:"\u8868\u5355\u5b57\u6bb5\uff08field\uff09\n\n\u5728 xform \u4e2d\uff0c\u4e00\u4e2a\u300c\u5b57\u6bb5\u300d\u5305\u542b\u4e00\u4e2a\u300c\u89c6\u56fe\u63a7\u4ef6\u5b9e\u4f8b\u300d\uff08\u4f8b\u5982 Input\uff0cSelect \u5b9e\u4f8b\uff09\u548c\u4e00\u4efd\u72b6\u6001\uff08\u4f8b\u5982 Input \u5305\u542b\u4e00\u4e2a\u5b57\u7b26\u4e32\u72b6\u6001\uff09\uff1b\nXFormField \u662f\u4e00\u4e2a\u9ad8\u9636\u7ec4\u4ef6 / \u57fa\u7840\u7ec4\u4ef6\uff0c\u6bcf\u4e2a\u5177\u4f53\u7684\u7ec4\u4ef6\u7c7b\u578b\uff08\u4f8b\u5982 Input\uff0cSelect \uff09\u90fd\u5e94\u8be5\u7ee7\u627f\u8be5\u7ec4\u4ef6\u5e76\u5c01\u88c5\u76f8\u5e94\u7684 FieldItem\uff1b",displayName:"XFormField",props:{name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"string"}},label:{defaultValue:null,description:"",name:"label",required:!1,type:{name:"ReactNode"}},validate:{defaultValue:null,description:"",name:"validate",required:!1,type:{name:"(value: any) => any"}},required:{defaultValue:null,description:"",name:"required",required:!1,type:{name:"boolean"}},defaultValue:{defaultValue:null,description:"",name:"defaultValue",required:!1,type:{name:"any"}},isEmpty:{defaultValue:null,description:"",name:"isEmpty",required:!0,type:{name:"(value: any) => boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/core/components.tsx#XFormField"]={docgenInfo:j.__docgenInfo,name:"XFormField",path:"../xform/src/core/components.tsx#XFormField"})}catch(Q){}var w=t(221),R=function(){function e(e,n){this.fieldMap=new Map,this.model=e,this.valueShape=n,this.subModels="array"===n?[]:{}}var n=e.prototype;return n.iterateModels=function(e){!function n(t){Object.values(t.subModels).forEach((function(t){e(t),n(t._proxy)}))}(this)},n.iterateFields=function(e){this.fieldMap.forEach(e),this.iterateModels((function(n){n._proxy.fieldMap.forEach(e)}))},n.getSubModel=function(e,n){void 0===n&&(n="object");for(var t=Array.isArray(e)?e:h(e),r=this.model,o=0;o<t.length-1;o++)r=r._proxy._getSubModel(t[o],m(t[o+1]));return r._proxy._getSubModel(t[t.length-1],n)},n._getSubModel=function(e,n){void 0===n&&(n="object"),c()(!e.includes("."),"name \u4e2d\u4e0d\u80fd\u5305\u542b .");var t=this.subModels[e];return null==t&&(t=new I(this.model,e,n),this.subModels[e]=t),t},n.getField=function(e){var n=Array.isArray(e)?e:h(e);if(n.length>1)return this.getSubModel(n[0],m(n[1])).getField(n.slice(1));var t=n[0],r=this.fieldMap.get(t);return null==r&&(r=new T(this.model,t),this.fieldMap.set(t,r)),r},e}(),A=[],V=function(){function e(e){void 0===e&&(e={}),this._nextModelId=1,this._nextFieldId=1,this.state={},this.root=this,this.parent=this,this.path=A,this.valueShape="object",this._proxy=new R(this,"object"),this.values=e,Object(r.makeObservable)(this,{values:r.observable,state:r.observable,setValue:r.action})}var n=e.prototype;return n.getNextModelId=function(){return"Model_"+this._nextModelId++},n.getNextFieldId=function(){return"Field_"+this._nextFieldId++},n.getValue=function(e,n){return p(this.values,e,n)},n.setValue=function(e,n){f(this.values,e,n)},n.getSubModel=function(e){return this._proxy.getSubModel(e,"object")},n.getSubArray=function(e){return this._proxy.getSubModel(e,"array")},n.getField=function(e){return this._proxy.getField(e)},n._asField=function(){throw new Error("RootModel \u4e0b\u4e0d\u652f\u6301\u4f7f\u7528 name=& \u7684 Field")},e}(),I=function(){function e(e,n,t){this.state={},c()(!n.includes("."),"name \u4e2d\u4e0d\u80fd\u5305\u542b ."),this.root=e.root,this.parent=e,this.name=n,this.valueShape=t,this._proxy=new R(this,t),this.id=this.root.getNextModelId(),Object(r.makeObservable)(this,{values:r.computed,state:r.observable,setValue:r.action,name:r.observable},{name:this.id+"("+this.name+")"})}var n=e.prototype;return n.getSubModel=function(e){return this._proxy.getSubModel(e,"object")},n.getSubArray=function(e){return this._proxy.getSubModel(e,"array")},n.getField=function(e){return this._proxy.getField(e)},n.getValue=function(e,n){return p(this.values,e,n)},n.setValue=function(e,n){null==this.values&&(this.values="array"===this.valueShape?[]:{}),f(this.values,e,n)},n._asField=function(){return this.parent.getField(this.name)},Object(w.a)(e,[{key:"path",get:function(){return[].concat(this.parent.path,[this.name])}},{key:"values",get:function(){return this.parent.getValue(this.name)},set:function(e){this.parent.setValue(this.name,e)}}]),e}(),T=function(){function e(e,n){this.config=null,this.mountCount=0,this.state={},this.parent=e,this.name=n,this.id=this.parent.root.getNextFieldId(),Object(r.makeObservable)(this,{state:r.observable,name:r.observable.ref,value:r.computed,path:r.computed,config:!1,mountCount:!1},{name:this.id+"("+this.name+")"})}return e.prototype._useTrack=function(e){var n=this;Object(a.useLayoutEffect)((function(){return n.config=e,n.mountCount+=1,function(){n.config=null,n.mountCount-=1}}),[e])},Object(w.a)(e,[{key:"value",get:function(){return this.parent.getValue(this.name)},set:function(e){this.parent.setValue(this.name,e)}},{key:"path",get:function(){return this.parent.path.concat([this.name])}}]),e}(),k=t(163),B={validate:Object(r.action)((function(e){if(null!=e.config){var n,t=e.config,r=t.validate,o=t.required,a=t.defaultValue,l=t.isEmpty,i=e.value;return n=o&&l(i)?"\u8be5\u5b57\u6bb5\u662f\u5fc5\u586b\u5b57\u6bb5":null==r?void 0:r(y(i,a)),e.state.error=n,n}})),handleBlur:function(e){B.validate(e)},handleChange:Object(r.action)((function(e,n){e.value=n,B.validate(e)}))},M={clearError:Object(r.action)((function(e){e._proxy.iterateFields((function(e){e.state.error=null}))})),validateAll:Object(r.action)((function(e){var n=Object(r.observable)("array"===e.valueShape?[]:{}),t=!1;return e._proxy.iterateFields((function(e){if(0!==e.mountCount){var r=B.validate(e);r&&(t=!0,f(n,e.path,r))}})),{hasError:t,errors:Object(r.toJS)(n)}}))},P=function(e,n){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)n.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(t[r[o]]=e[r[o]])}return t};function N(e){var n=e.model,t=e.defaultValue,r=e.isPreview,o=e.isInline,i=e.labelPosition,c=e.onSubmit,s=e.onError,u=e.onReset,d=e.children,m=e.className,p=e.style,f=y(n,Object(a.useState)((function(){return new V(t)}))[0]);return l.a.createElement(x,{isPreview:r,onError:s,onReset:u,onSubmit:c},l.a.createElement(S,{value:f},l.a.createElement(k.FormLayout,{labelPosition:i,isInline:o,style:p,className:m},d)))}var q=Object(o.c)((function(e){var n=e.watch,t=e.effect,o=E(),l=o.getField(n);return Object(a.useEffect)((function(){return Object(r.reaction)((function(){return l.value}),(function(e,n){return t(e,{model:o,prev:n,next:e})}))}),[o,n,l,t]),null})),Y=Object(o.c)((function(e){return(0,e.children)(E())}));N.Submit=function(e){var n=e.type,t=void 0===n?"primary":n,o=e.children,a=void 0===o?"\u63d0\u4ea4":o,i=P(e,["type","children"]),c=E().root,s=_(),u=s.onSubmit,d=s.onError;return l.a.createElement(k.Button,Object.assign({onClick:function(){var e=M.validateAll(c),n=e.hasError,t=e.errors;if(n)null==d||d(t,c);else if("function"==typeof u){var o=Object(r.observable)("array"===c.valueShape?[]:{});c._proxy.iterateFields((function(e){if(0!==e.mountCount){var n=e.path,t=e.value;f(o,n,t)}})),u(Object(r.toJS)(o),c)}},type:t,children:a},i))},N.Reset=function(e){var n=e.children,t=void 0===n?"\u91cd\u7f6e":n,o=P(e,["children"]),a=E().root,i=_().onReset;return l.a.createElement(k.Button,Object.assign({onClick:Object(r.action)((function(){a.values={},M.clearError(a),null==i||i(a)})),children:t},o))},N.Effect=q,N.Array=F,N.Object=C,N.Field=j,N.ModelConsumer=Y;try{N.displayName="Form",N.__docgenInfo={description:"",displayName:"Form",props:{model:{defaultValue:null,description:"\u53d7\u63a7\u7528\u6cd5\u3002 xform \u6a21\u578b\u5bf9\u8c61\uff0c\u4e00\u822c\u7531\u4e0a\u5c42\u901a\u8fc7 new RootModel(...) \u521b\u5efa\u800c\u6210",name:"model",required:!1,type:{name:"IModel<unknown>"}},defaultValue:{defaultValue:null,description:"\u975e\u53d7\u63a7\u7528\u6cd5\u3002 \u8868\u5355\u7684\u9ed8\u8ba4\u503c",name:"defaultValue",required:!1,type:{name:"any"}},onSubmit:{defaultValue:null,description:"\u63d0\u4ea4\u8868\u5355\u65f6\u7684\u56de\u8c03\u51fd\u6570\uff0c\u9700\u914d\u5408 <Form.Submit /> \u4f7f\u7528",name:"onSubmit",required:!1,type:{name:"(submitValues: any, model: RootModel<unknown>) => void"}},onError:{defaultValue:null,description:"\u63d0\u4ea4\u8868\u5355\u65f6\u7684\u51fa\u9519\u56de\u8c03\u51fd\u6570\uff0c\u9700\u914d\u5408 <Form.Submit /> \u4f7f\u7528",name:"onError",required:!1,type:{name:"(errors: any, model: RootModel<unknown>) => void"}},onReset:{defaultValue:null,description:"\u6e05\u7a7a\u8868\u5355\u65f6\u7684\u56de\u8c03\u51fd\u6570\uff0c\u9700\u914d\u5408 <Form.Reset /> \u4f7f\u7528",name:"onReset",required:!1,type:{name:"(model: RootModel<unknown>) => void"}},isPreview:{defaultValue:{value:"false"},description:"\u662f\u5426\u4e3a\u9884\u89c8\u6001",name:"isPreview",required:!1,type:{name:"boolean"}},isInline:{defaultValue:{value:"false"},description:"\u662f\u5426\u5185\u8054\u5e03\u5c40\n@category \u5e03\u5c40",name:"isInline",required:!1,type:{name:"boolean"}},labelPosition:{defaultValue:{value:"'top'"},description:"\u6807\u7b7e\u4f4d\u7f6e\n@category \u5e03\u5c40",name:"labelPosition",required:!1,type:{name:'"top" | "left"'}},style:{defaultValue:null,description:"@category \u5e03\u5c40",name:"style",required:!1,type:{name:"CSSProperties"}},className:{defaultValue:null,description:"@category \u5e03\u5c40",name:"className",required:!1,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/form.tsx#Form"]={docgenInfo:N.__docgenInfo,name:"Form",path:"../xform/src/form.tsx#Form"})}catch(Q){}try{N.Submit.displayName="Form.Submit",N.Submit.__docgenInfo={description:"",displayName:"Form.Submit",props:{shape:{defaultValue:null,description:"",name:"shape",required:!1,type:{name:'"solid" | "text" | "link" | "warning" | "ghost"'}},type:{defaultValue:{value:"primary"},description:"",name:"type",required:!1,type:{name:'"normal" | "primary" | "secondary"'}},size:{defaultValue:null,description:"",name:"size",required:!1,type:{name:'"medium" | "large" | "small"'}},htmlType:{defaultValue:null,description:"",name:"htmlType",required:!1,type:{name:'"button" | "reset" | "submit"'}},isFullWidth:{defaultValue:null,description:"",name:"isFullWidth",required:!1,type:{name:"boolean"}},isSelected:{defaultValue:null,description:"",name:"isSelected",required:!1,type:{name:"boolean"}},loading:{defaultValue:null,description:"",name:"loading",required:!1,type:{name:"boolean"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},leftElement:{defaultValue:null,description:"",name:"leftElement",required:!1,type:{name:"ReactNode"}},rightElement:{defaultValue:null,description:"",name:"rightElement",required:!1,type:{name:"ReactNode"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/form.tsx#Form.Submit"]={docgenInfo:N.Submit.__docgenInfo,name:"Form.Submit",path:"../xform/src/form.tsx#Form.Submit"})}catch(Q){}try{N.Reset.displayName="Form.Reset",N.Reset.__docgenInfo={description:"",displayName:"Form.Reset",props:{shape:{defaultValue:null,description:"",name:"shape",required:!1,type:{name:'"solid" | "text" | "link" | "warning" | "ghost"'}},type:{defaultValue:null,description:"",name:"type",required:!1,type:{name:'"normal" | "primary" | "secondary"'}},size:{defaultValue:null,description:"",name:"size",required:!1,type:{name:'"medium" | "large" | "small"'}},htmlType:{defaultValue:null,description:"",name:"htmlType",required:!1,type:{name:'"button" | "reset" | "submit"'}},isFullWidth:{defaultValue:null,description:"",name:"isFullWidth",required:!1,type:{name:"boolean"}},isSelected:{defaultValue:null,description:"",name:"isSelected",required:!1,type:{name:"boolean"}},loading:{defaultValue:null,description:"",name:"loading",required:!1,type:{name:"boolean"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},leftElement:{defaultValue:null,description:"",name:"leftElement",required:!1,type:{name:"ReactNode"}},rightElement:{defaultValue:null,description:"",name:"rightElement",required:!1,type:{name:"ReactNode"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/form.tsx#Form.Reset"]={docgenInfo:N.Reset.__docgenInfo,name:"Form.Reset",path:"../xform/src/form.tsx#Form.Reset"})}catch(Q){}try{N.Effect.displayName="Form.Effect",N.Effect.__docgenInfo={description:"",displayName:"Form.Effect",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/form.tsx#Form.Effect"]={docgenInfo:N.Effect.__docgenInfo,name:"Form.Effect",path:"../xform/src/form.tsx#Form.Effect"})}catch(Q){}try{N.Array.displayName="Form.Array",N.Array.__docgenInfo={description:"",displayName:"Form.Array",props:{name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"string"}},layout:{defaultValue:null,description:"",name:"layout",required:!0,type:{name:"(input: XFormArrayLayoutInput) => ReactElement<any, string | JSXElementConstructor<any>>"}},itemFactory:{defaultValue:null,description:"",name:"itemFactory",required:!1,type:{name:"(arrayModel: Model<unknown[]>) => any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/form.tsx#Form.Array"]={docgenInfo:N.Array.__docgenInfo,name:"Form.Array",path:"../xform/src/form.tsx#Form.Array"})}catch(Q){}try{N.Object.displayName="Form.Object",N.Object.__docgenInfo={description:"",displayName:"Form.Object",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/form.tsx#Form.Object"]={docgenInfo:N.Object.__docgenInfo,name:"Form.Object",path:"../xform/src/form.tsx#Form.Object"})}catch(Q){}try{N.Field.displayName="Form.Field",N.Field.__docgenInfo={description:"",displayName:"Form.Field",props:{name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"string"}},label:{defaultValue:null,description:"",name:"label",required:!1,type:{name:"ReactNode"}},validate:{defaultValue:null,description:"",name:"validate",required:!1,type:{name:"(value: any) => any"}},required:{defaultValue:null,description:"",name:"required",required:!1,type:{name:"boolean"}},defaultValue:{defaultValue:null,description:"",name:"defaultValue",required:!1,type:{name:"any"}},isEmpty:{defaultValue:null,description:"",name:"isEmpty",required:!0,type:{name:"(value: any) => boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/form.tsx#Form.Field"]={docgenInfo:N.Field.__docgenInfo,name:"Form.Field",path:"../xform/src/form.tsx#Form.Field"})}catch(Q){}try{N.ModelConsumer.displayName="Form.ModelConsumer",N.ModelConsumer.__docgenInfo={description:"",displayName:"Form.ModelConsumer",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/form.tsx#Form.ModelConsumer"]={docgenInfo:N.ModelConsumer.__docgenInfo,name:"Form.ModelConsumer",path:"../xform/src/form.tsx#Form.ModelConsumer"})}catch(Q){}var L=function(e,n){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)n.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(t[r[o]]=e[r[o]])}return t};function K(e){var n=e.children;return l.a.createElement("div",{style:{border:"1px dashed var(--rex-colors-error-hover)",fontSize:14,padding:4,color:"var(--rex-colors-error-normal)"}},n)}function J(e){var n;return null!==(n=e.value)&&void 0!==n?n:e.defaultValue}function U(e){return!e}var D={};function G(e,n){function t(t){var r=t.defaultValue,o=void 0===r?n.fallbackValue:r,a=t.componentProps,i=t.value,c=t.onChange,s=t.onBlur,u=L(t,["defaultValue","componentProps","value","onChange","onBlur"]),d=_().isPreview;return l.a.createElement(j,Object.assign({defaultValue:o,isEmpty:n.isEmpty},u),(function(t){t.model,t.name;var r=t.field,o=t.value,m=t.required,p=r.state.error,f=Object.assign(Object.assign(Object.assign({},Object(k.pick)(u,["dataSource","items"])),a),{value:void 0!==i?i:o,onChange:void 0!==c?c:function(e){return B.handleChange(r,e)},onBlur:void 0!==s?s:function(){return B.handleBlur(r)},status:p?"error":void 0});return l.a.createElement(k.FormControl,{label:u.label,required:m,error:p},d?n.previewRender(f):l.a.createElement(e,Object.assign({},f)))}))}t.displayName="FormItem("+n.name+")",D[n.name]=t}function z(e){var n=e.component,t=L(e,["component"]),r=D[n];return null==r?l.a.createElement(k.FormControl,null,l.a.createElement(K,null,l.a.createElement("code",null,"<FormItem component='",n,"' />")," \u6ca1\u6709\u627e\u5230\u5bf9\u5e94\u7ec4\u4ef6\uff0c\u8bf7\u68c0\u67e5\u7ec4\u4ef6\u540d\u79f0\u662f\u5426\u62fc\u5199\u6b63\u786e")):l.a.createElement(r,t)}G(k.Switch,{name:"switch",previewRender:function(e){var n;return(null!==(n=e.value)&&void 0!==n?n:e.defaultValue)?"\u662f":"\u5426"},fallbackValue:!1,isEmpty:U}),G(k.CheckboxGroup,{name:"checkboxGroup",fallbackValue:[],previewRender:function(e){var n,t=null!==(n=e.value)&&void 0!==n?n:e.defaultValue,r=new k.ListStore(e.dataSource);return t.map((function(e){var n=r.getItem(e);return n?n.label:e})).join("\u3001")},isEmpty:function(e){return null==e||0===e.length}}),G(k.RadioGroup,{name:"radioGroup",fallbackValue:null,previewRender:function(e){var n,t=null!==(n=e.value)&&void 0!==n?n:e.defaultValue,r=new k.ListStore(e.dataSource).getItem(t);return r?r.label:t},isEmpty:U}),G(k.DatePicker,{name:"datePicker",previewRender:J,fallbackValue:null,isEmpty:U}),G(k.DateRangePicker,{name:"dateRangePicker",previewRender:function(e){var n,t=(null!==(n=e.value)&&void 0!==n?n:e.defaultValue)||[];return(t[0]||"-")+" ~ "+(t[1]||"-")},fallbackValue:["",""],isEmpty:U}),G(k.TimePicker,{name:"timePicker",previewRender:J,fallbackValue:"",isEmpty:U}),G(k.FilePicker,{name:"filePicker",previewRender:function(e){var n,t=(null!==(n=e.value)&&void 0!==n?n:e.defaultValue)||[];return l.a.createElement(k.Flex,{spacing:"s",direction:"column"},t.map((function(e){var n=e.id,t=e.name,r=e.url;return l.a.createElement(k.FlexItem,{key:n,bg:"fill.layer1",px:"m"},l.a.createElement(k.Link,{href:r},t))})))},fallbackValue:[],isEmpty:U}),G(k.MediaPicker,{name:"mediaPicker",previewRender:function(e){var n,t=(null!==(n=e.value)&&void 0!==n?n:e.defaultValue)||[];return l.a.createElement(k.Flex,{spacing:"m"},t.map((function(e){var n=e.id,t=e.name,r=e.url,o=Object(k.colors)("fill.layer1")+" url("+r+") center center / 100% no-repeat";return l.a.createElement(k.Box,{key:n,size:"100px",title:t,display:"inline-block",style:{background:o}})})))},fallbackValue:[],isEmpty:U}),G(k.Input,{name:"input",previewRender:J,fallbackValue:"",isEmpty:U}),G(k.Textarea,{name:"textarea",previewRender:J,fallbackValue:"",isEmpty:U}),G(k.NumberInput,{name:"numberInput",previewRender:J,fallbackValue:null,isEmpty:U}),G(k.Range,{name:"range",previewRender:J,fallbackValue:0,isEmpty:U}),G(k.Select,{name:"select",previewRender:J,isEmpty:U,fallbackValue:null}),G(k.SingleSelect,{name:"singleSelect",previewRender:J,fallbackValue:null,isEmpty:U}),G(k.MultiSelect,{name:"multiSelect",previewRender:J,fallbackValue:[],isEmpty:function(e){return null==e||0===e.length}}),G(k.TreeSelect,{name:"treeSelect",previewRender:J,fallbackValue:null,isEmpty:U}),G(k.SingleTreeSelect,{name:"singleTreeSelect",previewRender:J,fallbackValue:null,isEmpty:U}),G(k.MultiTreeSelect,{name:"multiTreeSelect",previewRender:J,fallbackValue:[],isEmpty:function(e){return null==e||0===e.length}}),G((function(e){var n=e.items,t=e.value,r=e.onChange,o=L(e,["items","value","onChange"]);return l.a.createElement("div",Object.assign({style:{display:"flex",gap:8}},o),n.map((function(e){return l.a.createElement(k.Button,{key:e,type:e===t?"primary":"normal",onClick:function(){return r(e)}},e)})))}),{name:"testButtonGroup",fallbackValue:"",previewRender:J,isEmpty:U});try{z.displayName="FormItem",z.__docgenInfo={description:"",displayName:"FormItem",props:{component:{defaultValue:null,description:"",name:"component",required:!0,type:{name:'"radioGroup" | "input" | "select" | "textarea" | "switch" | "singleSelect" | "multiSelect" | "treeSelect" | "checkboxGroup" | "datePicker" | "dateRangePicker" | "timePicker" | ... 6 more ... | "testButtonGroup"'}},componentProps:{defaultValue:null,description:"",name:"componentProps",required:!1,type:{name:"TimePickerProps | TextareaProps | RangeProps | SwitchProps | SelectProps | MultiSelectProps | ... 10 more ... | HTMLProps<...>"}},defaultValue:{defaultValue:null,description:"",name:"defaultValue",required:!1,type:{name:"any"}},name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"string"}},label:{defaultValue:null,description:"",name:"label",required:!1,type:{name:"ReactNode"}},validate:{defaultValue:null,description:"",name:"validate",required:!1,type:{name:"(value: any) => any"}},required:{defaultValue:null,description:"",name:"required",required:!1,type:{name:"boolean"}},isEmpty:{defaultValue:null,description:"",name:"isEmpty",required:!0,type:{name:"(value: any) => boolean"}},dataSource:{defaultValue:null,description:"",name:"dataSource",required:!1,type:{name:"ListNode<string>[] | (string | SelectItem)[] | ListNode<StringOrNumber>[] | TreeSelectItem[]"}},items:{defaultValue:null,description:"",name:"items",required:!0,type:{name:"string[]"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/form-item.tsx#FormItem"]={docgenInfo:z.__docgenInfo,name:"FormItem",path:"../xform/src/form-item.tsx#FormItem"})}catch(Q){}var X=function(e){for(var n=[],t=0;t<e;t++)n.push(t);return n},W=function(e){var n=void 0===e?{}:e,t=n.title,o=n.showItemCount,a=n.showItemOrder,i=n.style,c={position:"absolute",top:8,right:8,display:"flex",gap:8,zIndex:20};return function(e){var n=e.arrayModel,s=e.itemContent,u=e.itemCount,d=e.itemFactory;return l.a.createElement("div",{className:"xform-array",style:Object.assign({marginTop:16,marginBottom:8},i)},(t||o)&&l.a.createElement("h2",null,null!=t?t:"\u5217\u8868"," ",o&&"("+u+")"),0===u&&l.a.createElement("div",{style:{border:"1px dashed #aaa",marginTop:16,padding:8,position:"relative",fontSize:20}},"\u7a7a\u7a7a\u5982\u4e5f~~"),l.a.createElement("div",{className:"xform-array-items"},X(u).map((function(t){return l.a.createElement("div",{key:b.getKey(n,t),className:"xform-array-item",style:{border:"1px dashed #aaa",marginTop:16,padding:8,position:"relative"}},a&&l.a.createElement("code",{style:{fontSize:16}},n.path.join("."),"#",t),l.a.createElement(H,Object.assign({},e,{itemIndex:t,style:c})),b.renderArrayItem(n,t,s))}))),l.a.createElement("div",{style:{marginTop:12}},l.a.createElement(k.Button,{onClick:Object(r.action)((function(){b.append(n,d)}))},"\u6dfb\u52a0\u4e00\u9879")))}},H=Object(o.c)((function(e){var n=e.arrayModel,t=e.itemCount,o=e.itemIndex,a=e.style;return l.a.createElement("div",{style:a},l.a.createElement(k.Button,{size:"small",onClick:Object(r.action)((function(){b.delete(n,o)}))},"\u5220\u9664"),l.a.createElement(k.Button,{size:"small",disabled:0===o,onClick:Object(r.action)((function(){b.moveUp(n,o)}))},"\u4e0a\u79fb"),l.a.createElement(k.Button,{size:"small",disabled:o===t-1,onClick:Object(r.action)((function(){b.moveDown(n,o)}))},"\u4e0b\u79fb"))})),$=function(e){var n=void 0===e?{}:e,t=n.defaultColumnWidth,r=n.orderColumn,o=n.operationColumn,a=n.className,i=n.style,c={display:"flex",gap:0};return function(e){var n=e.arrayModel,s=e.itemContent,u=e.itemCount,d=e.itemFactory,m=l.a.Children.toArray(s).filter((function(e){return e.type===z})).map((function(e){return Object.assign(Object.assign({name:"string"==typeof e.props.label?e.props.label:null,title:e.props.label},e.props["x-table-column"]),{render:function(n,t){return l.a.createElement(C,{name:String(t.itemIndex)},l.a.cloneElement(e,{label:null,isInline:!0}))}})}));return null!=r&&m.unshift(Object.assign(Object.assign({name:"#"},r),{getValue:function(e){return e.itemIndex+1}})),null!=o&&m.push(Object.assign(Object.assign({name:""},o),{render:function(n,t){return l.a.createElement(H,Object.assign({},e,{itemIndex:t.itemIndex,style:c}))}})),l.a.createElement("div",{style:i,className:a},l.a.createElement(k.BaseTable,{className:"bordered",primaryKey:"rowKey",defaultColumnWidth:t,dataSource:X(u).map((function(e){return{rowKey:b.getKey(n,e),itemIndex:e}})),columns:m}),l.a.createElement("div",{style:{padding:4,height:48,display:"flex",alignItems:"center",justifyContent:"center",background:"#f5f5f5"}},l.a.createElement(k.Button,{type:"primary",onClick:function(){b.append(n,d)}},"\u6dfb\u52a0\u4e00\u884c")))}};try{W.displayName="arrayCard",W.__docgenInfo={description:"",displayName:"arrayCard",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/array-layouts.tsx#arrayCard"]={docgenInfo:W.__docgenInfo,name:"arrayCard",path:"../xform/src/array-layouts.tsx#arrayCard"})}catch(Q){}try{$.displayName="arrayTable",$.__docgenInfo={description:"",displayName:"arrayTable",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/array-layouts.tsx#arrayTable"]={docgenInfo:$.__docgenInfo,name:"arrayTable",path:"../xform/src/array-layouts.tsx#arrayTable"})}catch(Q){}},318:function(e,n,t){"use strict";t.d(n,"a",(function(){return h}));var r=t(174),o=t(4),a=t(320),l=t(3),i=t(163),c=t(213),s=t(170),u=t(173),d=t(0),m=t.n(d);function p(e){var n=e.children,t=e.fallback;return"undefined"==typeof document||null==n?null!=t?t:null:m.a.createElement(m.a.Fragment,null,n())}var f={filename:"/Users/feichao.sfc/code/github/alibaba/rex-design/packages/story/src/xform/helpers.tsx",loc:{start:{line:9,column:0},end:{line:21,column:1}},name:"BrowserOnly",value:p,source:" function _nullishCoalesce(lhs, rhsFn) { if (lhs != null) { return lhs; } else { return rhsFn(); } }function BrowserOnly({\n  children,\n  fallback,\n}\n\n\n) {\n  if (typeof document === 'undefined' || children == null) {\n    return _nullishCoalesce(fallback, () => ( null));\n  }\n\n  return <>{children()}</>;\n}",deps:function(){return[]},provides:{React:m.a}},b=function(e){return m.a.createElement(p,null,(function(){var n=t(395).default;return m.a.createElement(n,Object(l.a)({style:Object.assign({marginTop:8,fontSize:12},e.style)},e))}))},y={filename:"/Users/feichao.sfc/code/github/alibaba/rex-design/packages/story/src/xform/helpers.tsx",loc:{start:{line:23,column:7},end:{line:32,column:2}},name:"BrowserOnlyReactJson",value:b,source:"const BrowserOnlyReactJson = (props) => {\n  return (\n    <BrowserOnly>\n      {() => {\n        const ReactJson = require('react-json-view').default;\n        return <ReactJson style={{ marginTop: 8, fontSize: 12, ...props.style }} {...props} />;\n      }}\n    </BrowserOnly>\n  );\n};",deps:function(){return[f]},provides:{}};b.__doc_info=y,b.__inner_source="(props) => {\n  return (\n    <BrowserOnly>\n      {() => {\n        const ReactJson = require('react-json-view').default;\n        return <ReactJson style={{ marginTop: 8, fontSize: 12, ...props.style }} {...props} />;\n      }}\n    </BrowserOnly>\n  );\n}";var h=Object(u.c)((function(e){var n,t=e.style,r=e.defaultShow,o=Object(c.h)(),a=Object(s.toJS)(o.values),l=null!==(n=o.state.showReactJson)&&void 0!==n?n:r;return m.a.createElement("div",{style:Object.assign({marginTop:16},t)},m.a.createElement("div",{style:{marginTop:8,display:"flex",alignItems:"center",gap:8}},m.a.createElement(i.Switch,{value:l,onChange:Object(s.action)((function(e){o.state.showReactJson=e}))}),m.a.createElement("span",{style:{fontSize:12}},"\u663e\u793a JSON")),l&&m.a.createElement(b,{name:"\u8868\u5355\u72b6\u6001\u9884\u89c8",src:a}))})),v=(u.c,m.a,c.h,s.toJS,i.Switch,s.action,Object(u.c)((function(e){var n=e.label,t=e.printAll,r=Object(c.h)();return Object(d.useEffect)((function(){return Object(s.autorun)((function(){console.log("[ValuePrinter] "+(null!=n?n:"")+"\n",t?Object.assign({},r,{values:Object(s.toJS)(r.values)}):Object(s.toJS)(r.values))}))}),[n,r,t]),null}))),g=(u.c,c.h,d.useEffect,s.autorun,s.toJS,Object(u.c)((function(){var e=Object(c.h)().root;return m.a.createElement("div",{style:{display:"flex",gap:8}},m.a.createElement(i.Button,{onClick:function(){return c.g.validateAll(e)}},"\u6821\u9a8c\u5168\u90e8"),m.a.createElement(i.Button,{onClick:function(){return c.g.clearError(e)}},"\u6e05\u7a7a\u9519\u8bef"),m.a.createElement(i.Button,{onClick:Object(s.action)((function(){e.values={opCount:0,sku:{code:"test"}},c.g.clearError(e)}))},"\u91cd\u7f6e\u8868\u5355"))})),u.c,c.h,i.Button,c.g,s.action,Object(u.c)((function(){var e=Object(c.h)();return Object(d.useEffect)((function(){return window.model=e,window.toJS=s.toJS,window.mobx=s,function(){delete window.model,delete window.toJS,delete window.mobx}}),[e]),m.a.createElement(m.a.Fragment,null)})),u.c,c.h,d.useEffect,s.toJS,function(e){function n(){return e.apply(this,arguments)||this}return Object(o.a)(n,e),n}(Object(a.a)(Error))),S={filename:"/Users/feichao.sfc/code/github/alibaba/rex-design/packages/story/src/xform/helpers.tsx",loc:{start:null,end:null},name:"AsyncLoadingError",value:g,source:" function _nullishCoalesce(lhs, rhsFn) { if (lhs != null) { return lhs; } else { return rhsFn(); } } function _optionalChain(ops) { let lastAccessLHS = undefined; let value = ops[0]; let i = 1; while (i < ops.length) { const op = ops[i]; const fn = ops[i + 1]; i += 2; if ((op === 'optionalAccess' || op === 'optionalCall') && value == null) { return undefined; } if (op === 'access' || op === 'optionalAccess') { lastAccessLHS = value; value = fn(value); } else if (op === 'call' || op === 'optionalCall') { value = fn((...args) => value.call(lastAccessLHS, ...args)); lastAccessLHS = undefined; } } return value; }import { Button, Switch } from '@rexd/core';\nimport { modelUtils, useModel } from '@rexd/xform';\nimport * as mobx from 'mobx';\nimport { action, autorun, computed, toJS } from 'mobx';\nimport { observer } from 'mobx-react-lite';\nimport React, { useEffect } from 'react';\n\n\nfunction BrowserOnly({\n  children,\n  fallback,\n}\n\n\n) {\n  if (typeof document === 'undefined' || children == null) {\n    return _nullishCoalesce(fallback, () => ( null));\n  }\n\n  return <>{children()}</>;\n}\n\nexport const BrowserOnlyReactJson = (props) => {\n  return (\n    <BrowserOnly>\n      {() => {\n        const ReactJson = require('react-json-view').default;\n        return <ReactJson style={{ marginTop: 8, fontSize: 12, ...props.style }} {...props} />;\n      }}\n    </BrowserOnly>\n  );\n};\n\n// https://github.com/mac-s-g/react-json-view/issues/121#issuecomment-670431408\n\nexport const ValuePreview = observer(\n  ({ style, defaultShow }) => {\n    const model = useModel();\n    const data = toJS(model.values) ;\n    const showReactJson = _nullishCoalesce(model.state.showReactJson, () => ( defaultShow));\n\n    return (\n      <div style={{ marginTop: 16, ...style }}>\n        <div style={{ marginTop: 8, display: 'flex', alignItems: 'center', gap: 8 }}>\n          <Switch\n            value={showReactJson}\n            onChange={action((b) => {\n              model.state.showReactJson = b;\n            })}\n          />\n          <span style={{ fontSize: 12 }}>\u663e\u793a JSON</span>\n        </div>\n        {showReactJson && <BrowserOnlyReactJson name=\"\u8868\u5355\u72b6\u6001\u9884\u89c8\" src={data} />}\n      </div>\n    );\n  },\n);\n\nexport const ValuePrinter = observer(({ label, printAll }) => {\n  const model = useModel();\n\n  useEffect(() => {\n    return autorun(() => {\n      console.log(\n        `[ValuePrinter] ${_nullishCoalesce(label, () => ( ''))}\\n`,\n        printAll ? { ...model, values: toJS(model.values) } : toJS(model.values),\n      );\n    });\n  }, [label, model, printAll]);\n\n  return null;\n});\n\nexport const Actions = observer(() => {\n  const model = useModel().root;\n\n  return (\n    <div style={{ display: 'flex', gap: 8 }}>\n      <Button onClick={() => modelUtils.validateAll(model)}>\u6821\u9a8c\u5168\u90e8</Button>\n      <Button onClick={() => modelUtils.clearError(model)}>\u6e05\u7a7a\u9519\u8bef</Button>\n      <Button\n        onClick={action(() => {\n          model.values = {\n            opCount: 0,\n            sku: { code: 'test' },\n          };\n          modelUtils.clearError(model);\n        })}\n      >\n        \u91cd\u7f6e\u8868\u5355\n      </Button>\n    </div>\n  );\n});\n\nexport const InjectModelToGlobal = observer(() => {\n  const model = useModel();\n\n  useEffect(() => {\n    // @ts-ignore\n    window.model = model;\n    // @ts-ignore\n    window.toJS = toJS;\n    // @ts-ignore\n    window.mobx = mobx;\n\n    return () => {\n      // @ts-ignore\n      delete window.model;\n      // @ts-ignore\n      delete window.toJS;\n      // @ts-ignore\n      delete window.mobx;\n    };\n  }, [model]);\n\n  return <></>;\n});\n\n\n\nclass AsyncLoadingError extends Error {}\n\n\n\n\n\n\n\n\nfunction getFromAsyncValue(x) {\n  if (x.status !== 'ready') {\n    throw new AsyncLoadingError();\n  }\n  return x.current;\n}\n\nexport function makeAsyncValue(getter, initValue) {\n  const atom = mobx.createAtom('atom@asyncSelect');\n  const disposers = [];\n\n  let status = 'loading';\n  let current = initValue;\n\n  const computedStatus = computed(() => {\n    atom.reportObserved();\n    return status;\n  });\n  const computedCurrent = computed(() => {\n    atom.reportObserved();\n    return current;\n  });\n\n  let reaction;\n  let cancelLastGetter;\n\n  const start = () => {\n    reaction = new mobx.Reaction('async', () => {\n      if (status !== 'loading') {\n        status = 'loading';\n        atom.reportChanged();\n      }\n\n      reaction.track(() => {\n        _optionalChain([cancelLastGetter, 'optionalCall', _ => _()]);\n\n        let cancelled = false;\n        cancelLastGetter = () => {\n          cancelled = true;\n        };\n\n        getter(getFromAsyncValue)\n          .then(\n            action((newValue) => {\n              if (cancelled) {\n                return;\n              }\n              status = 'ready';\n              current = newValue;\n              atom.reportChanged();\n\n              return newValue;\n            }),\n          )\n          .catch((e) => {\n            if (e instanceof AsyncLoadingError) {\n              // still loading, do nothing\n              return;\n            }\n            // TODO \u5904\u7406 error \u72b6\u6001\n            throw e;\n          });\n      });\n    });\n    reaction.schedule_();\n  };\n\n  const stop = () => {\n    if (reaction) {\n      reaction.dispose();\n      reaction = null;\n    }\n  };\n\n  disposers.push(mobx.onBecomeObserved(atom, start));\n  disposers.push(mobx.onBecomeUnobserved(atom, stop));\n  disposers.push(stop);\n\n  return {\n    get status() {\n      return computedStatus.get();\n    },\n    get current() {\n      return computedCurrent.get();\n    },\n    dispose() {\n      for (const fn of disposers) {\n        fn();\n      }\n    },\n    refresh() {\n      _optionalChain([reaction, 'optionalAccess', _2 => _2.onBecomeStale_, 'call', _3 => _3()]);\n    },\n  };\n}\n",deps:function(){return[]},provides:{}};function O(e){if("ready"!==e.status)throw new g;return e.current}var x={filename:"/Users/feichao.sfc/code/github/alibaba/rex-design/packages/story/src/xform/helpers.tsx",loc:{start:{line:131,column:0},end:{line:136,column:1}},name:"getFromAsyncValue",value:O,source:"function getFromAsyncValue(x) {\n  if (x.status !== 'ready') {\n    throw new AsyncLoadingError();\n  }\n  return x.current;\n}",deps:function(){return[S]},provides:{}};function _(e,n){var t,o,a=s.createAtom("atom@asyncSelect"),l=[],i="loading",c=n,u=Object(s.computed)((function(){return a.reportObserved(),i})),d=Object(s.computed)((function(){return a.reportObserved(),c})),m=function(){t&&(t.dispose(),t=null)};return l.push(s.onBecomeObserved(a,(function(){(t=new s.Reaction("async",(function(){"loading"!==i&&(i="loading",a.reportChanged()),t.track((function(){var n;null===(n=o)||void 0===n||n();var t=!1;o=function(){t=!0},e(O).then(Object(s.action)((function(e){if(!t)return i="ready",c=e,a.reportChanged(),e}))).catch((function(e){if(!(e instanceof g))throw e}))}))}))).schedule_()}))),l.push(s.onBecomeUnobserved(a,m)),l.push(m),{get status(){return u.get()},get current(){return d.get()},dispose:function(){for(var e,n=Object(r.a)(l);!(e=n()).done;){(0,e.value)()}},refresh:function(){var e;null===(e=t)||void 0===e||e.onBecomeStale_()}}}var E={filename:"/Users/feichao.sfc/code/github/alibaba/rex-design/packages/story/src/xform/helpers.tsx",loc:{start:{line:138,column:7},end:{line:225,column:1}},name:"makeAsyncValue",value:_,source:" function _optionalChain(ops) { let lastAccessLHS = undefined; let value = ops[0]; let i = 1; while (i < ops.length) { const op = ops[i]; const fn = ops[i + 1]; i += 2; if ((op === 'optionalAccess' || op === 'optionalCall') && value == null) { return undefined; } if (op === 'access' || op === 'optionalAccess') { lastAccessLHS = value; value = fn(value); } else if (op === 'call' || op === 'optionalCall') { value = fn((...args) => value.call(lastAccessLHS, ...args)); lastAccessLHS = undefined; } } return value; }function makeAsyncValue(getter, initValue) {\n  const atom = mobx.createAtom('atom@asyncSelect');\n  const disposers = [];\n\n  let status = 'loading';\n  let current = initValue;\n\n  const computedStatus = computed(() => {\n    atom.reportObserved();\n    return status;\n  });\n  const computedCurrent = computed(() => {\n    atom.reportObserved();\n    return current;\n  });\n\n  let reaction;\n  let cancelLastGetter;\n\n  const start = () => {\n    reaction = new mobx.Reaction('async', () => {\n      if (status !== 'loading') {\n        status = 'loading';\n        atom.reportChanged();\n      }\n\n      reaction.track(() => {\n        _optionalChain([cancelLastGetter, 'optionalCall', _ => _()]);\n\n        let cancelled = false;\n        cancelLastGetter = () => {\n          cancelled = true;\n        };\n\n        getter(getFromAsyncValue)\n          .then(\n            action((newValue) => {\n              if (cancelled) {\n                return;\n              }\n              status = 'ready';\n              current = newValue;\n              atom.reportChanged();\n\n              return newValue;\n            }),\n          )\n          .catch((e) => {\n            if (e instanceof AsyncLoadingError) {\n              // still loading, do nothing\n              return;\n            }\n            // TODO \u5904\u7406 error \u72b6\u6001\n            throw e;\n          });\n      });\n    });\n    reaction.schedule_();\n  };\n\n  const stop = () => {\n    if (reaction) {\n      reaction.dispose();\n      reaction = null;\n    }\n  };\n\n  disposers.push(mobx.onBecomeObserved(atom, start));\n  disposers.push(mobx.onBecomeUnobserved(atom, stop));\n  disposers.push(stop);\n\n  return {\n    get status() {\n      return computedStatus.get();\n    },\n    get current() {\n      return computedCurrent.get();\n    },\n    dispose() {\n      for (const fn of disposers) {\n        fn();\n      }\n    },\n    refresh() {\n      _optionalChain([reaction, 'optionalAccess', _2 => _2.onBecomeStale_, 'call', _3 => _3()]);\n    },\n  };\n}",deps:function(){return[x,S]},provides:{mobx:s,computed:s.computed,action:s.action}};_.__inner_source=" function _optionalChain(ops) { let lastAccessLHS = undefined; let value = ops[0]; let i = 1; while (i < ops.length) { const op = ops[i]; const fn = ops[i + 1]; i += 2; if ((op === 'optionalAccess' || op === 'optionalCall') && value == null) { return undefined; } if (op === 'access' || op === 'optionalAccess') { lastAccessLHS = value; value = fn(value); } else if (op === 'call' || op === 'optionalCall') { value = fn((...args) => value.call(lastAccessLHS, ...args)); lastAccessLHS = undefined; } } return value; }function makeAsyncValue(getter, initValue) {\n  const atom = mobx.createAtom('atom@asyncSelect');\n  const disposers = [];\n\n  let status = 'loading';\n  let current = initValue;\n\n  const computedStatus = computed(() => {\n    atom.reportObserved();\n    return status;\n  });\n  const computedCurrent = computed(() => {\n    atom.reportObserved();\n    return current;\n  });\n\n  let reaction;\n  let cancelLastGetter;\n\n  const start = () => {\n    reaction = new mobx.Reaction('async', () => {\n      if (status !== 'loading') {\n        status = 'loading';\n        atom.reportChanged();\n      }\n\n      reaction.track(() => {\n        _optionalChain([cancelLastGetter, 'optionalCall', _ => _()]);\n\n        let cancelled = false;\n        cancelLastGetter = () => {\n          cancelled = true;\n        };\n\n        getter(getFromAsyncValue)\n          .then(\n            action((newValue) => {\n              if (cancelled) {\n                return;\n              }\n              status = 'ready';\n              current = newValue;\n              atom.reportChanged();\n\n              return newValue;\n            }),\n          )\n          .catch((e) => {\n            if (e instanceof AsyncLoadingError) {\n              // still loading, do nothing\n              return;\n            }\n            // TODO \u5904\u7406 error \u72b6\u6001\n            throw e;\n          });\n      });\n    });\n    reaction.schedule_();\n  };\n\n  const stop = () => {\n    if (reaction) {\n      reaction.dispose();\n      reaction = null;\n    }\n  };\n\n  disposers.push(mobx.onBecomeObserved(atom, start));\n  disposers.push(mobx.onBecomeUnobserved(atom, stop));\n  disposers.push(stop);\n\n  return {\n    get status() {\n      return computedStatus.get();\n    },\n    get current() {\n      return computedCurrent.get();\n    },\n    dispose() {\n      for (const fn of disposers) {\n        fn();\n      }\n    },\n    refresh() {\n      _optionalChain([reaction, 'optionalAccess', _2 => _2.onBecomeStale_, 'call', _3 => _3()]);\n    },\n  };\n}",_.__doc_info=E;try{b.displayName="BrowserOnlyReactJson",b.__docgenInfo={description:"",displayName:"BrowserOnlyReactJson",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../story/src/xform/helpers.tsx#BrowserOnlyReactJson"]={docgenInfo:b.__docgenInfo,name:"BrowserOnlyReactJson",path:"../story/src/xform/helpers.tsx#BrowserOnlyReactJson"})}catch(F){}try{h.displayName="ValuePreview",h.__docgenInfo={description:"",displayName:"ValuePreview",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../story/src/xform/helpers.tsx#ValuePreview"]={docgenInfo:h.__docgenInfo,name:"ValuePreview",path:"../story/src/xform/helpers.tsx#ValuePreview"})}catch(F){}try{v.displayName="ValuePrinter",v.__docgenInfo={description:"",displayName:"ValuePrinter",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../story/src/xform/helpers.tsx#ValuePrinter"]={docgenInfo:v.__docgenInfo,name:"ValuePrinter",path:"../story/src/xform/helpers.tsx#ValuePrinter"})}catch(F){}}}]);
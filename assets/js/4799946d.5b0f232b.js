(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{126:function(e,n,t){"use strict";t.r(n),t.d(n,"frontMatter",(function(){return I})),t.d(n,"metadata",(function(){return A})),t.d(n,"toc",(function(){return V})),t.d(n,"default",(function(){return R}));var a=t(3),r=t(7),o=t(0),l=t.n(o),i=t(165),s=t(163),c=t(213),m=t(312);function d({name:e,label:n,...t}){return l.a.createElement("div",Object(a.a)({},t,{style:{border:"1px dashed var(--rex-colors-emphasis-30)",...t.style}}),l.a.createElement("p",{style:{fontWeight:"bold",margin:"12px 0 8px 8px"}},n),l.a.createElement(c.a.Object,{name:e},l.a.createElement(c.c,{component:"input",name:"name",label:"\u59d3\u540d",required:!0}),l.a.createElement(c.c,{component:"input",name:"contact",label:"\u8054\u7cfb\u65b9\u5f0f"}),l.a.createElement(c.c,{component:"singleSelect",name:"address.city",label:"\u5c45\u4f4f\u57ce\u5e02",componentProps:{dataSource:"\u676d\u5dde\uff0c\u4e0a\u6d77\uff0c\u5317\u4eac\uff0c\u6df1\u5733\uff0c\u5e7f\u5dde\uff0c\u6b66\u6c49\uff0c\u6210\u90fd".split("\uff0c"),style:{width:240}}})))}const u={filename:"/Users/feichao.sfc/code/github/alibaba/rex-design/packages/story/src/xform/2-advanced-examples.stories.tsx",loc:{start:{line:8,column:0},end:{line:28,column:1}},name:"PersonForm",value:d,source:'function PersonForm({\n  name,\n  label,\n  ...others\n}) {\n  return (\n    <div {...others} style={{ border: \'1px dashed var(--rex-colors-emphasis-30)\', ...others.style }}>\n      <p style={{ fontWeight: \'bold\', margin: \'12px 0 8px 8px\' }}>{label}</p>\n      <Form.Object name={name}>\n        <FormItem component="input" name="name" label="\u59d3\u540d" required />\n        <FormItem component="input" name="contact" label="\u8054\u7cfb\u65b9\u5f0f" />\n        <FormItem\n          component="singleSelect"\n          name="address.city"\n          label="\u5c45\u4f4f\u57ce\u5e02"\n          componentProps={{ dataSource: \'\u676d\u5dde\uff0c\u4e0a\u6d77\uff0c\u5317\u4eac\uff0c\u6df1\u5733\uff0c\u5e7f\u5dde\uff0c\u6b66\u6c49\uff0c\u6210\u90fd\'.split(\'\uff0c\'), style: { width: 240 } }}\n        />\n      </Form.Object>\n    </div>\n  );\n}',deps:()=>[],provides:{React:l.a,Form:c.a,FormItem:c.c}};function p(){return l.a.createElement(c.a,{defaultValue:{me:{name:"rex design",contact:"alibaba.github.io/rex-design/",address:{city:"\u676d\u5dde"}}}},l.a.createElement("h4",null,"\u5bb6\u5ead\u4fe1\u606f\u767b\u8bb0\u8868"),l.a.createElement("div",{style:{display:"grid",grid:"auto-flow / repeat(auto-fill, minmax(360px, auto))",gap:8}},l.a.createElement(d,{name:"me",label:"\u4e2a\u4eba\u4fe1\u606f"}),l.a.createElement(d,{name:"father",label:"\u7236\u4eb2"}),l.a.createElement(d,{name:"mother",label:"\u6bcd\u4eb2"}),l.a.createElement(d,{name:"other",label:"\u5176\u4ed6\u7d27\u6025\u8054\u7cfb\u4eba"})),l.a.createElement(m.a,null))}const b={filename:"/Users/feichao.sfc/code/github/alibaba/rex-design/packages/story/src/xform/2-advanced-examples.stories.tsx",loc:{start:{line:30,column:7},end:{line:52,column:1}},name:"ObjectExample",value:p,source:'function ObjectExample() {\n  return (\n    <Form\n      defaultValue={{\n        me: {\n          name: \'rex design\',\n          contact: \'alibaba.github.io/rex-design/\',\n          address: { city: \'\u676d\u5dde\' },\n        },\n      }}\n    >\n      <h4>\u5bb6\u5ead\u4fe1\u606f\u767b\u8bb0\u8868</h4>\n      <div style={{ display: \'grid\', grid: \'auto-flow / repeat(auto-fill, minmax(360px, auto))\', gap: 8 }}>\n        <PersonForm name="me" label="\u4e2a\u4eba\u4fe1\u606f" />\n        <PersonForm name="father" label="\u7236\u4eb2" />\n        <PersonForm name="mother" label="\u6bcd\u4eb2" />\n        <PersonForm name="other" label="\u5176\u4ed6\u7d27\u6025\u8054\u7cfb\u4eba" />\n      </div>\n\n      <ValuePreview />\n    </Form>\n  );\n}',deps:()=>[u],provides:{Form:c.a,ValuePreview:m.a}};p.__doc_info=b,p.__inner_source='function ObjectExample() {\n  return (\n    <Form\n      defaultValue={{\n        me: {\n          name: \'rex design\',\n          contact: \'alibaba.github.io/rex-design/\',\n          address: { city: \'\u676d\u5dde\' },\n        },\n      }}\n    >\n      <h4>\u5bb6\u5ead\u4fe1\u606f\u767b\u8bb0\u8868</h4>\n      <div style={{ display: \'grid\', grid: \'auto-flow / repeat(auto-fill, minmax(360px, auto))\', gap: 8 }}>\n        <PersonForm name="me" label="\u4e2a\u4eba\u4fe1\u606f" />\n        <PersonForm name="father" label="\u7236\u4eb2" />\n        <PersonForm name="mother" label="\u6bcd\u4eb2" />\n        <PersonForm name="other" label="\u5176\u4ed6\u7d27\u6025\u8054\u7cfb\u4eba" />\n      </div>\n\n      <ValuePreview />\n    </Form>\n  );\n}';const f=["\u97e9\u90fd\u8863\u820d","ZARA","\u4f18\u8863\u5e93","\u592a\u5e73\u9e1f"],y={filename:"/Users/feichao.sfc/code/github/alibaba/rex-design/packages/story/src/xform/2-advanced-examples.stories.tsx",loc:{start:{line:54,column:0},end:{line:54,column:46}},name:"BRANDS",value:f,source:"const BRANDS = ['\u97e9\u90fd\u8863\u820d', 'ZARA', '\u4f18\u8863\u5e93', '\u592a\u5e73\u9e1f'];",deps:()=>[],provides:{}},h="\u901a\u52e4\uff0c\u767e\u642d\uff0c\u65f6\u5c1a\uff0c\u4f11\u95f2\uff0c\u539f\u521b\u8bbe\u8ba1\uff0c\u590d\u53e4\uff0c\u6c11\u65cf\u98ce\uff0c\u4f18\u96c5\uff0c\u6027\u611f\uff0c\u6734\u5b9e\uff0c\u5c45\u5bb6".split("\uff0c"),g={filename:"/Users/feichao.sfc/code/github/alibaba/rex-design/packages/story/src/xform/2-advanced-examples.stories.tsx",loc:{start:{line:55,column:0},end:{line:55,column:64}},name:"STYLES",value:h,source:"const STYLES = '\u901a\u52e4\uff0c\u767e\u642d\uff0c\u65f6\u5c1a\uff0c\u4f11\u95f2\uff0c\u539f\u521b\u8bbe\u8ba1\uff0c\u590d\u53e4\uff0c\u6c11\u65cf\u98ce\uff0c\u4f18\u96c5\uff0c\u6027\u611f\uff0c\u6734\u5b9e\uff0c\u5c45\u5bb6'.split('\uff0c');",deps:()=>[],provides:{}};function O(e){s.Toaster.show({content:l.a.createElement("div",null,l.a.createElement("p",{style:{marginBottom:4,color:"--rex-colors-green-60"}},"\u6b63\u5728\u63d0\u4ea4..."),l.a.createElement("span",{style:{fontFamily:"monospace"}},JSON.stringify(e,null,2)))})}const v={filename:"/Users/feichao.sfc/code/github/alibaba/rex-design/packages/story/src/xform/2-advanced-examples.stories.tsx",loc:{start:{line:57,column:0},end:{line:66,column:1}},name:"showSubmitToast",value:O,source:"function showSubmitToast(values) {\n  Toaster.show({\n    content: (\n      <div>\n        <p style={{ marginBottom: 4, color: '--rex-colors-green-60' }}>\u6b63\u5728\u63d0\u4ea4...</p>\n        <span style={{ fontFamily: 'monospace' }}>{JSON.stringify(values, null, 2)}</span>\n      </div>\n    ),\n  });\n}",deps:()=>[],provides:{Toaster:s.Toaster}};function S(e){s.Toaster.show({content:l.a.createElement("div",null,l.a.createElement("p",{style:{marginBottom:4,color:"var(--rex-colors-red-60)"}},"\u8868\u5355\u4e2d\u5305\u542b\u9519\u8bef\uff01"),l.a.createElement("span",{style:{fontFamily:"monospace"}},JSON.stringify(e,null,2)))})}const F={filename:"/Users/feichao.sfc/code/github/alibaba/rex-design/packages/story/src/xform/2-advanced-examples.stories.tsx",loc:{start:{line:68,column:0},end:{line:77,column:1}},name:"showErrorToast",value:S,source:"function showErrorToast(errors) {\n  Toaster.show({\n    content: (\n      <div>\n        <p style={{ marginBottom: 4, color: 'var(--rex-colors-red-60)' }}>\u8868\u5355\u4e2d\u5305\u542b\u9519\u8bef\uff01</p>\n        <span style={{ fontFamily: 'monospace' }}>{JSON.stringify(errors, null, 2)}</span>\n      </div>\n    ),\n  });\n}",deps:()=>[],provides:{Toaster:s.Toaster}};function x(){return l.a.createElement(c.a,{defaultValue:{tickets:[{name:"feichao",date:Object(s.dayjs)().format("YYYY-MM-DD")}]},onSubmit:e=>{console.log("onSubmit:",e),O(e)},onError:e=>{console.log("onError:",e),S(e)},onReset:e=>{e.values={tickets:[{name:"feichao",date:Object(s.dayjs)().format("YYYY-MM-DD")}]}}},l.a.createElement("h4",null,"\u5ba2\u6237\u6ee1\u610f\u5ea6\u8c03\u67e5\u5217\u8868"),l.a.createElement(c.a.Array,{name:"tickets",layout:Object(c.e)({showItemOrder:!0})},l.a.createElement(c.c,{component:"input",label:"\u5ba2\u6237\u540d\u79f0",name:"name",required:!0,componentProps:{style:{maxWidth:200}}}),l.a.createElement(c.c,{component:"datePicker",label:"\u8d2d\u4e70\u65e5\u671f",name:"date",required:!0}),l.a.createElement(c.c,{component:"testButtonGroup",label:"\u54c1\u724c",name:"brand",componentProps:{items:f},required:!0}),l.a.createElement(c.c,{component:"singleSelect",label:"\u98ce\u683c",name:"style",required:!0,componentProps:{dataSource:h,style:{maxWidth:200}}}),l.a.createElement(c.c,{component:"testButtonGroup",name:"satisfaction",label:"\u5ba2\u6237\u6ee1\u610f\u5ea6",required:!0,componentProps:{items:"\u975e\u5e38\u6ee1\u610f\uff0c\u6ee1\u610f\uff0c\u57fa\u672c\u6ee1\u610f\uff0c\u4e0d\u6ee1\u610f\uff0c\u975e\u5e38\u4e0d\u6ee1\u610f".split("\uff0c")}}),l.a.createElement(c.c,{component:"input",label:"\u5ba2\u6237\u8054\u7cfb\u65b9\u5f0f",name:"contact",componentProps:{style:{maxWidth:200}}}),l.a.createElement(c.c,{component:"input",label:"\u5ba2\u6237\u8054\u7cfb\u5730\u5740",name:"address"})),l.a.createElement(s.Group,{mt:"m"},l.a.createElement(c.a.Submit,null),l.a.createElement(c.a.Reset,null)),l.a.createElement(m.a,null))}const E={filename:"/Users/feichao.sfc/code/github/alibaba/rex-design/packages/story/src/xform/2-advanced-examples.stories.tsx",loc:{start:{line:79,column:7},end:{line:132,column:1}},name:"ArrayExample",value:x,source:'function ArrayExample() {\n  return (\n    <Form\n      defaultValue={{ tickets: [{ name: \'feichao\', date: dayjs().format(\'YYYY-MM-DD\') }] }}\n      onSubmit={(values) => {\n        console.log(\'onSubmit:\', values);\n        showSubmitToast(values);\n      }}\n      onError={(errors) => {\n        console.log(\'onError:\', errors);\n        showErrorToast(errors);\n      }}\n      onReset={(model) => {\n        model.values = { tickets: [{ name: \'feichao\', date: dayjs().format(\'YYYY-MM-DD\') }] };\n      }}\n    >\n      <h4>\u5ba2\u6237\u6ee1\u610f\u5ea6\u8c03\u67e5\u5217\u8868</h4>\n      <Form.Array name="tickets" layout={arrayCard({ showItemOrder: true })}>\n        <FormItem\n          component="input"\n          label="\u5ba2\u6237\u540d\u79f0"\n          name="name"\n          required\n          componentProps={{ style: { maxWidth: 200 } }}\n        />\n        <FormItem component="datePicker" label="\u8d2d\u4e70\u65e5\u671f" name="date" required />\n        <FormItem component="testButtonGroup" label="\u54c1\u724c" name="brand" componentProps={{ items: BRANDS }} required />\n        <FormItem\n          component="singleSelect"\n          label="\u98ce\u683c"\n          name="style"\n          required\n          componentProps={{ dataSource: STYLES, style: { maxWidth: 200 } }}\n        />\n        <FormItem\n          component="testButtonGroup"\n          name="satisfaction"\n          label="\u5ba2\u6237\u6ee1\u610f\u5ea6"\n          required\n          componentProps={{ items: \'\u975e\u5e38\u6ee1\u610f\uff0c\u6ee1\u610f\uff0c\u57fa\u672c\u6ee1\u610f\uff0c\u4e0d\u6ee1\u610f\uff0c\u975e\u5e38\u4e0d\u6ee1\u610f\'.split(\'\uff0c\') }}\n        />\n        <FormItem component="input" label="\u5ba2\u6237\u8054\u7cfb\u65b9\u5f0f" name="contact" componentProps={{ style: { maxWidth: 200 } }} />\n        <FormItem component="input" label="\u5ba2\u6237\u8054\u7cfb\u5730\u5740" name="address" />\n      </Form.Array>\n\n      <Group mt="m">\n        <Form.Submit />\n        <Form.Reset />\n      </Group>\n\n      <ValuePreview />\n    </Form>\n  );\n}',deps:()=>[v,F,y,g],provides:{Form:c.a,dayjs:s.dayjs,arrayCard:c.e,FormItem:c.c,Group:s.Group,ValuePreview:m.a}};function _(){const[e]=Object(o.useState)(new c.d({texts:[]}));return l.a.createElement(c.a,{model:e},l.a.createElement(c.a.Array,{name:"texts",layout:Object(c.e)({showItemOrder:!0}),itemFactory:()=>""},l.a.createElement(c.c,{component:"input",label:"\u59d3\u540d",name:"&",componentProps:{placeholder:"\u8bf7\u8f93\u5165\u4f60\u7684\u540d\u5b57"}})),l.a.createElement(m.a,null))}x.__doc_info=E,x.__inner_source='function ArrayExample() {\n  return (\n    <Form\n      defaultValue={{ tickets: [{ name: \'feichao\', date: dayjs().format(\'YYYY-MM-DD\') }] }}\n      onSubmit={(values) => {\n        console.log(\'onSubmit:\', values);\n        showSubmitToast(values);\n      }}\n      onError={(errors) => {\n        console.log(\'onError:\', errors);\n        showErrorToast(errors);\n      }}\n      onReset={(model) => {\n        model.values = { tickets: [{ name: \'feichao\', date: dayjs().format(\'YYYY-MM-DD\') }] };\n      }}\n    >\n      <h4>\u5ba2\u6237\u6ee1\u610f\u5ea6\u8c03\u67e5\u5217\u8868</h4>\n      <Form.Array name="tickets" layout={arrayCard({ showItemOrder: true })}>\n        <FormItem\n          component="input"\n          label="\u5ba2\u6237\u540d\u79f0"\n          name="name"\n          required\n          componentProps={{ style: { maxWidth: 200 } }}\n        />\n        <FormItem component="datePicker" label="\u8d2d\u4e70\u65e5\u671f" name="date" required />\n        <FormItem component="testButtonGroup" label="\u54c1\u724c" name="brand" componentProps={{ items: BRANDS }} required />\n        <FormItem\n          component="singleSelect"\n          label="\u98ce\u683c"\n          name="style"\n          required\n          componentProps={{ dataSource: STYLES, style: { maxWidth: 200 } }}\n        />\n        <FormItem\n          component="testButtonGroup"\n          name="satisfaction"\n          label="\u5ba2\u6237\u6ee1\u610f\u5ea6"\n          required\n          componentProps={{ items: \'\u975e\u5e38\u6ee1\u610f\uff0c\u6ee1\u610f\uff0c\u57fa\u672c\u6ee1\u610f\uff0c\u4e0d\u6ee1\u610f\uff0c\u975e\u5e38\u4e0d\u6ee1\u610f\'.split(\'\uff0c\') }}\n        />\n        <FormItem component="input" label="\u5ba2\u6237\u8054\u7cfb\u65b9\u5f0f" name="contact" componentProps={{ style: { maxWidth: 200 } }} />\n        <FormItem component="input" label="\u5ba2\u6237\u8054\u7cfb\u5730\u5740" name="address" />\n      </Form.Array>\n\n      <Group mt="m">\n        <Form.Submit />\n        <Form.Reset />\n      </Group>\n\n      <ValuePreview />\n    </Form>\n  );\n}';const j={filename:"/Users/feichao.sfc/code/github/alibaba/rex-design/packages/story/src/xform/2-advanced-examples.stories.tsx",loc:{start:{line:134,column:7},end:{line:145,column:1}},name:"SelfReference",value:_,source:'function SelfReference() {\n  const [root] = useState(new FormModel({ texts: []  }));\n\n  return (\n    <Form model={root}>\n      <Form.Array name="texts" layout={arrayCard({ showItemOrder: true })} itemFactory={() => \'\'}>\n        <FormItem component="input" label="\u59d3\u540d" name="&" componentProps={{ placeholder: \'\u8bf7\u8f93\u5165\u4f60\u7684\u540d\u5b57\' }} />\n      </Form.Array>\n      <ValuePreview />\n    </Form>\n  );\n}',deps:()=>[],provides:{useState:o.useState,FormModel:c.d,Form:c.a,arrayCard:c.e,FormItem:c.c,ValuePreview:m.a}};_.__inner_source='function SelfReference() {\n  const [root] = useState(new FormModel({ texts: []  }));\n\n  return (\n    <Form model={root}>\n      <Form.Array name="texts" layout={arrayCard({ showItemOrder: true })} itemFactory={() => \'\'}>\n        <FormItem component="input" label="\u59d3\u540d" name="&" componentProps={{ placeholder: \'\u8bf7\u8f93\u5165\u4f60\u7684\u540d\u5b57\' }} />\n      </Form.Array>\n      <ValuePreview />\n    </Form>\n  );\n}',_.__doc_info=j;var C,I={id:"advanced",title:"xform \u8fdb\u9636"},A={unversionedId:"xform/advanced",id:"xform/advanced",isDocsHomePage:!1,title:"xform \u8fdb\u9636",description:"\u672c\u9875\u5c06\u4ecb\u7ecd xform \u7684\u4e00\u4e9b\u8fdb\u9636\u7528\u6cd5\uff0c\u5305\u62ec\u8868\u5355\u7247\u6bb5\u590d\u7528\u3001\u6570\u7ec4\u7c7b\u578b\u8868\u5355\u3001\u5d4c\u5957\u8868\u5355\u6570\u636e\u7ed3\u6784\u7b49\u3002",source:"@site/docs/xform/advanced.mdx",sourceDirName:"xform",slug:"/xform/advanced",permalink:"/rex-design/docs/xform/advanced",editUrl:"https://github.com/alibaba/rex-design/edit/main/packages/doc/docs/xform/advanced.mdx",version:"current",frontMatter:{id:"advanced",title:"xform \u8fdb\u9636"},sidebar:"docs",previous:{title:"xform",permalink:"/rex-design/docs/xform/usage"},next:{title:"xform \u4e1a\u52a1\u793a\u4f8b",permalink:"/rex-design/docs/xform/biz"}},V=[{value:"\u8868\u5355\u7247\u6bb5\u590d\u7528",id:"\u8868\u5355\u7247\u6bb5\u590d\u7528",children:[{value:"<code>Form.Object</code>",id:"formobject",children:[]}]},{value:"\u5217\u8868\u7c7b\u578b\u7684\u6570\u636e",id:"\u5217\u8868\u7c7b\u578b\u7684\u6570\u636e",children:[{value:"<code>Form.Array</code>",id:"formarray",children:[]}]},{value:"\u5904\u7406\u5d4c\u5957\u6570\u636e\u7ed3\u6784",id:"\u5904\u7406\u5d4c\u5957\u6570\u636e\u7ed3\u6784",children:[{value:"\u793a\u4f8b 1",id:"\u793a\u4f8b-1",children:[]}]},{value:"\u63a5\u5165\u81ea\u5b9a\u4e49\u7ec4\u4ef6",id:"\u63a5\u5165\u81ea\u5b9a\u4e49\u7ec4\u4ef6",children:[{value:"\u89c6\u56fe\u63a5\u5165",id:"\u89c6\u56fe\u63a5\u5165",children:[]},{value:"\u81ea\u5b9a\u4e49\u7684\u8868\u5355\u7ec4\u4ef6",id:"\u81ea\u5b9a\u4e49\u7684\u8868\u5355\u7ec4\u4ef6",children:[]},{value:"\u6ce8\u518c\u4e3a\u5185\u7f6e\u8868\u5355\u7ec4\u4ef6",id:"\u6ce8\u518c\u4e3a\u5185\u7f6e\u8868\u5355\u7ec4\u4ef6",children:[]}]},{value:"\u76f8\u540c\u6570\u636e\u7d22\u5f15\u5bf9\u5e94\u591a\u4e2a\u89c6\u56fe",id:"\u76f8\u540c\u6570\u636e\u7d22\u5f15\u5bf9\u5e94\u591a\u4e2a\u89c6\u56fe",children:[{value:"fork field \u7279\u70b9",id:"fork-field-\u7279\u70b9",children:[]}]},{value:"\u5f02\u6b65\u6570\u636e\u6e90",id:"\u5f02\u6b65\u6570\u636e\u6e90",children:[]},{value:"\u590d\u6742\u8054\u52a8",id:"\u590d\u6742\u8054\u52a8",children:[]}],w=(C="Story",function(e){return console.warn("Component "+C+" was not imported, exported, or provided by MDXProvider as global scope"),Object(i.b)("div",e)}),N={toc:V};function R(e){var n=e.components,t=Object(r.a)(e,["components"]);return Object(i.b)("wrapper",Object(a.a)({},N,t,{components:n,mdxType:"MDXLayout"}),Object(i.b)("p",null,"\u672c\u9875\u5c06\u4ecb\u7ecd xform \u7684\u4e00\u4e9b\u8fdb\u9636\u7528\u6cd5\uff0c\u5305\u62ec\u8868\u5355\u7247\u6bb5\u590d\u7528\u3001\u6570\u7ec4\u7c7b\u578b\u8868\u5355\u3001\u5d4c\u5957\u8868\u5355\u6570\u636e\u7ed3\u6784\u7b49\u3002"),Object(i.b)("div",{className:"admonition admonition-danger alert alert--danger"},Object(i.b)("div",{parentName:"div",className:"admonition-heading"},Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",{parentName:"h5",className:"admonition-icon"},Object(i.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},Object(i.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"danger")),Object(i.b)("div",{parentName:"div",className:"admonition-content"},Object(i.b)("p",{parentName:"div"},"\u6587\u6863\u5185\u5bb9\u8f83\u591a\uff0c\u4e66\u5199\u9f9f\u901f\uff0c\u76ee\u524d\u8fd8\u975e\u5e38\u7c97\u7cd9\u3002"))),Object(i.b)("h2",{id:"\u8868\u5355\u7247\u6bb5\u590d\u7528"},"\u8868\u5355\u7247\u6bb5\u590d\u7528"),Object(i.b)("p",null,"\u5148\u770b\u4ee5\u4e0b\u793a\u4f8b\uff0c\u5728\u5bb6\u5ead\u4fe1\u606f\u767b\u8bb0\u8868\u4e2d\uff0c\u300c\u4e2a\u4eba\u4fe1\u606f\u300d\u3001\u300c\u7236\u4eb2\u300d\u7b49\u90e8\u5206\u7684\u8868\u5355\u5185\u5bb9\u662f\u5b8c\u5168\u76f8\u540c\u7684\uff0c\u4f46\u5b83\u4eec\u7684\u6570\u636e\u5b58\u653e\u8def\u5f84\u4e0d\u540c\u3002"),Object(i.b)("p",null,"\u6b64\u65f6\u6211\u4eec\u5c06\u8868\u5355\u4e2d\u7684\u76f8\u540c\u90e8\u5206\u62bd\u53d6\u5230 PersonForm \u4e2d\uff0c\u5e76\u5229\u7528 Form.Object \u6765\u6307\u5b9a\u5176\u4e2d\u7684 FormItem \u7684",Object(i.b)("strong",{parentName:"p"},"\u6570\u636e\u7d22\u5f15\u524d\u7f00"),"\u3002 \u5728 FamilyForm \u4e2d\uff0c\u6211\u4eec\u4e3a\u591a\u4e2a PersonForm \u6307\u5b9a\u4e0d\u540c\u7684 name\uff0c\u5373\u53ef\u5b9e\u73b0\u8868\u5355\u7247\u6bb5\u7684\u590d\u7528\u3002 \u5728\u66f4\u590d\u6742\u7684\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u53ef\u4ee5\u4e3a PersonForm \u6dfb\u52a0\u66f4\u591a props\uff0c\u4f7f\u7247\u6bb5\u590d\u7528\u53d8\u5f97\u66f4\u52a0\u7075\u6d3b\u3002"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-jsx"},'function PersonForm({ name, label }) {\n  return (\n    <div>\n      <p>{label}</p>\n      <Form.Object name={name}>\n        <FormItem name="name" label="\u59d3\u540d" required />\n        <FormItem name="contact" label="\u8054\u7cfb\u65b9\u5f0f" />\n        <FormItem name="address.city" label="\u5c45\u4f4f\u57ce\u5e02" />\n      </Form.Object>\n    </div>\n  );\n}\n\nfunction FamilyForm() {\n  return (\n    <div>\n      <PersonForm name="me" label="\u4e2a\u4eba\u4fe1\u606f" />\n      <PersonForm name="father" label="\u7236\u4eb2" />\n      <PersonForm name="mother" label="\u6bcd\u4eb2" />\n      <PersonForm name="other" label="\u5176\u4ed6\u7d27\u6025\u8054\u7cfb\u4eba" />\n    </div>\n  );\n}\n')),Object(i.b)(w,{fn:p,mdxType:"Story"}),Object(i.b)("h3",{id:"formobject"},Object(i.b)("inlineCode",{parentName:"h3"},"Form.Object")),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"<Form.Object name={name} />"),"\uff1a \u4ee5\u5f53\u524d model \u4e3a\u57fa\u7840\uff0c\u4e3a\u5176\u5b50\u8282\u70b9\u63d0\u4f9b\u4e00\u4e2a\u65b0\u7684 sub model\uff0c\u5e76\u5c06\u5b50\u8282\u70b9\u4e2d\u7684\u8868\u5355\u503c\u6536\u96c6\u5230\u5f53\u524d model \u4e2d ",Object(i.b)("inlineCode",{parentName:"p"},"name")," \u5bf9\u5e94\u7684\u4f4d\u7f6e\u3002"),Object(i.b)("p",null,"\u4e3a Form.Object \u8bbe\u7f6e ",Object(i.b)("inlineCode",{parentName:"p"},'name="&"')," \u65f6\uff0c\u53ef\u4ee5\u5c06\u5f53\u524d model \u900f\u4f20\u81f3\u5b50\u8282\u70b9\uff08\u76f8\u5f53\u4e8e\u6ca1\u5199 Form.Object\uff09\u3002"),Object(i.b)("h2",{id:"\u5217\u8868\u7c7b\u578b\u7684\u6570\u636e"},"\u5217\u8868\u7c7b\u578b\u7684\u6570\u636e"),Object(i.b)("p",null,"\u6211\u4eec\u53ef\u4ee5\u5229\u7528 ",Object(i.b)("inlineCode",{parentName:"p"},"Form.Array")," \u6765\u5904\u7406\u5217\u8868\u7c7b\u578b\u7684\u6570\u636e\u3002"),Object(i.b)("p",null,"\u4f8b\u5982\uff0c\u5728\u4e0b\u9762\u7684\u300c\u5ba2\u6237\u6ee1\u610f\u5ea6\u8c03\u67e5\u5217\u8868\u300d\u4e2d\uff0c\u6211\u4eec\u7528 Form.Array \u5305\u88f9\u4e86\u591a\u4e2a FormItem\u3002"),Object(i.b)("p",null,"\u4ece Form.Array \u8fd9\u4e2a\u540d\u5b57\u4e2d\u4e5f\u53ef\u4ee5\u770b\u51fa\uff0c\u8868\u5355\u63d0\u4ea4\u65f6\u5c06\u4f1a\u751f\u6210\u4e00\u4e2a\u6570\u7ec4\uff0c\u6570\u7ec4\u4e2d\u6bcf\u4e2a\u5143\u7d20\u5305\u542b name\uff0cdate\uff0cbrand \u7b49\u5b57\u6bb5\u3002"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-jsx"},'<Form.Array name="tickets" layout={arrayCard({ showItemOrder: true })}>\n  <FormItem label="\u5ba2\u6237\u540d\u79f0" name="name" />\n  <FormItem label="\u8d2d\u4e70\u65e5\u671f" name="date" />\n  <FormItem label="\u54c1\u724c" name="brand" />\n  {/* \u5176\u4ed6\u8c03\u67e5\u7ed3\u679c\u8868\u5355\u5185\u5bb9 */}\n</Form.Array>\n')),Object(i.b)(w,{fn:x,mdxType:"Story"}),Object(i.b)("h3",{id:"formarray"},Object(i.b)("inlineCode",{parentName:"h3"},"Form.Array")),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"<Form.Array name={name} itemFactory={itemFactory} layout={layout} />")),Object(i.b)("p",null,"Form.Array \u4f1a\u6839\u636e\u5217\u8868\u957f\u5ea6\uff08\u5373 ",Object(i.b)("inlineCode",{parentName:"p"},"model.values.length"),"\uff09\uff0c\u6e32\u67d3\u540c\u6837\u6b21\u6570\u7684\u5b50\u8282\u70b9\uff08\u6307 props.children\uff09\u3002Form.Array \u4f1a\u4ee5\u5f53\u524d model \u4e3a\u57fa\u7840\uff0c\u4e3a\u5176\u5b50\u8282\u70b9\u63d0\u4f9b\u4e00\u4e2a\u65b0\u7684 sub model\uff0c\u5e76\u5c06\u5b50\u8282\u70b9\u4e2d\u7684\u8868\u5355\u503c\u6536\u96c6\u5230\u5f53\u524d model \u4e2d ",Object(i.b)("inlineCode",{parentName:"p"},"{name}.{itemIndex}")," \u5bf9\u5e94\u7684\u4f4d\u7f6e\u3002"),Object(i.b)("p",null,"Form.Array \u4e0e Form.Object \u975e\u5e38\u7c7b\u4f3c\uff0c\u4f46\u7528\u4e8e\u5904\u7406\u6570\u7ec4\u3002 \u6ce8\u610f Form.Array \u4e3a\u5176\u5b50\u8282\u70b9\u63d0\u4f9b\u7684 sub model \u5305\u542b\u4e24\u5c42\u4e0b\u6807 ",Object(i.b)("inlineCode",{parentName:"p"},"{name}.{itemIndex}"),"\uff1a ",Object(i.b)("inlineCode",{parentName:"p"},"name")," \u8868\u793a\u6570\u7ec4\u6240\u5728\u7684\u5b57\u6bb5\u540d\u79f0\uff0c ",Object(i.b)("inlineCode",{parentName:"p"},"itemIndex")," \u8868\u793a\u6570\u7ec4\u5143\u7d20\u4e0b\u6807\u3002"),Object(i.b)("p",null,"\u5176\u4ed6\u53c2\u6570\uff1a"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"layout")," \u63a7\u5236\u8868\u5355\u5982\u4f55\u5bf9\u6570\u7ec4\u8fdb\u884c\u5e03\u5c40\uff0c\u5305\u62ec\u6570\u7ec4\u4e2d\u6bcf\u4e00\u4e2a\u5143\u7d20\u7684\u5e03\u5c40 \u4ee5\u53ca \u76f8\u5173\u7684\u64cd\u4f5c\u6309\u94ae\uff08\u6dfb\u52a0\u3001\u5220\u9664\u3001\u4e0a\u79fb\u3001\u4e0b\u79fb\u7b49\uff09",Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},"xform \u63d0\u4f9b\u4e00\u4e9b\u5185\u7f6e\u7684\u6570\u7ec4\u5e03\u5c40\uff0c\u5982\u679c\u4e0d\u6ee1\u8db3\u4f60\u7684\u9700\u6c42\uff0c\u4f60\u4e5f\u53ef\u4ee5\u5728\u4e0a\u5c42\u5b9e\u73b0\u65b0\u7684\u6570\u7ec4\u5e03\u5c40"),Object(i.b)("li",{parentName:"ul"},"\u548c Form.Object \u4e00\u6837\uff0cForm.Array \u672c\u8eab\u4e0d\u4f1a\u63d0\u4f9b\u4efb\u4f55\u5e03\u5c40"))),Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"itemFactory")," \u7528\u4e8e\u8bbe\u7f6e\u6570\u7ec4\u4e2d\u65b0\u589e\u5143\u7d20\u7684\u521d\u59cb\u503c")),Object(i.b)("h2",{id:"\u5904\u7406\u5d4c\u5957\u6570\u636e\u7ed3\u6784"},"\u5904\u7406\u5d4c\u5957\u6570\u636e\u7ed3\u6784"),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"Form.Object")," \u4e0e ",Object(i.b)("inlineCode",{parentName:"p"},"Form.Array")," \u5141\u8bb8\u76f8\u4e92\u5d4c\u5957\uff0c\u7075\u6d3b\u4f7f\u7528\u4e24\u8005\uff0c\u6211\u4eec\u53ef\u4ee5\u7ec4\u5408\u51fa\u975e\u5e38\u590d\u6742\u7684\u8868\u5355\u7ed3\u6784\u3002"),Object(i.b)("p",null,"\u800c\u5728\u6570\u636e\u5904\u7406\u65b9\u9762\uff0c xform \u63d0\u4f9b\u4e86\u975e\u5e38\u7075\u6d3b\u7684\u3001\u300c\u5206\u5f62\u300d\u7684 API\u3002"),Object(i.b)("p",null,"\u901a\u8fc7 ",Object(i.b)("inlineCode",{parentName:"p"},"new FormModel(values)")," \u521b\u5efa formModel \u4e4b\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 ",Object(i.b)("inlineCode",{parentName:"p"},"formModel.getSubModel(name)")," \u6765\u83b7\u53d6 ",Object(i.b)("inlineCode",{parentName:"p"},"name")," \u5bf9\u5e94\u7684\u5b50\u6a21\u578b subModel\uff0c\u5bf9 subModel.values \u7684\u8bfb\u5199\u4f1a\u81ea\u52a8\u53d8\u4e3a\u5bf9 formModel.values \u7684\u8bfb\u5199\uff08\u80cc\u540e\u57fa\u4e8e mobx computed\uff09\uff0c\u786e\u4fdd formModel.values \u662f\u6574\u4e2a\u8868\u5355 values \u7684\u552f\u4e00\u53ef\u4fe1\u6765\u6e90\u3002"),Object(i.b)("p",null,"FormModel\uff08\u6839\u8282\u70b9\uff09\u548c SubModel\uff08\u5b50\u8282\u70b9\uff09\u5747\u5b9e\u73b0\u4e86 ",Object(i.b)("a",{parentName:"p",href:"api#imodel"},Object(i.b)("inlineCode",{parentName:"a"},"IModel")," interface"),"\uff0c\u4e24\u8005\u62e5\u6709\u51e0\u4e4e\u76f8\u540c\u7684\u65b9\u6cd5\u548c\u5c5e\u6027\u3002\u5927\u90e8\u5206\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u4e0d\u9700\u8981\u533a\u5206 FormModel \u6216 SubModel\u3002\u901a\u8fc7 ",Object(i.b)("inlineCode",{parentName:"p"},"IModel#getSubModel")," \u65b9\u6cd5\uff0c\u6211\u4eec\u53ef\u4ee5\u83b7\u53d6\u5b50\u6a21\u578b\u7684\u5b50\u6a21\u578b\uff0c\u751a\u81f3\u662f\u5b50\u6a21\u578b\u7684\u5b50\u6a21\u578b\u7684\u5b50\u6a21\u578b\u2026\u2026 \u5728\u5b9e\u9645\u8fdb\u884c\u5f00\u53d1\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u6839\u636e\u60c5\u51b5\u7075\u6d3b\u9009\u53d6\u5b50\u6a21\u578b\uff0c\u7136\u540e\u5728\u9002\u5f53\u7684\u6570\u636e\u5c42\u7ea7\u8fdb\u884c\u5f00\u53d1\u3002"),Object(i.b)("h3",{id:"\u793a\u4f8b-1"},"\u793a\u4f8b 1"),Object(i.b)("p",null,"\u6211\u4eec\u53ef\u4ee5\u7528\u4e00\u4e2a FormModel \u6765\u7ba1\u7406\u300c\u5206\u6b65\u8868\u5355\u300d\u3002"),Object(i.b)("p",null,"\u867d\u7136\u8fd9\u79cd\u65b9\u5f0f\u5e76\u4e0d\u5e38\u89c1\uff0c\u4f46\u5b83\u6709\u4e00\u4e9b\u72ec\u7279\u7684\u4f18\u52bf\uff1a"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"\u590d\u7528\u4e86\u8868\u5355\u5df2\u6709\u7684\u63d0\u4ea4\u6309\u94ae\uff08Form.Submit\uff09\u548c\u63d0\u4ea4\u6210\u529f\u56de\u8c03\uff08onSubmit\uff09\uff0c\u5feb\u901f\u5b9e\u73b0\u300c\u70b9\u51fb\u4e0b\u4e00\u6b65\u89e6\u53d1\u6821\u9a8c\uff0c\u6821\u9a8c\u901a\u8fc7\u540e\u8df3\u8f6c\u5230\u4e0b\u4e00\u6b65\u300d\u529f\u80fd"),Object(i.b)("li",{parentName:"ul"},"\u53ef\u4ee5\u901a\u8fc7 root \u6765\u8fdb\u884c\u5168\u5c40\u7ba1\u7406\uff0c\u4f8b\u5982\u2026\u2026",Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},"\u8c03\u7528 ",Object(i.b)("inlineCode",{parentName:"li"},"modelUtils.reset(root)")," \u6765\u91cd\u7f6e\u6240\u6709\u6b65\u9aa4"),Object(i.b)("li",{parentName:"ul"},"root.values \u8bb0\u5f55\u4e86\u6574\u4f53\u6570\u636e\uff0c\u5411\u540e\u7aef\u53d1\u9001\u8bf7\u6c42\u65f6\u53ea\u9700\u8981\u53d1\u9001 root.values \u5373\u53ef")))),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-jsx"},'const root = new FormModel({ step1: {}, step2: {}, step3: {} });\n\n// STEP-1 Component\n<Step>\n  <Form model={root.getSubModel(\'step1\')} onSubmit={jumpToStep2}>\n    <FormItem name="foo" />\n    <FormItem name="bar" />\n    <Form.Submit>\u4e0b\u4e00\u6b65</Form.Submit>\n  </Form>\n</Step>;\n\n// STEP-2 Component\n<Step>\n  <Form model={root.getSubModel(\'step2\')} onSubmit={jumpToStep3}>\n    <FormItem name="hello" />\n    <FormItem name="world" />\n    <Form.Submit>\u4e0b\u4e00\u6b65</Form.Submit>\n  </Form>\n</Step>;\n\n// STEP-3 Component \u7701\u7565\u4ee3\u7801\n')),Object(i.b)("p",null,"(todo \u66f4\u5b8c\u5584\u7684\u4ecb\u7ecd)"),Object(i.b)("h2",{id:"\u63a5\u5165\u81ea\u5b9a\u4e49\u7ec4\u4ef6"},"\u63a5\u5165\u81ea\u5b9a\u4e49\u7ec4\u4ef6"),Object(i.b)("p",null,"\u968f\u7740\u4e1a\u52a1\u9700\u6c42\u53d8\u5f97\u590d\u6742\uff0cxform \u81ea\u5e26\u7684\u8868\u5355\u7ec4\u4ef6\u4e5f\u8bb8\u5c06\u65e0\u6cd5\u6ee1\u8db3\u4f60\u7684\u9700\u6c42\uff0c\u6b64\u65f6\u4f60\u53ef\u4ee5\u901a\u8fc7\u63a5\u5165\u81ea\u5b9a\u4e49\u7ec4\u4ef6\u6765\u62d3\u5c55 xform\u3002"),Object(i.b)("h3",{id:"\u89c6\u56fe\u63a5\u5165"},"\u89c6\u56fe\u63a5\u5165"),Object(i.b)("p",null,"\u5f53\u81ea\u5b9a\u4e49\u7ec4\u4ef6\u4e0d\u9700\u8981\u63a5\u5165\u8868\u5355\u5185\u90e8\u7684\u6821\u9a8c\u7cfb\u7edf\u65f6\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528 ",Object(i.b)("a",{parentName:"p",href:"api#formitemview"},Object(i.b)("inlineCode",{parentName:"a"},"<Form.ItemView />"))," \u6765\u63a5\u5165\u8868\u5355\u5e03\u5c40\uff0c\u8ba9\u81ea\u5b9a\u4e49\u5185\u5bb9\u4e0e\u666e\u901a FormItem \u5c55\u793a\u4e00\u81f4\u3002\u6b64\u65f6\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7 ",Object(i.b)("a",{parentName:"p",href:"api#field"},"Field")," \u6765\u4e3a\u81ea\u5b9a\u4e49\u7ec4\u4ef6\u8bbe\u7f6e value/onChange\uff1a"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-jsx"},'const cityField = model.getField(\'city\');\n\n<Form model={model}>\n  <FormItem component="input" name="foo" />\n  <FormItem component="select" name="bar" />\n  <FormItemView label="\u57ce\u5e02" tip="\u8bf7\u9009\u62e9\u4f60\u7684\u5c45\u4f4f\u57ce\u5e02" asterisk={true} error="\u5fc5\u987b\u9009\u62e9\u9646\u5730">\n    <MyPowerCitySelect selectdCity={cityField.value} onChangeSelectedCity={cityField.handleChange} />\n  </FormItemView>\n</Form>;\n')),Object(i.b)("h3",{id:"\u81ea\u5b9a\u4e49\u7684\u8868\u5355\u7ec4\u4ef6"},"\u81ea\u5b9a\u4e49\u7684\u8868\u5355\u7ec4\u4ef6"),Object(i.b)("p",null,"\u901a\u8fc7 createFormItem \u4f60\u53ef\u4ee5\u521b\u5efa\u5168\u65b0\u7684\u8868\u5355\u7ec4\u4ef6\u3002\u521b\u5efa\u540e\uff0c\u53ef\u4ee5\u50cf\u666e\u901a\u7684 FormItem \u4e00\u6837\u6765\u4f7f\u7528\u81ea\u5b9a\u4e49\u7684\u8868\u5355\u7ec4\u4ef6\uff0c\u6bd4\u5982\u901a\u8fc7 name \u6765\u6307\u5b9a\u6240\u8981\u7ed1\u5b9a\u7684\u6570\u636e\u7d22\u5f15\uff0c\u901a\u8fc7 validate \u6765\u8bbe\u7f6e\u6821\u9a8c\u65b9\u6cd5\u7b49\u3002"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-jsx"},'// \u521b\u5efa\nconst PowerCityFormItem = createFormItem({\n  name: \'powerCitySelect\',\n  fallbackValue: null,\n  isEmpty: () => false,\n  render({ value, onChange }) {\n    return <MyPowerCitySelect selectdCity={value} onChangeSelectedCity={onChange} />;\n  },\n});\n\n// \u4f7f\u7528\n<Form model={model}>\n  <FormItem component="input" name="foo" />\n  <FormItem component="select" name="bar" />\n  <PowerCityFormItem name="city" required validate={isBeautifulCity} validateOnChange={false} />\n</Form>;\n')),Object(i.b)("h3",{id:"\u6ce8\u518c\u4e3a\u5185\u7f6e\u8868\u5355\u7ec4\u4ef6"},"\u6ce8\u518c\u4e3a\u5185\u7f6e\u8868\u5355\u7ec4\u4ef6"),Object(i.b)("p",null,"\u5982\u679c\u4f60\u671f\u671b\u81ea\u5b9a\u4e49\u7ec4\u4ef6\u4ee5 ",Object(i.b)("inlineCode",{parentName:"p"},'<FormItem component="powerCitySelect" name="..." />')," \u7684\u5f62\u5f0f\u88ab\u4f7f\u7528\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7 ",Object(i.b)("inlineCode",{parentName:"p"},"FormItem.register(...)")," \u6765\u8fdb\u884c\u6ce8\u518c\u3002\u65b0\u6ce8\u518c\u7684\u540d\u79f0\u4f1a\u4e0e\u5df2\u6709\u7684\u540d\u79f0\u5171\u4eab\u4e00\u4e2a\u547d\u540d\u7a7a\u95f4\uff0c\u6ce8\u610f\u907f\u514d\u51b2\u7a81\u3002"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-jsx"},'// \u6ce8\u518c\nFormItem.register({\n  name: \'powerCitySelect\',\n  fallbackValue: null,\n  isEmpty: () => false,\n  render: ___,\n});\n\n// \u4f7f\u7528\n<Form model={model}>\n  <FormItem component="input" name="foo" />\n  <FormItem component="select" name="bar" />\n  <FormItem component="powerCitySelect" name="city" required validate={isBeautifulCity} validateOnChange={false} />\n</Form>;\n')),Object(i.b)("h2",{id:"\u76f8\u540c\u6570\u636e\u7d22\u5f15\u5bf9\u5e94\u591a\u4e2a\u89c6\u56fe"},"\u76f8\u540c\u6570\u636e\u7d22\u5f15\u5bf9\u5e94\u591a\u4e2a\u89c6\u56fe"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"\u5f53\u901a\u8fc7 ",Object(i.b)("inlineCode",{parentName:"strong"},'name="..."')," \u6765\u6307\u5b9a FormItem \u5173\u8054\u7684\u6570\u636e\u7d22\u5f15\u65f6\uff0c \u4e00\u4e2a\u6570\u636e\u7d22\u5f15\u6700\u591a\u53ea\u80fd\u5bf9\u5e94\u4e00\u4e2a FormItem\u3002")),Object(i.b)("p",null,"\u5f53\u591a\u4e2a FormItem \u7684 name \u76f8\u540c\u65f6\uff0c\u8fd9\u4e9b FormItem \u5c06\u4f1a\u4f7f\u7528\u540c\u4e00\u4e2a Field \u5bf9\u8c61\u3002\u4f46\u56e0\u4e0d\u540c FormItem \u7684\u914d\u7f6e\u4e0d\u540c\uff08\u4f8b\u5982\u8bbe\u7f6e\u4e86\u4e0d\u540c\u7684 required \u6216 validate\uff09\uff0c\u540e\u6e32\u67d3\u7684 FormItem \u7684\u914d\u7f6e\u5c06\u4f1a\u8986\u76d6\u5148\u6e32\u67d3\u7684 FormItem \u914d\u7f6e\uff0cField \u5bf9\u8c61\u4e0a\u7684\u6821\u9a8c\u5c31\u4f1a\u51fa\u95ee\u9898\u3002\u4f8b\u5982\u4e0b\u9762\u7684\u793a\u4f8b\u4e2d\u5c31\u51fa\u73b0\u4e86\u4e24\u4e2a\u4e92\u65a5\u7684\u6821\u9a8c\u65b9\u6cd5\uff0c\u5bfc\u81f4\u6821\u9a8c\u6c38\u8fdc\u65e0\u6cd5\u901a\u8fc7\uff1a"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-jsx"},"// \u274c \u9519\u8bef\u7528\u6cd5\n<FormItem name=\"foo\" required validate={v => v < 3 ? '\u4e0d\u80fd\u5c0f\u4e8e3' : null}} />\n<FormItem name=\"foo\" required={false} validate={v => v > 3 ? '\u4e0d\u80fd\u5927\u4e8e3' : null} />\n")),Object(i.b)("p",null,"\u4f46\u5728\u5b9e\u9645\u573a\u666f\u4e2d\uff0c\u6211\u4eec\u65e0\u6cd5\u907f\u514d\u7c7b\u4f3c\u300c\u76f8\u540c\u6570\u636e\u7d22\u5f15\u5bf9\u5e94\u591a\u4e2a\u89c6\u56fe\u300d\u8fd9\u6837\u7684\u9700\u6c42\u3002\u4e3a\u6b64\uff0cxform \u63d0\u4f9b\u4e86 field fork \u80fd\u529b\uff1a"),Object(i.b)("p",null,"API\uff1a ",Object(i.b)("inlineCode",{parentName:"p"},"field.getFork(forkName :string): Field")),Object(i.b)("p",null,"\u8be5\u65b9\u6cd5\u6839\u636e\u5df2\u6709\u7684 field\uff08original field\uff09\u8fd4\u56de\u4e00\u4e2a",Object(i.b)("strong",{parentName:"p"},"\u65b0\u7684")," field \u5bf9\u8c61\uff08fork field\uff09\uff0cfork \u4e0e original \u4f7f\u7528\u76f8\u540c\u7684\u6570\u636e\u7d22\u5f15\uff08\u610f\u5473\u7740\u4e24\u8005 .value \u603b\u662f\u76f8\u7b49\uff09\uff0c\u4f46\u9664\u6b64\u4e4b\u5916\u7684\u5176\u4ed6\u72b6\u6001\u4e92\u76f8\u9694\u79bb\u3002"),Object(i.b)("p",null,"\u521b\u5efa fork field \u4e4b\u540e\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u4e3a\u4e0d\u540c\u7684 FormItem \u8bbe\u7f6e\u4e0d\u540c\u7684 field \u4e86\uff1a"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-jsx"},"// \u2705 \u6b63\u786e\u7528\u6cd5\nconst fooField = model.getField('foo')\nconst fooFork = fooField.getFork('fooFork')\n\n<FormItem field={fooField} required validate={v => v < 3 ? '\u4e0d\u80fd\u5c0f\u4e8e3' : null}} />\n<FormItem field={fooFork} required={false} validate={v => v > 3 ? '\u4e0d\u80fd\u5927\u4e8e3' : null} />\n")),Object(i.b)("h3",{id:"fork-field-\u7279\u70b9"},"fork field \u7279\u70b9"),Object(i.b)("p",null,"\u6211\u4eec\u901a\u8fc7 ",Object(i.b)("inlineCode",{parentName:"p"},"model.getField(name)")," \u83b7\u53d6\u5230\u7684 field \u5bf9\u8c61\u603b\u4e3a ",Object(i.b)("em",{parentName:"p"},"original fork"),"\uff0c\u8be5 field \u7684 forkName \u603b\u662f\u4e3a ",Object(i.b)("inlineCode",{parentName:"p"},"'original'"),"\u3002"),Object(i.b)("p",null,"\u540c\u4e00\u4e2a\u6570\u636e\u7d22\u5f15\u4e0b\uff0c\u4e0d\u540c\u7684 forks \u5171\u4eab\u4e00\u4e2a\u547d\u540d\u7a7a\u95f4\uff0c\u4e92\u76f8\u4e4b\u95f4\u53ef\u4ee5\u901a\u8fc7 ",Object(i.b)("inlineCode",{parentName:"p"},"field.getFork(forkName)")," \u8fdb\u884c\u8bbf\u95ee\uff1b\u8be5\u65b9\u6cd5\u8c03\u7528\u8fc7\u7a0b\u4e2d\uff0c\u5982\u679c forkName \u5bf9\u5e94\u7684 fork field \u4e0d\u5b58\u5728\uff0c\u5219\u4f1a\u521d\u59cb\u5316\u5bf9\u5e94\u7684 fork field\uff0c\u5e76\u5c06\u5176\u8fd4\u56de\u3002"),Object(i.b)("p",null,"\u6211\u4eec\u53ef\u4ee5\u8ba4\u4e3a original fork \u662f\u9ed8\u8ba4\u5b58\u5728\u7684\u4e00\u4e2a fork\uff0c\u5f53\u60f3\u8981\u4f7f\u7528\u65b0\u7684 fork \u65f6\uff0c\u5c31\u6362\u4e00\u4e2a forkName\uff1b\u800c\u5f53\u60f3\u8981\u83b7\u53d6\u5230 original fork \u65f6\uff0c\u5219\u901a\u8fc7 ",Object(i.b)("inlineCode",{parentName:"p"},"forkField.getFork('original')")," \u8fdb\u884c\u83b7\u53d6\u3002"),Object(i.b)("h2",{id:"\u5f02\u6b65\u6570\u636e\u6e90"},"\u5f02\u6b65\u6570\u636e\u6e90"),Object(i.b)("p",null,"(todo) createAsyncValue"),Object(i.b)("h2",{id:"\u590d\u6742\u8054\u52a8"},"\u590d\u6742\u8054\u52a8"),Object(i.b)("p",null,"(todo reactive + imperative)"))}R.isMDXComponent=!0},213:function(e,n,t){"use strict";t.d(n,"h",(function(){return E})),t.d(n,"b",(function(){return F})),t.d(n,"d",(function(){return V})),t.d(n,"a",(function(){return k})),t.d(n,"c",(function(){return W})),t.d(n,"e",(function(){return U})),t.d(n,"f",(function(){return $})),t.d(n,"g",(function(){return P}));var a=t(168),r=t(181),o=t(0),l=t.n(o),i=t(218),s=t.n(i);function c(e){e.subModels.forEach((e,n)=>{e.name=String(n)})}function m(e,n,t){if(null==e)return;const[a]=e.splice(n,1);e.splice(t,0,a)}function d(e,n,t){if(null==e)return;const a=e[n];e[n]=e[t],e[t]=a}function u(e){return String(Number.parseInt(e))===e}function p(e){return u(e)?"array":"object"}function b(e,n,t){const r=Array.isArray(n)?n:g(n);let o=e;for(let l=0;l<r.length;l+=1){if(!a.isObservable(o))return t;o=a.get(o,r[l])}return void 0===o?t:o}function f(e,n,t){const r=Array.isArray(n)?n:g(n),o=r.length-1;let l=e;for(let i=0;i<o;i+=1){const e=r[i];if(null==a.get(l,e)&&(u(r[i+1])?a.set(l,e,[]):a.set(l,e,{})),l=a.get(l,e),!a.isObservable(l))return}a.isObservable(l)&&a.set(l,r[o],t)}const y={append:Object(a.action)((e,n)=>{var t;null==e.values&&(e.values=[]),e.values.push(null!==(t=null==n?void 0:n(e))&&void 0!==t?t:{})}),delete:Object(a.action)((e,n)=>{s()(Array.isArray(e._proxy.subModels),"arrayModel.subModels should be Array or observable.array"),e.values.splice(n,1),e._proxy.subModels.splice(n,1),c(e._proxy)}),moveUp:Object(a.action)((e,n)=>{0!==n&&(s()(Array.isArray(e._proxy.subModels),"arrayModel.subModels should be Array or observable.array"),d(e.values,n,n-1),d(e._proxy.subModels,n,n-1),c(e._proxy))}),moveDown:Object(a.action)((e,n)=>{n!==e.values.length-1&&(s()(Array.isArray(e._proxy.subModels),"arrayModel.subModels should be Array or observable.array"),d(e.values,n,n+1),d(e._proxy.subModels,n,n+1),c(e._proxy))}),clear:Object(a.action)(e=>{null!=e.values&&0!==e.values.length&&(s()(Array.isArray(e._proxy.subModels),"arrayModel.subModels should be Array or observable.array"),e.values=[],e._proxy.subModels.length=0)}),dragAndDrop:Object(a.action)((e,n,t)=>{s()(Array.isArray(e._proxy.subModels),"arrayModel.subModels should be Array or observable.array"),m(e.values,n,t),m(e._proxy.subModels,n,t),c(e._proxy)}),renderArrayItem:(e,n,t)=>l.a.createElement(j,{name:String(n)},t),getKey:(e,n)=>e.getSubModel(String(n)).id};function h(e,n){return void 0!==e?e:n}function g(e){return e.split(".")}try{p.displayName="keyToValueShape",p.__docgenInfo={description:"",displayName:"keyToValueShape",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/core/utils.tsx#keyToValueShape"]={docgenInfo:p.__docgenInfo,name:"keyToValueShape",path:"../xform/src/core/utils.tsx#keyToValueShape"})}catch(H){}try{b.displayName="observableGetIn",b.__docgenInfo={description:"lodash.get(...) for mobx observables",displayName:"observableGetIn",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/core/utils.tsx#observableGetIn"]={docgenInfo:b.__docgenInfo,name:"observableGetIn",path:"../xform/src/core/utils.tsx#observableGetIn"})}catch(H){}try{f.displayName="observableSetIn",f.__docgenInfo={description:"lodash.set(...) for mobx observables",displayName:"observableSetIn",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/core/utils.tsx#observableSetIn"]={docgenInfo:f.__docgenInfo,name:"observableSetIn",path:"../xform/src/core/utils.tsx#observableSetIn"})}catch(H){}try{h.displayName="composeState",h.__docgenInfo={description:"\u5408\u5e76\u53d7\u63a7\u72b6\u6001\u548c \u975e\u53d7\u63a7\u72b6\u6001",displayName:"composeState",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/core/utils.tsx#composeState"]={docgenInfo:h.__docgenInfo,name:"composeState",path:"../xform/src/core/utils.tsx#composeState"})}catch(H){}try{g.displayName="splitToPath",g.__docgenInfo={description:"",displayName:"splitToPath",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/core/utils.tsx#splitToPath"]={docgenInfo:g.__docgenInfo,name:"splitToPath",path:"../xform/src/core/utils.tsx#splitToPath"})}catch(H){}const O=l.a.createContext(null),v=O.Provider,S=l.a.createContext({}),F=({children:e,...n})=>{const t=x();return l.a.createElement(S.Provider,{value:{...t,...n}},e)};function x(){return Object(o.useContext)(S)}function E(){return Object(o.useContext)(O)}const _=Object(r.a)(({name:e,children:n,layout:t,itemFactory:a})=>{var r,o;const i=E();if("&"===e)throw new Error(`XFormArray \u4e0d\u652f\u6301 name=&. path=(${i.path.join(".")||"root"})`);const s=i.getSubArray(e),c=null!==(o=null===(r=s.values)||void 0===r?void 0:r.length)&&void 0!==o?o:0;return l.a.createElement(v,{value:s},t({arrayModel:s,itemCount:c,itemContent:n,itemFactory:a}))}),j=Object(r.a)(({name:e,children:n})=>{const t=E();return"&"===e?l.a.createElement(l.a.Fragment,null,n):l.a.createElement(v,{value:t.getSubModel(e),children:n})}),C=Object(r.a)(e=>{const{name:n,required:t,children:r,defaultValue:o}=e,l=E(),i=Object(a.computed)(()=>"&"===n?l._asField():l.getField(n)).get();i._useTrack(e);const s=h(i.value,o);return r({model:l,name:n,field:i,value:s,required:t,defaultValue:o})});try{v.displayName="ModelProvider",v.__docgenInfo={description:"",displayName:"ModelProvider",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/core/components.tsx#ModelProvider"]={docgenInfo:v.__docgenInfo,name:"ModelProvider",path:"../xform/src/core/components.tsx#ModelProvider"})}catch(H){}try{F.displayName="FormEnvProvider",F.__docgenInfo={description:"",displayName:"FormEnvProvider",props:{isPreview:{defaultValue:null,description:"",name:"isPreview",required:!1,type:{name:"boolean"}},onSubmit:{defaultValue:null,description:"",name:"onSubmit",required:!1,type:{name:"(submitValues: any, model: IModel<unknown>) => void"}},onError:{defaultValue:null,description:"",name:"onError",required:!1,type:{name:"(errors: any, model: IModel<unknown>) => void"}},onReset:{defaultValue:null,description:"",name:"onReset",required:!1,type:{name:"(model: IModel<unknown>) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/core/components.tsx#FormEnvProvider"]={docgenInfo:F.__docgenInfo,name:"FormEnvProvider",path:"../xform/src/core/components.tsx#FormEnvProvider"})}catch(H){}try{_.displayName="XFormArray",_.__docgenInfo={description:"\u5bf9\u8c61\u6570\u7ec4\u8868\u5355",displayName:"XFormArray",props:{name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"string"}},layout:{defaultValue:null,description:"",name:"layout",required:!0,type:{name:"(input: XFormArrayLayoutInput) => ReactElement<any, string | JSXElementConstructor<any>>"}},itemFactory:{defaultValue:null,description:"",name:"itemFactory",required:!1,type:{name:"(arrayModel: SubModel<unknown[]>) => any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/core/components.tsx#XFormArray"]={docgenInfo:_.__docgenInfo,name:"XFormArray",path:"../xform/src/core/components.tsx#XFormArray"})}catch(H){}try{j.displayName="XFormObject",j.__docgenInfo={description:"\u4e3a\u8be5\u7ec4\u4ef6\u4e0b\u7684 XFormField \u6dfb\u52a0\u4e00\u4e2a\u6570\u636e\u5b57\u6bb5\u524d\u7f00",displayName:"XFormObject",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/core/components.tsx#XFormObject"]={docgenInfo:j.__docgenInfo,name:"XFormObject",path:"../xform/src/core/components.tsx#XFormObject"})}catch(H){}try{C.displayName="XFormField",C.__docgenInfo={description:"\u8868\u5355\u5b57\u6bb5\uff08field\uff09\n\n\u5728 xform \u4e2d\uff0c\u4e00\u4e2a\u300c\u5b57\u6bb5\u300d\u5305\u542b\u4e00\u4e2a\u300c\u89c6\u56fe\u63a7\u4ef6\u5b9e\u4f8b\u300d\uff08\u4f8b\u5982 Input\uff0cSelect \u5b9e\u4f8b\uff09\u548c\u4e00\u4efd\u72b6\u6001\uff08\u4f8b\u5982 Input \u5305\u542b\u4e00\u4e2a\u5b57\u7b26\u4e32\u72b6\u6001\uff09\uff1b\nXFormField \u662f\u4e00\u4e2a\u9ad8\u9636\u7ec4\u4ef6 / \u57fa\u7840\u7ec4\u4ef6\uff0c\u6bcf\u4e2a\u5177\u4f53\u7684\u7ec4\u4ef6\u7c7b\u578b\uff08\u4f8b\u5982 Input\uff0cSelect \uff09\u90fd\u5e94\u8be5\u7ee7\u627f\u8be5\u7ec4\u4ef6\u5e76\u5c01\u88c5\u76f8\u5e94\u7684 FieldItem\uff1b",displayName:"XFormField",props:{name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"string"}},label:{defaultValue:null,description:"",name:"label",required:!1,type:{name:"ReactNode"}},labelWidth:{defaultValue:null,description:"",name:"labelWidth",required:!1,type:{name:"string"}},help:{defaultValue:null,description:"",name:"help",required:!1,type:{name:"ReactNode"}},validate:{defaultValue:null,description:"",name:"validate",required:!1,type:{name:"(value: any, field: Field) => string | Promise<string>"}},required:{defaultValue:null,description:"",name:"required",required:!1,type:{name:"boolean"}},defaultValue:{defaultValue:null,description:"",name:"defaultValue",required:!1,type:{name:"any"}},isEmpty:{defaultValue:null,description:"",name:"isEmpty",required:!1,type:{name:"(value: any) => boolean"}},requiredMessage:{defaultValue:null,description:"",name:"requiredMessage",required:!1,type:{name:"string"}},blurValidator:{defaultValue:null,description:"",name:"blurValidator",required:!1,type:{name:"(value: any, field: Field) => string | Promise<string>"}},changeValidator:{defaultValue:null,description:"",name:"changeValidator",required:!1,type:{name:"(value: any, field: Field) => string | Promise<string>"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}},readOnly:{defaultValue:null,description:"",name:"readOnly",required:!1,type:{name:"boolean"}},status:{defaultValue:null,description:"",name:"status",required:!1,type:{name:"string"}},renderPreview:{defaultValue:null,description:"",name:"renderPreview",required:!1,type:{name:"(props: any) => ReactNode"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/core/components.tsx#XFormField"]={docgenInfo:C.__docgenInfo,name:"XFormField",path:"../xform/src/core/components.tsx#XFormField"})}catch(H){}class I{constructor(e,n){this.fieldMap=new Map,this.model=e,this.valueShape=n,this.subModels="array"===n?[]:{}}iterateModels(e){const n=t=>{Object.values(t.subModels).forEach(t=>{e(t),n(t._proxy)})};n(this)}iterateFields(e){this.fieldMap.forEach(e),this.iterateModels(n=>{n._proxy.fieldMap.forEach(e)})}getSubModel(e,n="object"){const t=Array.isArray(e)?e:g(e);let a=this.model;for(let r=0;r<t.length-1;r++)a=a._proxy._getSubModel(t[r],p(t[r+1]));return a._proxy._getSubModel(t[t.length-1],n)}_getSubModel(e,n="object"){s()(!e.includes("."),"name \u4e2d\u4e0d\u80fd\u5305\u542b .");let t=this.subModels[e];return null==t&&(t=new w(this.model,e,n),this.subModels[e]=t),t}getField(e){const n=Array.isArray(e)?e:g(e);if(n.length>1){return this.getSubModel(n[0],p(n[1])).getField(n.slice(1))}const t=n[0];let a=this.fieldMap.get(t);return null==a&&(a=new N(this.model,t),this.fieldMap.set(t,a)),a}}const A=[];class V{constructor(e={}){this._nextModelId=1,this._nextFieldId=1,this.state={},this.root=this,this.parent=this,this.path=A,this.valueShape="object",this._proxy=new I(this,"object"),this.values=e,Object(a.makeObservable)(this,{values:a.observable,state:a.observable,setValue:a.action})}getNextModelId(){return"Model_"+this._nextModelId++}getNextFieldId(){return"Field_"+this._nextFieldId++}getValue(e,n){return b(this.values,e,n)}setValue(e,n){f(this.values,e,n)}getSubModel(e){return this._proxy.getSubModel(e,"object")}getSubArray(e){return this._proxy.getSubModel(e,"array")}getField(e){return this._proxy.getField(e)}_asField(){throw new Error("FormModel \u4e0b\u4e0d\u652f\u6301\u4f7f\u7528 name=& \u7684 Field")}}class w{constructor(e,n,t){this.state={},s()(!n.includes("."),"name \u4e2d\u4e0d\u80fd\u5305\u542b ."),this.root=e.root,this.parent=e,this.name=n,this.valueShape=t,this._proxy=new I(this,t),this.id=this.root.getNextModelId(),Object(a.makeObservable)(this,{values:a.computed,state:a.observable,setValue:a.action,name:a.observable},{name:`${this.id}(${this.name})`})}get path(){return[...this.parent.path,this.name]}getSubModel(e){return this._proxy.getSubModel(e,"object")}getSubArray(e){return this._proxy.getSubModel(e,"array")}get values(){return this.parent.getValue(this.name)}set values(e){this.parent.setValue(this.name,e)}getField(e){return this._proxy.getField(e)}getValue(e,n){return b(this.values,e,n)}setValue(e,n){null==this.values&&(this.values="array"===this.valueShape?[]:{}),f(this.values,e,n)}_asField(){return this.parent.getField(this.name)}}class N{constructor(e,n){this.config=null,this.mountCount=0,this.state={},this.parent=e,this.name=n,this.id=this.parent.root.getNextFieldId(),Object(a.makeObservable)(this,{state:a.observable,name:a.observable.ref,value:a.computed,path:a.computed,config:!1,mountCount:!1},{name:`${this.id}(${this.name})`})}get value(){return this.parent.getValue(this.name)}set value(e){this.parent.setValue(this.name,e)}get path(){return this.parent.path.concat([this.name])}_useTrack(e){Object(o.useLayoutEffect)(()=>(this.config=e,this.mountCount+=1,()=>{this.config=null,this.mountCount-=1}),[e])}}var R=t(163);const T={validate:Object(a.action)((e,n="*")=>{var t,r,o,l;if(null==e.config)return;const{validate:i,required:s,defaultValue:c,isEmpty:m,requiredMessage:d="\u8be5\u5b57\u6bb5\u4e3a\u5fc5\u586b\u9879",blurValidator:u,changeValidator:p}=e.config,b=e.value;if(s&&m(b))return e.state.error=d,null===(r=(t=e.state).cancelValidation)||void 0===r||r.call(t),e.state.cancelValidation=null,Promise.resolve(d);const f=h(b,c),y=[("*"===n||"change"===n)&&(null==p?void 0:p(f,e)),("*"===n||"blur"===n)&&(null==u?void 0:u(f,e)),null==i?void 0:i(f,e)].filter(Boolean);let g=!1;return null===(l=(o=e.state).cancelValidation)||void 0===l||l.call(o),e.state.validating=!0,e.state.cancelValidation=()=>{e.state.validating=!1,g=!0},Promise.all(y).then(Object(a.action)(n=>{if(g)return;e.state.cancelValidation=null,e.state.validating=!1;const t=n.filter(Boolean)[0];return e.state.error=t,t}))}),handleBlur(e){T.validate(e,"blur")},handleChange:Object(a.action)((e,n)=>{e.value=n,T.validate(e,"change")})},P={clearError:Object(a.action)(e=>{e._proxy.iterateFields(e=>{e.state.error=null})}),validateAll:Object(a.action)((e,n="*")=>{let t=!1;const r=Object(a.observable)("array"===e.valueShape?[]:{}),o=[];return e._proxy.iterateFields(e=>{0!==e.mountCount&&o.push(T.validate(e,n).then(Object(a.action)(n=>{n&&(t=!0,f(r,e.path,n))})))}),Promise.all(o).then(()=>({hasError:t,errors:Object(a.toJS)(r)}))}),submit:Object(a.action)((e,{onError:n,onSubmit:t,valueFilter:r})=>{P.validateAll(e).then(Object(a.action)(({hasError:o,errors:l})=>{if(o)null==n||n(l,e);else if("function"==typeof t)if("all"===r)t(Object(a.toJS)(e.values),e);else{const n=Object(a.observable)("array"===e.valueShape?[]:{});e._proxy.iterateFields(e=>{0!==e.mountCount&&void 0!==e.value&&f(n,e.path,e.value)}),t(Object(a.toJS)(n),e)}}))}),reset:Object(a.action)((e,{onReset:n}={})=>{e.values={},P.clearError(e),null==n||n(e)})};function k({model:e,defaultValue:n,isPreview:t,layout:a={labelPosition:"left"},onSubmit:r,onError:i,onReset:s,children:c,className:m,style:d}){const[u]=Object(o.useState)(()=>new V(n)),p=h(e,u);return l.a.createElement(F,{isPreview:t,onError:i,onReset:s,onSubmit:r},l.a.createElement(v,{value:p},l.a.createElement(R.FormLayout,Object.assign({},a,{style:d,className:m}),c)))}const M=Object(r.a)(({watch:e,effect:n})=>{const t=E(),r=t.getField(e);return Object(o.useEffect)(()=>Object(a.reaction)(()=>Object(a.toJS)(r.value),(e,a)=>n(e,{model:t,prev:a,next:e})),[t,e,r,n]),null}),q=Object(r.a)(({children:e})=>e(E()));k.Submit=function({type:e="primary",children:n="\u63d0\u4ea4",...t}){const a=E().root,r=x();return l.a.createElement(R.Button,Object.assign({onClick:()=>P.submit(a,{...r,valueFilter:"mounted"}),type:e,children:n},t))},k.Reset=function({children:e="\u91cd\u7f6e",...n}){const t=E().root,r=x();return l.a.createElement(R.Button,Object.assign({onClick:Object(a.action)(()=>P.reset(t,r)),children:e},n))},k.Effect=M,k.Array=_,k.Object=j,k.Field=C,k.ModelProvider=v,k.ModelConsumer=q;try{k.displayName="Form",k.__docgenInfo={description:"",displayName:"Form",props:{model:{defaultValue:null,description:"\u53d7\u63a7\u7528\u6cd5\u3002 xform \u6a21\u578b\u5bf9\u8c61\uff0c\u4e00\u822c\u7531\u4e0a\u5c42\u901a\u8fc7 new FormModel(...) \u521b\u5efa\u800c\u6210",name:"model",required:!1,type:{name:"IModel<unknown>"}},defaultValue:{defaultValue:null,description:"\u975e\u53d7\u63a7\u7528\u6cd5\u3002 \u8868\u5355\u7684\u9ed8\u8ba4\u503c",name:"defaultValue",required:!1,type:{name:"any"}},onSubmit:{defaultValue:null,description:"\u63d0\u4ea4\u8868\u5355\u65f6\u7684\u56de\u8c03\u51fd\u6570\uff0c\u9700\u914d\u5408 <Form.Submit /> \u4f7f\u7528",name:"onSubmit",required:!1,type:{name:"(submitValues: any, model: FormModel<unknown>) => void"}},onError:{defaultValue:null,description:"\u63d0\u4ea4\u8868\u5355\u65f6\u7684\u51fa\u9519\u56de\u8c03\u51fd\u6570\uff0c\u9700\u914d\u5408 <Form.Submit /> \u4f7f\u7528",name:"onError",required:!1,type:{name:"(errors: any, model: FormModel<unknown>) => void"}},onReset:{defaultValue:null,description:"\u6e05\u7a7a\u8868\u5355\u65f6\u7684\u56de\u8c03\u51fd\u6570\uff0c\u9700\u914d\u5408 <Form.Reset /> \u4f7f\u7528",name:"onReset",required:!1,type:{name:"(model: FormModel<unknown>) => void"}},isPreview:{defaultValue:{value:"false"},description:"\u662f\u5426\u4e3a\u9884\u89c8\u6001",name:"isPreview",required:!1,type:{name:"boolean"}},layout:{defaultValue:{value:"{ labelPosition: 'left' }"},description:"\u5e03\u5c40\u53c2\u6570\n@category \u5e03\u5c40",name:"layout",required:!1,type:{name:'{ isInline?: boolean; labelPosition?: "top" | "left"; }'}},style:{defaultValue:null,description:"@category \u5e03\u5c40",name:"style",required:!1,type:{name:"CSSProperties"}},className:{defaultValue:null,description:"@category \u5e03\u5c40",name:"className",required:!1,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/form.tsx#Form"]={docgenInfo:k.__docgenInfo,name:"Form",path:"../xform/src/form.tsx#Form"})}catch(H){}try{k.Submit.displayName="Form.Submit",k.Submit.__docgenInfo={description:"",displayName:"Form.Submit",props:{shape:{defaultValue:null,description:"",name:"shape",required:!1,type:{name:'"solid" | "text" | "link" | "warning" | "ghost"'}},type:{defaultValue:{value:"primary"},description:"",name:"type",required:!1,type:{name:'"normal" | "primary" | "secondary"'}},size:{defaultValue:null,description:"",name:"size",required:!1,type:{name:'"small" | "medium" | "large"'}},htmlType:{defaultValue:null,description:"",name:"htmlType",required:!1,type:{name:'"button" | "submit" | "reset"'}},isFullWidth:{defaultValue:null,description:"",name:"isFullWidth",required:!1,type:{name:"boolean"}},isIconOnly:{defaultValue:null,description:"\u662f\u5426\u4e3a\u7eaf\u56fe\u6807\u6309\u94ae",name:"isIconOnly",required:!1,type:{name:"boolean"}},isSelected:{defaultValue:null,description:"",name:"isSelected",required:!1,type:{name:"boolean"}},loading:{defaultValue:null,description:"",name:"loading",required:!1,type:{name:"boolean"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},leftElement:{defaultValue:null,description:"",name:"leftElement",required:!1,type:{name:"ReactNode"}},rightElement:{defaultValue:null,description:"",name:"rightElement",required:!1,type:{name:"ReactNode"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/form.tsx#Form.Submit"]={docgenInfo:k.Submit.__docgenInfo,name:"Form.Submit",path:"../xform/src/form.tsx#Form.Submit"})}catch(H){}try{k.Reset.displayName="Form.Reset",k.Reset.__docgenInfo={description:"",displayName:"Form.Reset",props:{shape:{defaultValue:null,description:"",name:"shape",required:!1,type:{name:'"solid" | "text" | "link" | "warning" | "ghost"'}},type:{defaultValue:null,description:"",name:"type",required:!1,type:{name:'"normal" | "primary" | "secondary"'}},size:{defaultValue:null,description:"",name:"size",required:!1,type:{name:'"small" | "medium" | "large"'}},htmlType:{defaultValue:null,description:"",name:"htmlType",required:!1,type:{name:'"button" | "submit" | "reset"'}},isFullWidth:{defaultValue:null,description:"",name:"isFullWidth",required:!1,type:{name:"boolean"}},isIconOnly:{defaultValue:null,description:"\u662f\u5426\u4e3a\u7eaf\u56fe\u6807\u6309\u94ae",name:"isIconOnly",required:!1,type:{name:"boolean"}},isSelected:{defaultValue:null,description:"",name:"isSelected",required:!1,type:{name:"boolean"}},loading:{defaultValue:null,description:"",name:"loading",required:!1,type:{name:"boolean"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},leftElement:{defaultValue:null,description:"",name:"leftElement",required:!1,type:{name:"ReactNode"}},rightElement:{defaultValue:null,description:"",name:"rightElement",required:!1,type:{name:"ReactNode"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/form.tsx#Form.Reset"]={docgenInfo:k.Reset.__docgenInfo,name:"Form.Reset",path:"../xform/src/form.tsx#Form.Reset"})}catch(H){}try{k.Effect.displayName="Form.Effect",k.Effect.__docgenInfo={description:"",displayName:"Form.Effect",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/form.tsx#Form.Effect"]={docgenInfo:k.Effect.__docgenInfo,name:"Form.Effect",path:"../xform/src/form.tsx#Form.Effect"})}catch(H){}try{k.Array.displayName="Form.Array",k.Array.__docgenInfo={description:"",displayName:"Form.Array",props:{name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"string"}},layout:{defaultValue:null,description:"",name:"layout",required:!0,type:{name:"(input: XFormArrayLayoutInput) => ReactElement<any, string | JSXElementConstructor<any>>"}},itemFactory:{defaultValue:null,description:"",name:"itemFactory",required:!1,type:{name:"(arrayModel: SubModel<unknown[]>) => any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/form.tsx#Form.Array"]={docgenInfo:k.Array.__docgenInfo,name:"Form.Array",path:"../xform/src/form.tsx#Form.Array"})}catch(H){}try{k.Object.displayName="Form.Object",k.Object.__docgenInfo={description:"",displayName:"Form.Object",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/form.tsx#Form.Object"]={docgenInfo:k.Object.__docgenInfo,name:"Form.Object",path:"../xform/src/form.tsx#Form.Object"})}catch(H){}try{k.Field.displayName="Form.Field",k.Field.__docgenInfo={description:"",displayName:"Form.Field",props:{name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"string"}},label:{defaultValue:null,description:"",name:"label",required:!1,type:{name:"ReactNode"}},labelWidth:{defaultValue:null,description:"",name:"labelWidth",required:!1,type:{name:"string"}},help:{defaultValue:null,description:"",name:"help",required:!1,type:{name:"ReactNode"}},validate:{defaultValue:null,description:"",name:"validate",required:!1,type:{name:"(value: any, field: Field) => string | Promise<string>"}},required:{defaultValue:null,description:"",name:"required",required:!1,type:{name:"boolean"}},defaultValue:{defaultValue:null,description:"",name:"defaultValue",required:!1,type:{name:"any"}},isEmpty:{defaultValue:null,description:"",name:"isEmpty",required:!1,type:{name:"(value: any) => boolean"}},requiredMessage:{defaultValue:null,description:"",name:"requiredMessage",required:!1,type:{name:"string"}},blurValidator:{defaultValue:null,description:"",name:"blurValidator",required:!1,type:{name:"(value: any, field: Field) => string | Promise<string>"}},changeValidator:{defaultValue:null,description:"",name:"changeValidator",required:!1,type:{name:"(value: any, field: Field) => string | Promise<string>"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}},readOnly:{defaultValue:null,description:"",name:"readOnly",required:!1,type:{name:"boolean"}},status:{defaultValue:null,description:"",name:"status",required:!1,type:{name:"string"}},renderPreview:{defaultValue:null,description:"",name:"renderPreview",required:!1,type:{name:"(props: any) => ReactNode"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/form.tsx#Form.Field"]={docgenInfo:k.Field.__docgenInfo,name:"Form.Field",path:"../xform/src/form.tsx#Form.Field"})}catch(H){}try{k.ModelConsumer.displayName="Form.ModelConsumer",k.ModelConsumer.__docgenInfo={description:"",displayName:"Form.ModelConsumer",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/form.tsx#Form.ModelConsumer"]={docgenInfo:k.ModelConsumer.__docgenInfo,name:"Form.ModelConsumer",path:"../xform/src/form.tsx#Form.ModelConsumer"})}catch(H){}function B(e){return e.value?"\u662f":"\u5426"}function L(e){return e.value}function Y(e){return!e}function K(e){return null==e}function J(e){return null==e||Array.isArray(e)&&0===e.length}const G={};function D(e,n){function t({defaultValue:t=n.fallbackValue,componentProps:a,value:r,onChange:o,onBlur:i,...s}){const{isPreview:c}=x();return l.a.createElement(C,Object.assign({defaultValue:t,isEmpty:n.isEmpty},s),({model:t,name:m,field:d,value:u,required:p})=>{var b;const f=d.state.error,y={...Object(R.pick)(s,["dataSource","readOnly","disabled"]),...a,status:h(null==a?void 0:a.status,h(s.status,f?"error":void 0)),value:void 0!==r?r:u,onChange:void 0!==o?o:e=>T.handleChange(d,e),onBlur:void 0!==i?i:()=>T.handleBlur(d)};return l.a.createElement(R.FormControl,{label:s.label,help:s.help,labelWidth:s.labelWidth,required:p,error:f},c?(null!==(b=s.renderPreview)&&void 0!==b?b:n.renderPreview)(y):l.a.createElement(e,Object.assign({},y)))})}t.displayName=`FormItem(${n.name})`,G[n.name]=t}function W({component:e,...n}){const t=G[e];return null==t?l.a.createElement(R.FormControl,null,l.a.createElement("div",{style:{border:"1px dashed var(--rex-colors-error-hover)",fontSize:14,padding:4,color:"var(--rex-colors-error-normal)"}},l.a.createElement("code",null,"<FormItem component='",e,"' />")," \u6ca1\u6709\u627e\u5230\u5bf9\u5e94\u7ec4\u4ef6\uff0c\u8bf7\u68c0\u67e5\u7ec4\u4ef6\u540d\u79f0\u662f\u5426\u62fc\u5199\u6b63\u786e")):l.a.createElement(t,n)}D(R.Switch,{name:"switch",renderPreview:B,fallbackValue:!1,isEmpty:Y}),D(R.Checkbox,{name:"checkbox",renderPreview:B,fallbackValue:!1,isEmpty:Y}),D(R.CheckboxGroup,{name:"checkboxGroup",fallbackValue:[],renderPreview(e){var n;const t=null!==(n=e.value)&&void 0!==n?n:e.defaultValue,a=new R.ListStore(e.dataSource);return t.map(e=>{const n=a.getItem(e);return n?n.label:e}).join("\u3001")},isEmpty:e=>null==e||0===e.length}),D(R.RadioGroup,{name:"radioGroup",fallbackValue:null,renderPreview(e){var n;const t=null!==(n=e.value)&&void 0!==n?n:e.defaultValue,a=new R.ListStore(e.dataSource).getItem(t);return a?a.label:t},isEmpty:Y}),D(R.DatePicker,{name:"datePicker",renderPreview:L,fallbackValue:null,isEmpty:Y}),D(R.DateRangePicker,{name:"dateRangePicker",renderPreview(e){var n;const t=(null!==(n=e.value)&&void 0!==n?n:e.defaultValue)||[];return`${t[0]||"-"} ~ ${t[1]||"-"}`},fallbackValue:[],isEmpty:J}),D(R.TimePicker,{name:"timePicker",renderPreview:L,fallbackValue:"",isEmpty:Y}),D(R.FilePicker,{name:"filePicker",renderPreview(e){var n;const t=(null!==(n=e.value)&&void 0!==n?n:e.defaultValue)||[];return l.a.createElement(R.Flex,{spacing:"s",direction:"column"},t.map(({id:e,name:n,url:t})=>l.a.createElement(R.FlexItem,{key:e,bg:"fill.layer1",px:"m"},l.a.createElement(R.Link,{href:t},n))))},fallbackValue:[],isEmpty:J}),D(R.MediaPicker,{name:"mediaPicker",renderPreview(e){var n;const t=(null!==(n=e.value)&&void 0!==n?n:e.defaultValue)||[];return l.a.createElement(R.Flex,{spacing:"m"},t.map(({id:e,name:n,url:t})=>{const a=`${Object(R.colors)("fill.layer1")} url(${t}) center center / 100% no-repeat`;return l.a.createElement(R.Box,{key:e,size:"100px",title:n,display:"inline-block",style:{background:a}})}))},fallbackValue:[],isEmpty:J}),D(R.Input,{name:"input",renderPreview:L,fallbackValue:"",isEmpty:Y}),D(R.Textarea,{name:"textarea",renderPreview:L,fallbackValue:"",isEmpty:Y}),D(R.NumberInput,{name:"numberInput",renderPreview:L,fallbackValue:null,isEmpty:K}),D(R.Range,{name:"range",renderPreview:L,fallbackValue:0,isEmpty:K}),D(R.Select,{name:"select",renderPreview:L,fallbackValue:null,isEmpty:K}),D(R.SingleSelect,{name:"singleSelect",renderPreview:L,fallbackValue:null,isEmpty:Y}),D(R.MultiSelect,{name:"multiSelect",renderPreview:L,fallbackValue:[],isEmpty:J}),D(R.TreeSelect,{name:"treeSelect",renderPreview:L,fallbackValue:null,isEmpty:J}),D(R.SingleTreeSelect,{name:"singleTreeSelect",renderPreview:L,fallbackValue:null,isEmpty:Y}),D(R.MultiTreeSelect,{name:"multiTreeSelect",renderPreview:L,fallbackValue:[],isEmpty:J}),D((function({items:e,value:n,onChange:t,...a}){return l.a.createElement("div",Object.assign({style:{display:"flex",gap:8}},a),e.map(e=>l.a.createElement(R.Button,{key:e,type:e===n?"primary":"normal",onClick:()=>t(e)},e)))}),{name:"testButtonGroup",fallbackValue:"",renderPreview:L,isEmpty:Y});try{W.displayName="FormItem",W.__docgenInfo={description:"",displayName:"FormItem",props:{component:{defaultValue:null,description:"",name:"component",required:!0,type:{name:'"select" | "radioGroup" | "input" | "textarea" | "switch" | "checkbox" | "checkboxGroup" | "datePicker" | "dateRangePicker" | "timePicker" | "filePicker" | "mediaPicker" | "numberInput" | ... 6 more ... | "testButtonGroup"'}},componentProps:{defaultValue:null,description:"",name:"componentProps",required:!1,type:{name:"TimePickerProps | TextareaProps | SwitchProps | CheckboxProps | CheckboxGroupProps | RadioGroupProps | ... 11 more ... | (HTMLProps<...> & { ...; })"}},defaultValue:{defaultValue:null,description:"",name:"defaultValue",required:!1,type:{name:"any"}},name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"string"}},label:{defaultValue:null,description:"",name:"label",required:!1,type:{name:"ReactNode"}},labelWidth:{defaultValue:null,description:"",name:"labelWidth",required:!1,type:{name:"string"}},help:{defaultValue:null,description:"",name:"help",required:!1,type:{name:"ReactNode"}},validate:{defaultValue:null,description:"",name:"validate",required:!1,type:{name:"(value: any, field: Field) => string | Promise<string>"}},required:{defaultValue:null,description:"",name:"required",required:!1,type:{name:"boolean"}},isEmpty:{defaultValue:null,description:"",name:"isEmpty",required:!1,type:{name:"(value: any) => boolean"}},requiredMessage:{defaultValue:null,description:"",name:"requiredMessage",required:!1,type:{name:"string"}},blurValidator:{defaultValue:null,description:"",name:"blurValidator",required:!1,type:{name:"(value: any, field: Field) => string | Promise<string>"}},changeValidator:{defaultValue:null,description:"",name:"changeValidator",required:!1,type:{name:"(value: any, field: Field) => string | Promise<string>"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}},readOnly:{defaultValue:null,description:"",name:"readOnly",required:!1,type:{name:"boolean"}},status:{defaultValue:null,description:"",name:"status",required:!1,type:{name:"string"}},renderPreview:{defaultValue:null,description:"",name:"renderPreview",required:!1,type:{name:"(props: any) => ReactNode"}},dataSource:{defaultValue:null,description:"",name:"dataSource",required:!1,type:{name:"TreeSelectItem[] | ListNode<string>[] | ListNode<StringOrNumber>[] | (string | SelectItem)[]"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/form-item.tsx#FormItem"]={docgenInfo:W.__docgenInfo,name:"FormItem",path:"../xform/src/form-item.tsx#FormItem"})}catch(H){}const X=e=>{const n=[];for(let t=0;t<e;t++)n.push(t);return n},U=({title:e,showItemCount:n,showItemOrder:t,style:r}={})=>{const o={position:"absolute",top:8,right:8,display:"flex",gap:8,zIndex:20};return i=>{const{arrayModel:s,itemContent:c,itemCount:m,itemFactory:d}=i;return l.a.createElement("div",{className:"xform-array",style:{marginTop:16,marginBottom:8,...r}},(e||n)&&l.a.createElement("h2",null,null!=e?e:"\u5217\u8868"," ",n&&`(${m})`),0===m&&l.a.createElement("div",{style:{border:"1px dashed #aaa",marginTop:16,padding:8,position:"relative",fontSize:20}},"\u7a7a\u7a7a\u5982\u4e5f~~"),l.a.createElement("div",{className:"xform-array-items"},X(m).map(e=>l.a.createElement("div",{key:y.getKey(s,e),className:"xform-array-item",style:{border:"1px dashed #aaa",marginTop:16,padding:8,position:"relative"}},t&&l.a.createElement("code",{style:{fontSize:16}},s.path.join("."),"#",e),l.a.createElement(z,Object.assign({},i,{itemIndex:e,style:o})),y.renderArrayItem(s,e,c)))),l.a.createElement("div",{style:{marginTop:12}},l.a.createElement(R.Button,{onClick:Object(a.action)(()=>{y.append(s,d)})},"\u6dfb\u52a0\u4e00\u9879")))}},z=Object(r.a)(({arrayModel:e,itemCount:n,itemIndex:t,style:r})=>l.a.createElement("div",{style:r},l.a.createElement(R.Button,{size:"small",onClick:Object(a.action)(()=>{y.delete(e,t)})},"\u5220\u9664"),l.a.createElement(R.Button,{size:"small",disabled:0===t,onClick:Object(a.action)(()=>{y.moveUp(e,t)})},"\u4e0a\u79fb"),l.a.createElement(R.Button,{size:"small",disabled:t===n-1,onClick:Object(a.action)(()=>{y.moveDown(e,t)})},"\u4e0b\u79fb"))),$=({defaultColumnWidth:e,orderColumn:n,operationColumn:t,className:a,style:r}={})=>{const o={display:"flex",gap:0};return i=>{const{arrayModel:s,itemContent:c,itemCount:m,itemFactory:d}=i,u=l.a.Children.toArray(c).filter(e=>e.type===W).map(e=>({name:"string"==typeof e.props.label?e.props.label:null,title:e.props.label,...e.props["x-table-column"],render:(n,t)=>l.a.createElement(j,{name:String(t.itemIndex)},l.a.cloneElement(e,{label:null,isInline:!0}))}));return null!=n&&u.unshift({name:"#",...n,getValue:e=>e.itemIndex+1}),null!=t&&u.push({name:"",...t,render:(e,n)=>l.a.createElement(z,Object.assign({},i,{itemIndex:n.itemIndex,style:o}))}),l.a.createElement("div",{style:r,className:a},l.a.createElement(R.BaseTable,{className:"bordered",primaryKey:"rowKey",defaultColumnWidth:e,dataSource:X(m).map(e=>({rowKey:y.getKey(s,e),itemIndex:e})),columns:u}),l.a.createElement("div",{style:{padding:4,height:48,display:"flex",alignItems:"center",justifyContent:"center",background:"#f5f5f5"}},l.a.createElement(R.Button,{type:"primary",onClick:()=>{y.append(s,d)}},"\u6dfb\u52a0\u4e00\u884c")))}};try{U.displayName="arrayCard",U.__docgenInfo={description:"",displayName:"arrayCard",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/array-layouts.tsx#arrayCard"]={docgenInfo:U.__docgenInfo,name:"arrayCard",path:"../xform/src/array-layouts.tsx#arrayCard"})}catch(H){}try{$.displayName="arrayTable",$.__docgenInfo={description:"",displayName:"arrayTable",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../xform/src/array-layouts.tsx#arrayTable"]={docgenInfo:$.__docgenInfo,name:"arrayTable",path:"../xform/src/array-layouts.tsx#arrayTable"})}catch(H){}},312:function(e,n,t){"use strict";t.d(n,"a",(function(){return b}));var a=t(3),r=t(163),o=t(213),l=t(168),i=t(181),s=t(0),c=t.n(s);function m({children:e,fallback:n}){return"undefined"==typeof document||null==e?null!=n?n:null:c.a.createElement(c.a.Fragment,null,e())}const d={filename:"/Users/feichao.sfc/code/github/alibaba/rex-design/packages/story/src/xform/helpers.tsx",loc:{start:{line:9,column:0},end:{line:21,column:1}},name:"BrowserOnly",value:m,source:" function _nullishCoalesce(lhs, rhsFn) { if (lhs != null) { return lhs; } else { return rhsFn(); } }function BrowserOnly({\n  children,\n  fallback,\n}\n\n\n) {\n  if (typeof document === 'undefined' || children == null) {\n    return _nullishCoalesce(fallback, () => ( null));\n  }\n\n  return <>{children()}</>;\n}",deps:()=>[],provides:{React:c.a}},u=e=>c.a.createElement(m,null,()=>{const n=t(375).default;return c.a.createElement(n,Object(a.a)({style:{marginTop:8,fontSize:12,...e.style}},e))}),p={filename:"/Users/feichao.sfc/code/github/alibaba/rex-design/packages/story/src/xform/helpers.tsx",loc:{start:{line:23,column:7},end:{line:32,column:2}},name:"BrowserOnlyReactJson",value:u,source:"const BrowserOnlyReactJson = (props) => {\n  return (\n    <BrowserOnly>\n      {() => {\n        const ReactJson = require('react-json-view').default;\n        return <ReactJson style={{ marginTop: 8, fontSize: 12, ...props.style }} {...props} />;\n      }}\n    </BrowserOnly>\n  );\n};",deps:()=>[d],provides:{}};u.__doc_info=p,u.__inner_source="(props) => {\n  return (\n    <BrowserOnly>\n      {() => {\n        const ReactJson = require('react-json-view').default;\n        return <ReactJson style={{ marginTop: 8, fontSize: 12, ...props.style }} {...props} />;\n      }}\n    </BrowserOnly>\n  );\n}";const b=Object(i.a)(({style:e,defaultShow:n})=>{var t;const a=Object(o.h)(),i=Object(l.toJS)(a.values),s=null!==(t=a.state.showReactJson)&&void 0!==t?t:n;return c.a.createElement("div",{style:{marginTop:16,...e}},c.a.createElement("div",{style:{marginTop:8,display:"flex",alignItems:"center",gap:8}},c.a.createElement(r.Switch,{value:s,onChange:Object(l.action)(e=>{a.state.showReactJson=e})}),c.a.createElement("span",{style:{fontSize:12}},"\u663e\u793a JSON")),s&&c.a.createElement(u,{name:"\u8868\u5355\u72b6\u6001\u9884\u89c8",src:i}))}),f=(i.a,c.a,o.h,l.toJS,r.Switch,l.action,Object(i.a)(({label:e,printAll:n})=>{const t=Object(o.h)();return Object(s.useEffect)(()=>Object(l.autorun)(()=>{console.log(`[ValuePrinter] ${null!=e?e:""}\n`,n?{...t,values:Object(l.toJS)(t.values)}:Object(l.toJS)(t.values))}),[e,t,n]),null}));i.a,o.h,s.useEffect,l.autorun,l.toJS,Object(i.a)(()=>{const e=Object(o.h)().root;return c.a.createElement("div",{style:{display:"flex",gap:8}},c.a.createElement(r.Button,{onClick:()=>o.g.validateAll(e)},"\u6821\u9a8c\u5168\u90e8"),c.a.createElement(r.Button,{onClick:()=>o.g.clearError(e)},"\u6e05\u7a7a\u9519\u8bef"),c.a.createElement(r.Button,{onClick:Object(l.action)(()=>{e.values={opCount:0,sku:{code:"test"}},o.g.clearError(e)})},"\u91cd\u7f6e\u8868\u5355"))}),i.a,o.h,r.Button,o.g,l.action,Object(i.a)(()=>{const e=Object(o.h)();return Object(s.useEffect)(()=>(window.model=e,window.toJS=l.toJS,window.mobx=l,()=>{delete window.model,delete window.toJS,delete window.mobx}),[e]),c.a.createElement(c.a.Fragment,null)}),i.a,o.h,s.useEffect,l.toJS;class y extends Error{}function h(e){if("ready"!==e.status)throw new y;return e.current}const g={filename:"/Users/feichao.sfc/code/github/alibaba/rex-design/packages/story/src/xform/helpers.tsx",loc:{start:{line:131,column:0},end:{line:136,column:1}},name:"getFromAsyncValue",value:h,source:"function getFromAsyncValue(x) {\n  if (x.status !== 'ready') {\n    throw new AsyncLoadingError();\n  }\n  return x.current;\n}",deps:()=>[__doc_info_AsyncLoadingError],provides:{}};function O(e,n){const t=l.createAtom("atom@asyncSelect"),a=[];let r="loading",o=n;const i=Object(l.computed)(()=>(t.reportObserved(),r)),s=Object(l.computed)(()=>(t.reportObserved(),o));let c,m;const d=()=>{c&&(c.dispose(),c=null)};return a.push(l.onBecomeObserved(t,()=>{c=new l.Reaction("async",()=>{"loading"!==r&&(r="loading",t.reportChanged()),c.track(()=>{var n;null===(n=m)||void 0===n||n();let a=!1;m=()=>{a=!0},e(h).then(Object(l.action)(e=>{if(!a)return r="ready",o=e,t.reportChanged(),e})).catch(e=>{if(!(e instanceof y))throw e})})}),c.schedule_()})),a.push(l.onBecomeUnobserved(t,d)),a.push(d),{get status(){return i.get()},get current(){return s.get()},dispose(){for(const e of a)e()},refresh(){var e;null===(e=c)||void 0===e||e.onBecomeStale_()}}}const v={filename:"/Users/feichao.sfc/code/github/alibaba/rex-design/packages/story/src/xform/helpers.tsx",loc:{start:{line:138,column:7},end:{line:228,column:1}},name:"createAsyncValue",value:O,source:" function _optionalChain(ops) { let lastAccessLHS = undefined; let value = ops[0]; let i = 1; while (i < ops.length) { const op = ops[i]; const fn = ops[i + 1]; i += 2; if ((op === 'optionalAccess' || op === 'optionalCall') && value == null) { return undefined; } if (op === 'access' || op === 'optionalAccess') { lastAccessLHS = value; value = fn(value); } else if (op === 'call' || op === 'optionalCall') { value = fn((...args) => value.call(lastAccessLHS, ...args)); lastAccessLHS = undefined; } } return value; }function createAsyncValue(\n  getter,\n  initValue,\n) {\n  const atom = mobx.createAtom('atom@asyncSelect');\n  const disposers = [];\n\n  let status = 'loading';\n  let current = initValue;\n\n  const computedStatus = computed(() => {\n    atom.reportObserved();\n    return status;\n  });\n  const computedCurrent = computed(() => {\n    atom.reportObserved();\n    return current;\n  });\n\n  let reaction;\n  let cancelLastGetter;\n\n  const start = () => {\n    reaction = new mobx.Reaction('async', () => {\n      if (status !== 'loading') {\n        status = 'loading';\n        atom.reportChanged();\n      }\n\n      reaction.track(() => {\n        _optionalChain([cancelLastGetter, 'optionalCall', _ => _()]);\n\n        let cancelled = false;\n        cancelLastGetter = () => {\n          cancelled = true;\n        };\n\n        getter(getFromAsyncValue)\n          .then(\n            action((newValue) => {\n              if (cancelled) {\n                return;\n              }\n              status = 'ready';\n              current = newValue;\n              atom.reportChanged();\n\n              return newValue;\n            }),\n          )\n          .catch((e) => {\n            if (e instanceof AsyncLoadingError) {\n              // still loading, do nothing\n              return;\n            }\n            // TODO \u5904\u7406 error \u72b6\u6001\n            throw e;\n          });\n      });\n    });\n    reaction.schedule_();\n  };\n\n  const stop = () => {\n    if (reaction) {\n      reaction.dispose();\n      reaction = null;\n    }\n  };\n\n  disposers.push(mobx.onBecomeObserved(atom, start));\n  disposers.push(mobx.onBecomeUnobserved(atom, stop));\n  disposers.push(stop);\n\n  return {\n    get status() {\n      return computedStatus.get();\n    },\n    get current() {\n      return computedCurrent.get();\n    },\n    dispose() {\n      for (const fn of disposers) {\n        fn();\n      }\n    },\n    refresh() {\n      _optionalChain([reaction, 'optionalAccess', _2 => _2.onBecomeStale_, 'call', _3 => _3()]);\n    },\n  };\n}",deps:()=>[g,__doc_info_AsyncLoadingError],provides:{mobx:l,computed:l.computed,action:l.action}};O.__inner_source=" function _optionalChain(ops) { let lastAccessLHS = undefined; let value = ops[0]; let i = 1; while (i < ops.length) { const op = ops[i]; const fn = ops[i + 1]; i += 2; if ((op === 'optionalAccess' || op === 'optionalCall') && value == null) { return undefined; } if (op === 'access' || op === 'optionalAccess') { lastAccessLHS = value; value = fn(value); } else if (op === 'call' || op === 'optionalCall') { value = fn((...args) => value.call(lastAccessLHS, ...args)); lastAccessLHS = undefined; } } return value; }function createAsyncValue(\n  getter,\n  initValue,\n) {\n  const atom = mobx.createAtom('atom@asyncSelect');\n  const disposers = [];\n\n  let status = 'loading';\n  let current = initValue;\n\n  const computedStatus = computed(() => {\n    atom.reportObserved();\n    return status;\n  });\n  const computedCurrent = computed(() => {\n    atom.reportObserved();\n    return current;\n  });\n\n  let reaction;\n  let cancelLastGetter;\n\n  const start = () => {\n    reaction = new mobx.Reaction('async', () => {\n      if (status !== 'loading') {\n        status = 'loading';\n        atom.reportChanged();\n      }\n\n      reaction.track(() => {\n        _optionalChain([cancelLastGetter, 'optionalCall', _ => _()]);\n\n        let cancelled = false;\n        cancelLastGetter = () => {\n          cancelled = true;\n        };\n\n        getter(getFromAsyncValue)\n          .then(\n            action((newValue) => {\n              if (cancelled) {\n                return;\n              }\n              status = 'ready';\n              current = newValue;\n              atom.reportChanged();\n\n              return newValue;\n            }),\n          )\n          .catch((e) => {\n            if (e instanceof AsyncLoadingError) {\n              // still loading, do nothing\n              return;\n            }\n            // TODO \u5904\u7406 error \u72b6\u6001\n            throw e;\n          });\n      });\n    });\n    reaction.schedule_();\n  };\n\n  const stop = () => {\n    if (reaction) {\n      reaction.dispose();\n      reaction = null;\n    }\n  };\n\n  disposers.push(mobx.onBecomeObserved(atom, start));\n  disposers.push(mobx.onBecomeUnobserved(atom, stop));\n  disposers.push(stop);\n\n  return {\n    get status() {\n      return computedStatus.get();\n    },\n    get current() {\n      return computedCurrent.get();\n    },\n    dispose() {\n      for (const fn of disposers) {\n        fn();\n      }\n    },\n    refresh() {\n      _optionalChain([reaction, 'optionalAccess', _2 => _2.onBecomeStale_, 'call', _3 => _3()]);\n    },\n  };\n}",O.__doc_info=v;try{u.displayName="BrowserOnlyReactJson",u.__docgenInfo={description:"",displayName:"BrowserOnlyReactJson",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../story/src/xform/helpers.tsx#BrowserOnlyReactJson"]={docgenInfo:u.__docgenInfo,name:"BrowserOnlyReactJson",path:"../story/src/xform/helpers.tsx#BrowserOnlyReactJson"})}catch(S){}try{b.displayName="ValuePreview",b.__docgenInfo={description:"",displayName:"ValuePreview",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../story/src/xform/helpers.tsx#ValuePreview"]={docgenInfo:b.__docgenInfo,name:"ValuePreview",path:"../story/src/xform/helpers.tsx#ValuePreview"})}catch(S){}try{f.displayName="ValuePrinter",f.__docgenInfo={description:"",displayName:"ValuePrinter",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../story/src/xform/helpers.tsx#ValuePrinter"]={docgenInfo:f.__docgenInfo,name:"ValuePrinter",path:"../story/src/xform/helpers.tsx#ValuePrinter"})}catch(S){}}}]);